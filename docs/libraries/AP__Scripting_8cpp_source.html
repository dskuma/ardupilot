<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_Scripting/AP_Scripting.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_d8b4834305e949f41ecc206e2f9f9c56.html">AP_Scripting</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AP_Scripting.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="AP__Scripting_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">   This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"></span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> */</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="AP__Scripting__config_8h.html">AP_Scripting_config.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#if AP_SCRIPTING_ENABLED</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Scripting_8h.html">AP_Scripting/AP_Scripting.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="GCS_8h.html">GCS_MAVLink/GCS.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="lua__scripts_8h.html">lua_scripts.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">// ensure that we have a set of stack sizes, and enforce constraints around it</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">// except for the minimum size, these are allowed to be defined by the build system</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#undef SCRIPTING_STACK_MIN_SIZE</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#define SCRIPTING_STACK_MIN_SIZE (8 * 1024)</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#if !defined(SCRIPTING_STACK_SIZE)</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">  #define SCRIPTING_STACK_SIZE (17 * 1024) </span><span class="comment">// Linux experiences stack corruption at ~16.25KB when handed bad scripts</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#endif </span><span class="comment">// !defined(SCRIPTING_STACK_SIZE)</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#if !defined(SCRIPTING_STACK_MAX_SIZE)</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">  #define SCRIPTING_STACK_MAX_SIZE (64 * 1024)</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#endif </span><span class="comment">// !defined(SCRIPTING_STACK_MAX_SIZE)</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#if !defined(SCRIPTING_HEAP_SIZE)</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">  #if CONFIG_HAL_BOARD == HAL_BOARD_SITL || CONFIG_HAL_BOARD == HAL_BOARD_LINUX || HAL_MEM_CLASS &gt;= HAL_MEM_CLASS_1000</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">    #define SCRIPTING_HEAP_SIZE (200 * 1024)</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">  #elif HAL_MEM_CLASS &gt;= HAL_MEM_CLASS_500</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">    #define SCRIPTING_HEAP_SIZE (100 * 1024)</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">  #else</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">    #define SCRIPTING_HEAP_SIZE (43 * 1024)</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">  #endif</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#endif </span><span class="comment">// !defined(SCRIPTING_HEAP_SIZE)</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="keyword">static_assert</span>(SCRIPTING_STACK_SIZE &gt;= SCRIPTING_STACK_MIN_SIZE, <span class="stringliteral">&quot;Scripting requires a larger minimum stack size&quot;</span>);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="keyword">static_assert</span>(SCRIPTING_STACK_SIZE &lt;= SCRIPTING_STACK_MAX_SIZE, <span class="stringliteral">&quot;Scripting requires a smaller stack size&quot;</span>);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#ifndef SCRIPTING_ENABLE_DEFAULT</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#define SCRIPTING_ENABLE_DEFAULT 0</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#if AP_NETWORKING_ENABLED</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &lt;<a class="code" href="Socket_8h.html">AP_HAL/utility/Socket.h</a>&gt;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_class" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keyword">const</span> <a class="code hl_struct" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> AP_Scripting::var_info[] = {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="comment">// @Param: ENABLE</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="comment">// @DisplayName: Enable Scripting</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">// @Description: Controls if scripting is enabled</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">// @Values: 0:None,1:Lua Scripts</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <a class="code hl_define" href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a>(<span class="stringliteral">&quot;ENABLE&quot;</span>, 1, AP_Scripting, _enable, SCRIPTING_ENABLE_DEFAULT, <a class="code hl_define" href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a>),</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="comment">// @Param: VM_I_COUNT</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="comment">// @DisplayName: Scripting Virtual Machine Instruction Count</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// @Description: The number virtual machine instructions that can be run before considering a script to have taken an excessive amount of time</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="comment">// @Range: 1000 1000000</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">// @Increment: 10000</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;VM_I_COUNT&quot;</span>, 2, AP_Scripting, _script_vm_exec_count, 10000),</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="comment">// @Param: HEAP_SIZE</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="comment">// @DisplayName: Scripting Heap Size</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="comment">// @Description: Amount of memory available for scripting</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">// @Range: 1024 1048576</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="comment">// @Increment: 1024</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;HEAP_SIZE&quot;</span>, 3, AP_Scripting, _script_heap_size, SCRIPTING_HEAP_SIZE),</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="comment">// @Param: DEBUG_OPTS</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="comment">// @DisplayName: Scripting Debug Level</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="comment">// @Description: Debugging options</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="comment">// @Bitmask: 0: No Scripts to run message if all scripts have stopped</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="comment">// @Bitmask: 1: Runtime messages for memory usage and execution time</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="comment">// @Bitmask: 2: Suppress logging scripts to dataflash</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="comment">// @Bitmask: 3: log runtime memory usage and execution time</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="comment">// @Bitmask: 4: Disable pre-arm check</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// @Bitmask: 5: Save CRC of current scripts to loaded and running checksum parameters enabling pre-arm</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEBUG_OPTS&quot;</span>, 4, AP_Scripting, _debug_options, 0),</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="comment">// @Param: USER1</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="comment">// @DisplayName: Scripting User Parameter1</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER1&quot;</span>, 5, AP_Scripting, _user[0], 0.0),</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="comment">// @Param: USER2</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="comment">// @DisplayName: Scripting User Parameter2</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER2&quot;</span>, 6, AP_Scripting, _user[1], 0.0),</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="comment">// @Param: USER3</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="comment">// @DisplayName: Scripting User Parameter3</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER3&quot;</span>, 7, AP_Scripting, _user[2], 0.0),</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <span class="comment">// @Param: USER4</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="comment">// @DisplayName: Scripting User Parameter4</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER4&quot;</span>, 8, AP_Scripting, _user[3], 0.0),</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="comment">// @Param: USER5</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="comment">// @DisplayName: Scripting User Parameter5</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER5&quot;</span>, 10, AP_Scripting, _user[4], 0.0),</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <span class="comment">// @Param: USER6</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="comment">// @DisplayName: Scripting User Parameter6</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="comment">// @Description: General purpose user variable input for scripts</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USER6&quot;</span>, 11, AP_Scripting, _user[5], 0.0),</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="comment">// @Param: DIR_DISABLE</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment">// @DisplayName: Directory disable</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="comment">// @Description: This will stop scripts being loaded from the given locations</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="comment">// @Bitmask: 0:ROMFS, 1:APM/scripts</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DIR_DISABLE&quot;</span>, 9, AP_Scripting, _dir_disable, 0),</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="comment">// @Param: LD_CHECKSUM</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment">// @DisplayName: Loaded script checksum</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="comment">// @Description: Required XOR of CRC32 checksum of loaded scripts, vehicle will not arm with incorrect scripts loaded, -1 disables</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;LD_CHECKSUM&quot;</span>, 12, AP_Scripting, _required_loaded_checksum, -1),</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="comment">// @Param: RUN_CHECKSUM</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="comment">// @DisplayName: Running script checksum</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="comment">// @Description: Required XOR of CRC32 checksum of running scripts, vehicle will not arm with incorrect scripts running, -1 disables</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;RUN_CHECKSUM&quot;</span>, 13, AP_Scripting, _required_running_checksum, -1),</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="comment">// @Param: THD_PRIORITY</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="comment">// @DisplayName: Scripting thread priority</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="comment">// @Description: This sets the priority of the scripting thread. This is normally set to a low priority to prevent scripts from interfering with other parts of the system. Advanced users can change this priority if scripting needs to be prioritised for realtime applications. WARNING: changing this parameter can impact the stability of your flight controller. The scipting thread priority in this parameter is chosen based on a set of system level priorities for other subsystems. It is strongly recommended that you use the lowest priority that is sufficient for your application. Note that all scripts run at the same priority, so if you raise this priority you must carefully audit all lua scripts for behaviour that does not interfere with the operation of the system.</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="comment">// @Values: 0:Normal, 1:IO Priority, 2:Storage Priority, 3:UART Priority, 4:I2C Priority, 5:SPI Priority, 6:Timer Priority, 7:Main Priority, 8:Boost Priority</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;THD_PRIORITY&quot;</span>, 14, AP_Scripting, _thd_priority, uint8_t(ThreadPriority::NORMAL)),</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <a class="code hl_define" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>};</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>AP_Scripting::AP_Scripting() {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <a class="code hl_function" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, var_info);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keywordflow">if</span> (_singleton != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a>(<span class="stringliteral">&quot;Scripting must be a singleton&quot;</span>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="preprocessor">#endif </span><span class="comment">// CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    _singleton = <span class="keyword">this</span>;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>}</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="keywordtype">void</span> AP_Scripting::init(<span class="keywordtype">void</span>) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">if</span> (!_enable) {</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *dir_name = <a class="code hl_define" href="lua__common__defs_8h.html#aff13860d2eef3bd2abb9bfbaaeee0d0f">SCRIPTING_DIRECTORY</a>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().mkdir(dir_name)) {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__Filesystem__Param_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != EEXIST) {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Scripting: failed to create (%s)&quot;</span>, dir_name);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        }</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    }</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <a class="code hl_enumeration" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16">AP_HAL::Scheduler::priority_base</a> <a class="code hl_variable" href="lparser_8c.html#a81b42517a626e76f00bbe1bf33d3aeba">priority</a> = <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16ab5e1b2a2b1366b272bb050bffe83071e">AP_HAL::Scheduler::PRIORITY_SCRIPTING</a>;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        ThreadPriority scr_priority;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <a class="code hl_enumeration" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16">AP_HAL::Scheduler::priority_base</a> hal_priority;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    } priority_map[] = {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        { ThreadPriority::NORMAL, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16ab5e1b2a2b1366b272bb050bffe83071e">AP_HAL::Scheduler::PRIORITY_SCRIPTING</a> },</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        { ThreadPriority::IO, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a85a843892d64d34a41f0c9914e4c6610">AP_HAL::Scheduler::PRIORITY_IO</a> },</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        { ThreadPriority::STORAGE, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16af75c3a4735388e360f41676e7a3324b4">AP_HAL::Scheduler::PRIORITY_STORAGE</a> },</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        { ThreadPriority::UART, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a3f4603a86f155491e2a84635f45c3876">AP_HAL::Scheduler::PRIORITY_UART</a> },</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        { ThreadPriority::I2C, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16afae5bc5b845111e967e138723a85a906">AP_HAL::Scheduler::PRIORITY_I2C</a> },</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        { ThreadPriority::SPI, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a0349894bf631e34e39168ee195288e10">AP_HAL::Scheduler::PRIORITY_SPI</a> },</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        { ThreadPriority::TIMER, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a151fc99628d27f87560ea5a707a986bf">AP_HAL::Scheduler::PRIORITY_TIMER</a> },</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        { ThreadPriority::MAIN, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16ab79973f2af4e0a4b1f03971394b936ae">AP_HAL::Scheduler::PRIORITY_MAIN</a> },</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        { ThreadPriority::BOOST, <a class="code hl_enumvalue" href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a194c369bd077af1c2a35424cd7342d7f">AP_HAL::Scheduler::PRIORITY_BOOST</a> },</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    };</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p : priority_map) {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <span class="keywordflow">if</span> (p.scr_priority == _thd_priority) {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <a class="code hl_variable" href="lparser_8c.html#a81b42517a626e76f00bbe1bf33d3aeba">priority</a> = p.hal_priority;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        }</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Scheduler.html#aa6ce504fcdbd583bc7c05eb1f1fb2129">thread_create</a>(<a class="code hl_define" href="functor_8h.html#a00e5874203cecc310017f9166f2c0e36">FUNCTOR_BIND_MEMBER</a>(&amp;AP_Scripting::thread, <span class="keywordtype">void</span>),</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                                      <span class="stringliteral">&quot;Scripting&quot;</span>, SCRIPTING_STACK_SIZE, <a class="code hl_variable" href="lparser_8c.html#a81b42517a626e76f00bbe1bf33d3aeba">priority</a>, 0)) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_ERROR, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;failed to start&quot;</span>);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        _thread_failed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="preprocessor">#if HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>MAV_RESULT AP_Scripting::handle_command_int_packet(<span class="keyword">const</span> mavlink_command_int_t &amp;packet) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keywordflow">switch</span> ((SCRIPTING_CMD)packet.param1) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">case</span> SCRIPTING_CMD_REPL_START:</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="keywordflow">return</span> repl_start() ? MAV_RESULT_ACCEPTED : MAV_RESULT_FAILED;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        <span class="keywordflow">case</span> SCRIPTING_CMD_REPL_STOP:</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            repl_stop();</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            <span class="keywordflow">return</span> MAV_RESULT_ACCEPTED;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>        <span class="keywordflow">case</span> SCRIPTING_CMD_STOP:</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            _restart = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            _stop = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            <span class="keywordflow">return</span> MAV_RESULT_ACCEPTED;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <span class="keywordflow">case</span> SCRIPTING_CMD_STOP_AND_RESTART:</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>            _restart = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            _stop = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            <span class="keywordflow">return</span> MAV_RESULT_ACCEPTED;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="keywordflow">case</span> SCRIPTING_CMD_ENUM_END: <span class="comment">// cope with MAVLink generator appending to our enum</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">return</span> MAV_RESULT_UNSUPPORTED;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>}</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="keywordtype">bool</span> AP_Scripting::repl_start(<span class="keywordtype">void</span>) {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="keywordflow">if</span> (terminal.session) { <span class="comment">// it&#39;s already running, this is fine</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="comment">// nuke the old folder and all contents</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="keyword">struct </span>stat st;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().stat(<a class="code hl_define" href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a>, &amp;st) == -1) &amp;&amp;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        (<a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().unlink(<a class="code hl_define" href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a>)  == -1) &amp;&amp;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        (<a class="code hl_variable" href="AP__Filesystem__Param_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != EEXIST)) {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Scripting: Unable to delete old REPL %s&quot;</span>, strerror(<a class="code hl_variable" href="AP__Filesystem__Param_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    }</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="comment">// create a new folder</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().<a class="code hl_function" href="classAP__Filesystem.html#a29a38ee87b715fa946678f9c7d97e381">mkdir</a>(<a class="code hl_define" href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="comment">// delete old files in case we couldn&#39;t</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().<a class="code hl_function" href="classAP__Filesystem.html#a482c84808c01068c4b6f07ac902e98ba">unlink</a>(<a class="code hl_define" href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a> <span class="stringliteral">&quot;/in&quot;</span>);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().<a class="code hl_function" href="classAP__Filesystem.html#a482c84808c01068c4b6f07ac902e98ba">unlink</a>(<a class="code hl_define" href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a> <span class="stringliteral">&quot;/out&quot;</span>);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="comment">// make the output pointer</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    terminal.output_fd = <a class="code hl_function" href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a>().<a class="code hl_function" href="classAP__Filesystem.html#a0ca70241ac482c4349fe1340a2b7f173">open</a>(<a class="code hl_define" href="lua__common__defs_8h.html#ae886873eef22c113e49141ccd39b7d12">REPL_OUT</a>, O_WRONLY|O_CREAT|O_TRUNC);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keywordflow">if</span> (terminal.output_fd == -1) {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;Unable to make new REPL&quot;</span>);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    terminal.session = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>}</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="keywordtype">void</span> AP_Scripting::repl_stop(<span class="keywordtype">void</span>) {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    terminal.session = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="comment">// can&#39;t do any more cleanup here, closing the open FD&#39;s is the REPL&#39;s responsibility</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>}</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="comment">/*</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">  avoid optimisation of the thread function. This avoids nasty traps</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment">  where setjmp/longjmp does not properly handle save/restore of</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><span class="comment">  floating point registers on exceptions. This is an extra protection</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="comment">  over the top of the fix in luaD_rawrunprotected() for the same issue</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment"> */</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="preprocessor">#pragma GCC push_options</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="preprocessor">#pragma GCC optimize (&quot;O0&quot;)</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="keywordtype">void</span> AP_Scripting::thread(<span class="keywordtype">void</span>) {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <span class="comment">// reset flags</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        _stop = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        _restart = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        _init_failed = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        lua_scripts *lua = <span class="keyword">new</span> lua_scripts(_script_vm_exec_count, _script_heap_size, _debug_options, terminal);</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        <span class="keywordflow">if</span> (lua == <span class="keyword">nullptr</span> || !lua-&gt;heap_allocated()) {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_CRITICAL, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;Unable to allocate memory&quot;</span>);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>            _init_failed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="comment">// run won&#39;t return while scripting is still active</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            lua-&gt;run();</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="comment">// only reachable if the lua backend has died for any reason</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_CRITICAL, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;stopped&quot;</span>);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        }</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="keyword">delete</span> lua;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        lua = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="comment">// clear allocated i2c devices</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;SCRIPTING_MAX_NUM_I2C_DEVICE; i++) {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            <span class="keyword">delete</span> _i2c_dev[i];</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            _i2c_dev[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        num_i2c_devices = 0;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="comment">// clear allocated PWM sources</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;SCRIPTING_MAX_NUM_PWM_SOURCE; i++) {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            <span class="keywordflow">if</span> (_pwm_source[i] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>                <span class="keyword">delete</span> _pwm_source[i];</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>                _pwm_source[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        num_pwm_source = 0;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="preprocessor">#if AP_NETWORKING_ENABLED</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="comment">// clear allocated sockets</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;SCRIPTING_MAX_NUM_NET_SOCKET; i++) {</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <span class="keywordflow">if</span> (_net_sockets[i] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                <span class="keyword">delete</span> _net_sockets[i];</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                _net_sockets[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="preprocessor">#endif </span><span class="comment">// AP_NETWORKING_ENABLED</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        <span class="comment">// Clear blocked commands</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>            <a class="code hl_define" href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a>(mavlink_command_block_list_sem);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            <span class="keywordflow">while</span> (mavlink_command_block_list != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>                command_block_list *next_item = mavlink_command_block_list-&gt;next;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                <span class="keyword">delete</span> mavlink_command_block_list;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>                mavlink_command_block_list = next_item;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>            }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="keywordtype">bool</span> cleared = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            <span class="comment">// 1hz check if we should restart</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(1000);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="keywordflow">if</span> (!enabled()) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                <span class="comment">// enable must be put to 0 and back to 1 to restart from params</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                cleared = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            <span class="comment">// must be enabled to get this far</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            <span class="keywordflow">if</span> (cleared || _restart) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>                <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_CRITICAL, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;restarted&quot;</span>);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            }</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>            <span class="keywordflow">if</span> ((_debug_options.get() &amp; uint8_t(lua_scripts::DebugLevel::NO_SCRIPTS_TO_RUN)) != 0) {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_DEBUG, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;stopped&quot;</span>);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>            }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>}</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="preprocessor">#pragma GCC pop_options</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="keywordtype">void</span> AP_Scripting::handle_mission_command(<span class="keyword">const</span> <a class="code hl_struct" href="structAP__Mission_1_1Mission__Command.html">AP_Mission::Mission_Command</a>&amp; cmd_in)</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>{</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="preprocessor">#if AP_MISSION_ENABLED</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="keywordflow">if</span> (!_enable) {</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    }</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="keywordflow">if</span> (mission_data == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        <span class="comment">// load buffer</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        mission_data = <span class="keyword">new</span> <a class="code hl_class" href="classObjectBuffer.html">ObjectBuffer&lt;struct AP_Scripting::scripting_mission_cmd&gt;</a>(mission_cmd_queue_size);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        <span class="keywordflow">if</span> (mission_data != <span class="keyword">nullptr</span> &amp;&amp; mission_data-&gt;get_size() == 0) {</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            <span class="keyword">delete</span> mission_data;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            mission_data = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordflow">if</span> (mission_data == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_ERROR, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;unable to receive mission command&quot;</span>);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keyword">struct </span>scripting_mission_cmd cmd {cmd_in.<a class="code hl_variable" href="structAP__Mission_1_1Mission__Command.html#a6b240c9c758f53f14e81be2554a08973">p1</a>,</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                                      cmd_in.<a class="code hl_variable" href="structAP__Mission_1_1Mission__Command.html#a41a7d992648b468243195e1e0af22f10">content</a>.<a class="code hl_variable" href="unionAP__Mission_1_1Content.html#a22a899210a4ec64110bf7d641c5476f3">scripting</a>.<a class="code hl_variable" href="structAP__Mission_1_1scripting__Command.html#af2f76d0f002d72c73eae09d406c50e2e">p1</a>,</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                                      cmd_in.<a class="code hl_variable" href="structAP__Mission_1_1Mission__Command.html#a41a7d992648b468243195e1e0af22f10">content</a>.<a class="code hl_variable" href="unionAP__Mission_1_1Content.html#a22a899210a4ec64110bf7d641c5476f3">scripting</a>.<a class="code hl_variable" href="structAP__Mission_1_1scripting__Command.html#a0a5400e24220a239e9b26cef4feff22a">p2</a>,</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>                                      cmd_in.<a class="code hl_variable" href="structAP__Mission_1_1Mission__Command.html#a41a7d992648b468243195e1e0af22f10">content</a>.<a class="code hl_variable" href="unionAP__Mission_1_1Content.html#a22a899210a4ec64110bf7d641c5476f3">scripting</a>.<a class="code hl_variable" href="structAP__Mission_1_1scripting__Command.html#ac16c90c17d0177ed8748d153b1f616c4">p3</a>,</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                                      <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>()};</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    mission_data-&gt;push(cmd);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>}</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span><span class="keywordtype">bool</span> AP_Scripting::arming_checks(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="keywordtype">char</span> *<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="keywordflow">if</span> (!enabled() || ((_debug_options.get() &amp; uint8_t(lua_scripts::DebugLevel::DISABLE_PRE_ARM)) != 0)) {</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="keywordflow">if</span> (_thread_failed) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>, <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;failed to start&quot;</span>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    <span class="keywordflow">if</span> (_init_failed) {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>, <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;out of memory&quot;</span>);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    lua_scripts::get_last_error_semaphore()-&gt;take_blocking();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *error_buf = lua_scripts::get_last_error_message();</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <span class="keywordflow">if</span> (error_buf != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>, <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, error_buf);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        lua_scripts::get_last_error_semaphore()-&gt;give();</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    lua_scripts::get_last_error_semaphore()-&gt;give();</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="comment">// Use -1 for disabled, this means we don&#39;t have to avoid 0 in the CRC, the sign bit is masked off anyway</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordflow">if</span> (_required_loaded_checksum != -1) {</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keyword">const</span> uint32_t expected_loaded = (uint32_t)_required_loaded_checksum.get() &amp; checksum_param_mask;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keyword">const</span> uint32_t loaded = lua_scripts::get_loaded_checksum() &amp; checksum_param_mask;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <span class="keywordflow">if</span> (expected_loaded != loaded) {</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>, <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="stringliteral">&quot;Scripting: loaded CRC incorrect want: 0x%x&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)loaded);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    }</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keywordflow">if</span> (_required_running_checksum != -1) {</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <span class="keyword">const</span> uint32_t expected_running = (uint32_t)_required_running_checksum.get() &amp; checksum_param_mask;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keyword">const</span> uint32_t running = lua_scripts::get_running_checksum() &amp; checksum_param_mask;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        <span class="keywordflow">if</span> (expected_running != running) {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(<a class="code hl_variable" href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a>, <a class="code hl_variable" href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a>, <span class="stringliteral">&quot;Scripting: running CRC incorrect want: 0x%x&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)running);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>}</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="keywordtype">void</span> AP_Scripting::restart_all()</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>{</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    _restart = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    _stop = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>}</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="preprocessor">#if HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="keywordtype">void</span> AP_Scripting::handle_message(<span class="keyword">const</span> mavlink_message_t &amp;msg, <span class="keyword">const</span> mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>) {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="keywordflow">if</span> (mavlink_data.rx_buffer == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    }</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="keyword">struct </span>mavlink_msg data {msg, <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>()};</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_define" href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a>(mavlink_data.sem);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; mavlink_data.accept_msg_ids_size; i++) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="keywordflow">if</span> (mavlink_data.accept_msg_ids[i] == UINT32_MAX) {</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="keywordflow">if</span> (mavlink_data.accept_msg_ids[i] == msg.msgid) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            mavlink_data.rx_buffer-&gt;push(data);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        }</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>}</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="keywordtype">bool</span> AP_Scripting::is_handling_command(uint16_t cmd_id)</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>{</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <a class="code hl_define" href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a>(mavlink_command_block_list_sem);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="comment">// Look in linked list to see if id is registered</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keywordflow">if</span> (mavlink_command_block_list != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="keywordflow">for</span> (command_block_list *item = mavlink_command_block_list; item; item = item-&gt;next) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>            <span class="keywordflow">if</span> (item-&gt;id == cmd_id) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>}</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="preprocessor">#endif </span><span class="comment">// HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">// Update called at 1Hz from AP_Vehicle</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="keywordtype">void</span> AP_Scripting::update() {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    save_checksum();</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>}</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="comment">// Check if DEBUG_OPTS bit has been set to save current checksum values to params</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="keywordtype">void</span> AP_Scripting::save_checksum() {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keyword">const</span> uint8_t opts = _debug_options.get();</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <span class="keyword">const</span> uint8_t save_bit = uint8_t(lua_scripts::DebugLevel::SAVE_CHECKSUM);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    <span class="keywordflow">if</span> ((opts &amp; save_bit) == 0) {</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        <span class="comment">// Bit not set, nothing to do</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    }</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <span class="comment">// Save two checksum parameters to there current values</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    _required_loaded_checksum.set_and_save(lua_scripts::get_loaded_checksum() &amp; checksum_param_mask);</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    _required_running_checksum.set_and_save(lua_scripts::get_running_checksum() &amp; checksum_param_mask);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    <span class="comment">// Un-set debug option bit</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    _debug_options.set_and_save(opts &amp; ~save_bit);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_ERROR, <span class="stringliteral">&quot;Scripting: %s&quot;</span>, <span class="stringliteral">&quot;saved checksums&quot;</span>);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>}</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>AP_Scripting *AP_Scripting::_singleton = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceAP.html">AP</a> {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    AP_Scripting *scripting() {</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        <span class="keywordflow">return</span> AP_Scripting::get_singleton();</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    }</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>}</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="preprocessor">#endif  </span><span class="comment">// AP_SCRIPTING_ENABLED</span></div>
<div class="ttc" id="aAC__AttitudeControl_8cpp_html_a240c1a4ae2a70d1855f91e4a0b1ac938"><div class="ttname"><a href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition</b> <a href="AP__Compass__AK09916_8cpp_source.html#l00059">AP_Compass_AK09916.cpp:59</a></div></div>
<div class="ttc" id="aAP__Filesystem__Param_8cpp_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="AP__Filesystem__Param_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="aAP__HAL_2Semaphores_8h_html_a819dd9ac6de800cdf1014b0a922b67d4"><div class="ttname"><a href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a></div><div class="ttdeci">#define WITH_SEMAPHORE(sem)</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Semaphores_8h_source.html#l00054">Semaphores.h:54</a></div></div>
<div class="ttc" id="aAP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00163">AP_Param.h:163</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00145">AP_Param.h:145</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_ac24e2eb16c2194e975d27e47ddcb7f1c"><div class="ttname"><a href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a></div><div class="ttdeci">#define AP_GROUPINFO_FLAGS(name, idx, clazz, element, def, flags)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00133">AP_Param.h:133</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_ae25c1c7495435989f8be5781c86be078"><div class="ttname"><a href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a></div><div class="ttdeci">#define AP_PARAM_FLAG_ENABLE</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00087">AP_Param.h:87</a></div></div>
<div class="ttc" id="aAP__Scripting_8h_html"><div class="ttname"><a href="AP__Scripting_8h.html">AP_Scripting.h</a></div></div>
<div class="ttc" id="aAP__Scripting__config_8h_html"><div class="ttname"><a href="AP__Scripting__config_8h.html">AP_Scripting_config.h</a></div></div>
<div class="ttc" id="aGCS_8h_html"><div class="ttname"><a href="GCS_8h.html">GCS.h</a></div><div class="ttdoc">Interface definition for the various Ground Control System.</div></div>
<div class="ttc" id="aGCS_8h_html_a266bfe8eda675e1092f045e93932b4a6"><div class="ttname"><a href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a></div><div class="ttdeci">#define GCS_SEND_TEXT(severity, format, args...)</div><div class="ttdef"><b>Definition</b> <a href="GCS_8h_source.html#l01349">GCS.h:1349</a></div></div>
<div class="ttc" id="aSocket_8h_html"><div class="ttname"><a href="Socket_8h.html">Socket.h</a></div></div>
<div class="ttc" id="aUART__chargen_8cpp_html_a892366b22e8ea42d95e49308022eef4d"><div class="ttname"><a href="UART__chargen_8cpp.html#a892366b22e8ea42d95e49308022eef4d">buflen</a></div><div class="ttdeci">uint16_t buflen</div><div class="ttdef"><b>Definition</b> <a href="UART__chargen_8cpp_source.html#l00037">UART_chargen.cpp:37</a></div></div>
<div class="ttc" id="aUART__chargen_8cpp_html_a8a45ba1322f5f38149f9bb899b09a1f4"><div class="ttname"><a href="UART__chargen_8cpp.html#a8a45ba1322f5f38149f9bb899b09a1f4">buffer</a></div><div class="ttdeci">uint8_t buffer[16384]</div><div class="ttdef"><b>Definition</b> <a href="UART__chargen_8cpp_source.html#l00036">UART_chargen.cpp:36</a></div></div>
<div class="ttc" id="aclassAP__Filesystem_html_a0ca70241ac482c4349fe1340a2b7f173"><div class="ttname"><a href="classAP__Filesystem.html#a0ca70241ac482c4349fe1340a2b7f173">AP_Filesystem::open</a></div><div class="ttdeci">int open(const char *fname, int flags, bool allow_absolute_paths=false)</div><div class="ttdef"><b>Definition</b> <a href="AP__Filesystem_8cpp_source.html#l00124">AP_Filesystem.cpp:124</a></div></div>
<div class="ttc" id="aclassAP__Filesystem_html_a29a38ee87b715fa946678f9c7d97e381"><div class="ttname"><a href="classAP__Filesystem.html#a29a38ee87b715fa946678f9c7d97e381">AP_Filesystem::mkdir</a></div><div class="ttdeci">int mkdir(const char *pathname)</div><div class="ttdef"><b>Definition</b> <a href="AP__Filesystem_8cpp_source.html#l00184">AP_Filesystem.cpp:184</a></div></div>
<div class="ttc" id="aclassAP__Filesystem_html_a482c84808c01068c4b6f07ac902e98ba"><div class="ttname"><a href="classAP__Filesystem.html#a482c84808c01068c4b6f07ac902e98ba">AP_Filesystem::unlink</a></div><div class="ttdeci">int unlink(const char *pathname)</div><div class="ttdef"><b>Definition</b> <a href="AP__Filesystem_8cpp_source.html#l00178">AP_Filesystem.cpp:178</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html_a9337a60383f4264fa96a20dbe43a4e2e"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">AP_HAL::HAL::util</a></div><div class="ttdeci">AP_HAL::Util * util</div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00131">HAL.h:131</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00130">HAL.h:130</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_aa6ce504fcdbd583bc7c05eb1f1fb2129"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#aa6ce504fcdbd583bc7c05eb1f1fb2129">AP_HAL::Scheduler::thread_create</a></div><div class="ttdeci">virtual bool thread_create(AP_HAL::MemberProc proc, const char *name, uint32_t stack_size, priority_base base, int8_t priority)</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00124">Scheduler.h:124</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_ab3175e2e6223ccfe82f957e41cc12b26"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">AP_HAL::Scheduler::delay</a></div><div class="ttdeci">virtual void delay(uint16_t ms)=0</div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16">AP_HAL::Scheduler::priority_base</a></div><div class="ttdeci">priority_base</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00104">Scheduler.h:104</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16a0349894bf631e34e39168ee195288e10"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a0349894bf631e34e39168ee195288e10">AP_HAL::Scheduler::PRIORITY_SPI</a></div><div class="ttdeci">@ PRIORITY_SPI</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00107">Scheduler.h:107</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16a151fc99628d27f87560ea5a707a986bf"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a151fc99628d27f87560ea5a707a986bf">AP_HAL::Scheduler::PRIORITY_TIMER</a></div><div class="ttdeci">@ PRIORITY_TIMER</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00110">Scheduler.h:110</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16a194c369bd077af1c2a35424cd7342d7f"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a194c369bd077af1c2a35424cd7342d7f">AP_HAL::Scheduler::PRIORITY_BOOST</a></div><div class="ttdeci">@ PRIORITY_BOOST</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00105">Scheduler.h:105</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16a3f4603a86f155491e2a84635f45c3876"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a3f4603a86f155491e2a84635f45c3876">AP_HAL::Scheduler::PRIORITY_UART</a></div><div class="ttdeci">@ PRIORITY_UART</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00115">Scheduler.h:115</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16a85a843892d64d34a41f0c9914e4c6610"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16a85a843892d64d34a41f0c9914e4c6610">AP_HAL::Scheduler::PRIORITY_IO</a></div><div class="ttdeci">@ PRIORITY_IO</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00114">Scheduler.h:114</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16ab5e1b2a2b1366b272bb050bffe83071e"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16ab5e1b2a2b1366b272bb050bffe83071e">AP_HAL::Scheduler::PRIORITY_SCRIPTING</a></div><div class="ttdeci">@ PRIORITY_SCRIPTING</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00117">Scheduler.h:117</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16ab79973f2af4e0a4b1f03971394b936ae"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16ab79973f2af4e0a4b1f03971394b936ae">AP_HAL::Scheduler::PRIORITY_MAIN</a></div><div class="ttdeci">@ PRIORITY_MAIN</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00106">Scheduler.h:106</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16af75c3a4735388e360f41676e7a3324b4"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16af75c3a4735388e360f41676e7a3324b4">AP_HAL::Scheduler::PRIORITY_STORAGE</a></div><div class="ttdeci">@ PRIORITY_STORAGE</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00116">Scheduler.h:116</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Scheduler_html_abcee0d195c8bec8bcbe39f3ef6edbf16afae5bc5b845111e967e138723a85a906"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#abcee0d195c8bec8bcbe39f3ef6edbf16afae5bc5b845111e967e138723a85a906">AP_HAL::Scheduler::PRIORITY_I2C</a></div><div class="ttdeci">@ PRIORITY_I2C</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Scheduler_8h_source.html#l00108">Scheduler.h:108</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Util_html_afaedff8102d9ae2fbc398d2099e30cf6"><div class="ttname"><a href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">AP_HAL::Util::snprintf</a></div><div class="ttdeci">int snprintf(char *str, size_t size, const char *format,...) FMT_PRINTF(4</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Util_8cpp_source.html#l00044">Util.cpp:44</a></div></div>
<div class="ttc" id="aclassAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00010">main.cpp:10</a></div></div>
<div class="ttc" id="aclassObjectBuffer_html"><div class="ttname"><a href="classObjectBuffer.html">ObjectBuffer</a></div><div class="ttdef"><b>Definition</b> <a href="RingBuffer_8h_source.html#l00112">RingBuffer.h:112</a></div></div>
<div class="ttc" id="aexamples_2AnalogIn_2AnalogIn_8cpp_html_a130f3ebe4c1bb6993e1094760227ad6a"><div class="ttname"><a href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a></div><div class="ttdeci">AP_HAL::AnalogSource * chan</div><div class="ttdef"><b>Definition</b> <a href="examples_2AnalogIn_2AnalogIn_8cpp_source.html#l00025">AnalogIn.cpp:25</a></div></div>
<div class="ttc" id="afunctor_8h_html_a00e5874203cecc310017f9166f2c0e36"><div class="ttname"><a href="functor_8h.html#a00e5874203cecc310017f9166f2c0e36">FUNCTOR_BIND_MEMBER</a></div><div class="ttdeci">#define FUNCTOR_BIND_MEMBER(func, rettype,...)</div><div class="ttdef"><b>Definition</b> <a href="functor_8h_source.html#l00031">functor.h:31</a></div></div>
<div class="ttc" id="alparser_8c_html_a81b42517a626e76f00bbe1bf33d3aeba"><div class="ttname"><a href="lparser_8c.html#a81b42517a626e76f00bbe1bf33d3aeba">priority</a></div><div class="ttdeci">static const struct @195 priority[]</div></div>
<div class="ttc" id="alua__common__defs_8h_html_a2e9e41df6cb962df6123d6504724f0ae"><div class="ttname"><a href="lua__common__defs_8h.html#a2e9e41df6cb962df6123d6504724f0ae">REPL_DIRECTORY</a></div><div class="ttdeci">#define REPL_DIRECTORY</div><div class="ttdef"><b>Definition</b> <a href="lua__common__defs_8h_source.html#l00009">lua_common_defs.h:9</a></div></div>
<div class="ttc" id="alua__common__defs_8h_html_ae886873eef22c113e49141ccd39b7d12"><div class="ttname"><a href="lua__common__defs_8h.html#ae886873eef22c113e49141ccd39b7d12">REPL_OUT</a></div><div class="ttdeci">#define REPL_OUT</div><div class="ttdef"><b>Definition</b> <a href="lua__common__defs_8h_source.html#l00026">lua_common_defs.h:26</a></div></div>
<div class="ttc" id="alua__common__defs_8h_html_aff13860d2eef3bd2abb9bfbaaeee0d0f"><div class="ttname"><a href="lua__common__defs_8h.html#aff13860d2eef3bd2abb9bfbaaeee0d0f">SCRIPTING_DIRECTORY</a></div><div class="ttdeci">#define SCRIPTING_DIRECTORY</div><div class="ttdef"><b>Definition</b> <a href="lua__common__defs_8h_source.html#l00017">lua_common_defs.h:17</a></div></div>
<div class="ttc" id="alua__scripts_8h_html"><div class="ttname"><a href="lua__scripts_8h.html">lua_scripts.h</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a52edeef7d5ffaa365e1229b87c170307"><div class="ttname"><a href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a></div><div class="ttdeci">void panic(const char *errormsg,...) FMT_PRINTF(1</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00327">system.cpp:327</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00377">system.cpp:377</a></div></div>
<div class="ttc" id="anamespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition</b> <a href="AC__Avoid_8cpp_source.html#l01481">AC_Avoid.cpp:1481</a></div></div>
<div class="ttc" id="anamespaceAP_html_abb3d1954cca601d4bda7c74f27be55b7"><div class="ttname"><a href="namespaceAP.html#abb3d1954cca601d4bda7c74f27be55b7">AP::FS</a></div><div class="ttdeci">AP_Filesystem &amp; FS()</div><div class="ttdef"><b>Definition</b> <a href="AP__Filesystem_8cpp_source.html#l00413">AP_Filesystem.cpp:413</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1Mission__Command_html"><div class="ttname"><a href="structAP__Mission_1_1Mission__Command.html">AP_Mission::Mission_Command</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00402">AP_Mission.h:402</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1Mission__Command_html_a41a7d992648b468243195e1e0af22f10"><div class="ttname"><a href="structAP__Mission_1_1Mission__Command.html#a41a7d992648b468243195e1e0af22f10">AP_Mission::Mission_Command::content</a></div><div class="ttdeci">Content content</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00406">AP_Mission.h:406</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1Mission__Command_html_a6b240c9c758f53f14e81be2554a08973"><div class="ttname"><a href="structAP__Mission_1_1Mission__Command.html#a6b240c9c758f53f14e81be2554a08973">AP_Mission::Mission_Command::p1</a></div><div class="ttdeci">uint16_t p1</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00405">AP_Mission.h:405</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1scripting__Command_html_a0a5400e24220a239e9b26cef4feff22a"><div class="ttname"><a href="structAP__Mission_1_1scripting__Command.html#a0a5400e24220a239e9b26cef4feff22a">AP_Mission::scripting_Command::p2</a></div><div class="ttdeci">float p2</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00227">AP_Mission.h:227</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1scripting__Command_html_ac16c90c17d0177ed8748d153b1f616c4"><div class="ttname"><a href="structAP__Mission_1_1scripting__Command.html#ac16c90c17d0177ed8748d153b1f616c4">AP_Mission::scripting_Command::p3</a></div><div class="ttdeci">float p3</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00228">AP_Mission.h:228</a></div></div>
<div class="ttc" id="astructAP__Mission_1_1scripting__Command_html_af2f76d0f002d72c73eae09d406c50e2e"><div class="ttname"><a href="structAP__Mission_1_1scripting__Command.html#af2f76d0f002d72c73eae09d406c50e2e">AP_Mission::scripting_Command::p1</a></div><div class="ttdeci">float p1</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00226">AP_Mission.h:226</a></div></div>
<div class="ttc" id="astructAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00199">AP_Param.h:199</a></div></div>
<div class="ttc" id="aunionAP__Mission_1_1Content_html_a22a899210a4ec64110bf7d641c5476f3"><div class="ttname"><a href="unionAP__Mission_1_1Content.html#a22a899210a4ec64110bf7d641c5476f3">AP_Mission::Content::scripting</a></div><div class="ttdeci">scripting_Command scripting</div><div class="ttdef"><b>Definition</b> <a href="AP__Mission_8h_source.html#l00369">AP_Mission.h:369</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 22 2024 16:14:15 for APM:Libraries by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
