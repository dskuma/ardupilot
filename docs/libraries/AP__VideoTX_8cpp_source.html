<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_VideoTX/AP_VideoTX.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_fdeae726484c6664940db2e670640c38.html">AP_VideoTX</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AP_VideoTX.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="AP__VideoTX_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">   This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"></span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">*/</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="AP__VideoTX_8h.html">AP_VideoTX.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#if AP_VIDEOTX_ENABLED</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="AP__CRSF__Telem_8h.html">AP_RCTelemetry/AP_CRSF_Telem.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="GCS_8h.html">GCS_MAVLink/GCS.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_class" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code hl_variable" href="AP__VideoTX_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a> *<a class="code hl_variable" href="classAP__VideoTX.html#a08eb99b3af33a6381a6f5c50bcbe376c">AP_VideoTX::singleton</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="keyword">const</span> <a class="code hl_struct" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code hl_variable" href="classAP__VideoTX.html#a965bd863451c2504ea427ed96d9787fc">AP_VideoTX::var_info</a>[] = {</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="comment">// @Param: ENABLE</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    <span class="comment">// @DisplayName: Is the Video Transmitter enabled or not</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="comment">// @Description: Toggles the Video Transmitter on and off</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    <span class="comment">// @Values: 0:Disable,1:Enable</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    <a class="code hl_define" href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a>(<span class="stringliteral">&quot;ENABLE&quot;</span>, 1, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _enabled, 0, <a class="code hl_define" href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a>),</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    <span class="comment">// @Param: POWER</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    <span class="comment">// @DisplayName: Video Transmitter Power Level</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">// @Description: Video Transmitter Power Level. Different VTXs support different power levels, the power level chosen will be rounded down to the nearest supported power level</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">// @Range: 1 1000</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;POWER&quot;</span>,    2, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _power_mw, 0),</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="comment">// @Param: CHANNEL</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="comment">// @DisplayName: Video Transmitter Channel</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="comment">// @Description: Video Transmitter Channel</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">// @Range: 0 7</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;CHANNEL&quot;</span>,  3, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _channel, 0),</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="comment">// @Param: BAND</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="comment">// @DisplayName: Video Transmitter Band</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    <span class="comment">// @Description: Video Transmitter Band</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="comment">// @Values: 0:Band A,1:Band B,2:Band E,3:Airwave,4:RaceBand,5:Low RaceBand,6:1G3 Band A,7:1G3 Band B</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;BAND&quot;</span>,  4, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _band, 0),</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="comment">// @Param: FREQ</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="comment">// @DisplayName: Video Transmitter Frequency</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="comment">// @Description: Video Transmitter Frequency. The frequency is derived from the setting of BAND and CHANNEL</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="comment">// @ReadOnly: True</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="comment">// @Range: 1000 6000</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;FREQ&quot;</span>,  5, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _frequency_mhz, 0),</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">// @Param: OPTIONS</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">// @DisplayName: Video Transmitter Options</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">// @Description: Video Transmitter Options. Pitmode puts the VTX in a low power state. Unlocked enables certain restricted frequencies and power levels. Do not enable the Unlocked option unless you have appropriate permissions in your jurisdiction to transmit at high power levels. One stop-bit may be required for VTXs that erroneously mimic iNav behaviour.</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="comment">// @Bitmask: 0:Pitmode,1:Pitmode until armed,2:Pitmode when disarmed,3:Unlocked,4:Add leading zero byte to requests,5:Use 1 stop-bit in SmartAudio,6:Ignore CRC in SmartAudio,7:Ignore status updates in CRSF and blindly set VTX options</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OPTIONS&quot;</span>,  6, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _options, 0),</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="comment">// @Param: MAX_POWER</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// @DisplayName: Video Transmitter Max Power Level</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="comment">// @Description: Video Transmitter Maximum Power Level. Different VTXs support different power levels, this prevents the power aux switch from requesting too high a power level. The switch supports 6 power levels and the selected power will be a subdivision between 0 and this setting.</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">// @Range: 25 1000</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MAX_POWER&quot;</span>, 7, <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>, _max_power_mw, 800),</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <a class="code hl_define" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>};</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment">//#define VTX_DEBUG</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="preprocessor">#ifdef VTX_DEBUG</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="preprocessor"># define debug(fmt, args...)    hal.console-&gt;printf(&quot;VTX: &quot; fmt &quot;\n&quot;, ##args)</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="AP__VideoTX_8cpp.html#a6342d87e4f91ba01444a8783f2fbc08c">   85</a></span><span class="preprocessor"># define debug(fmt, args...)    do {} while(0)</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="AP__VideoTX_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">   88</a></span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_class" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code hl_variable" href="AP__VideoTX_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code hl_variable" href="classAP__VideoTX.html#a9526d86ea8841c1e4e342893a56dc53d">AP_VideoTX::band_names</a>[] = {<span class="stringliteral">&quot;A&quot;</span>,<span class="stringliteral">&quot;B&quot;</span>,<span class="stringliteral">&quot;E&quot;</span>,<span class="stringliteral">&quot;F&quot;</span>,<span class="stringliteral">&quot;R&quot;</span>,<span class="stringliteral">&quot;L&quot;</span>};</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keyword">const</span> uint16_t <a class="code hl_variable" href="classAP__VideoTX.html#aa468ce987c1f14ad02956252f3e8c600">AP_VideoTX::VIDEO_CHANNELS</a>[<a class="code hl_enumvalue" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfda9df1808c145fc9886449942dd290da01">AP_VideoTX::MAX_BANDS</a>][<a class="code hl_define" href="AP__VideoTX_8h.html#a7203c369bf1a8f6a5551d69b4a2aa6d5">VTX_MAX_CHANNELS</a>] =</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>{</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    { 5865, 5845, 5825, 5805, 5785, 5765, 5745, 5725}, <span class="comment">/* Band A */</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    { 5733, 5752, 5771, 5790, 5809, 5828, 5847, 5866}, <span class="comment">/* Band B */</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    { 5705, 5685, 5665, 5645, 5885, 5905, 5925, 5945}, <span class="comment">/* Band E */</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    { 5740, 5760, 5780, 5800, 5820, 5840, 5860, 5880}, <span class="comment">/* Airwave */</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    { 5658, 5695, 5732, 5769, 5806, 5843, 5880, 5917}, <span class="comment">/* Race */</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    { 5621, 5584, 5547, 5510, 5473, 5436, 5399, 5362}, <span class="comment">/* LO Race */</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    { 1080, 1120, 1160, 1200, 1240, 1280, 1320, 1360}, <span class="comment">/* Band 1G3_A */</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    { 1080, 1120, 1160, 1200, 1258, 1280, 1320, 1360}  <span class="comment">/* Band 1G3_B */</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>};</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="comment">// mapping of power level to milliwatt to dbm</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">// valid power levels from SmartAudio spec, the adjacent levels might be the actual values</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment">// so these are marked as level + 0x10 and will be switched if a dbm message proves it</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><a class="code hl_struct" href="structAP__VideoTX_1_1PowerLevel.html">AP_VideoTX::PowerLevel</a> <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">AP_VideoTX::_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>] = {</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="comment">// level, mw, dbm, dac</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    { 0xFF,  0,    0, 0    }, <span class="comment">// only in SA 2.1</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    { 0,    25,   14, 7    },</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    { 0x11, 100,  20, 0xFF }, <span class="comment">// only in SA 2.1</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    { 1,    200,  23, 16   },</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    { 0x12, 400,  26, 0xFF }, <span class="comment">// only in SA 2.1</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    { 2,    500,  27, 25   },</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="comment">//{ 0x13, 600,  28, 0xFF },</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    { 3,    800,  29, 40   },</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    { 0x13, 1000, 30, 0xFF }, <span class="comment">// only in SA 2.1</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    { 0xFF, 0,    0,  0XFF, PowerActive::Inactive }  <span class="comment">// slot reserved for a custom power level</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>};</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="foldopen" id="foldopen00121" data-start="{" data-end="}">
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#ad49eddd91d4c033d477419338b841cd5">  121</a></span><a class="code hl_function" href="classAP__VideoTX.html#ad49eddd91d4c033d477419338b841cd5">AP_VideoTX::AP_VideoTX</a>()</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>{</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a08eb99b3af33a6381a6f5c50bcbe376c">singleton</a>) {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a>(<span class="stringliteral">&quot;Too many VTXs&quot;</span>);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a08eb99b3af33a6381a6f5c50bcbe376c">singleton</a> = <span class="keyword">this</span>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <a class="code hl_function" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, var_info);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>}</div>
</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="foldopen" id="foldopen00132" data-start="{" data-end="}">
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a03573a6043a1de498867987b049955eb">  132</a></span><a class="code hl_function" href="classAP__VideoTX.html#a03573a6043a1de498867987b049955eb">AP_VideoTX::~AP_VideoTX</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>{</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a08eb99b3af33a6381a6f5c50bcbe376c">singleton</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>}</div>
</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="foldopen" id="foldopen00137" data-start="{" data-end="}">
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a9fc0196fc2d07006ea3fdeae5685d01e">  137</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#a9fc0196fc2d07006ea3fdeae5685d01e">AP_VideoTX::init</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>{</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a23ba5a6be90528a4f4ba3de8f073bad5">_initialized</a>) {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="comment">// PARAMETER_CONVERSION - Added: Sept-2022</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>.convert_parameter_width(<a class="code hl_enumvalue" href="AP__Param_8h.html#ad9ca22a1e508dceea20feda89a344f9aa0b4d6edc70defa90b393a877f6178d42">AP_PARAM_INT16</a>);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="comment">// find the index into the power table</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> &lt;= <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw) {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> != <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                    <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i - 1;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.set_and_save(<a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>());</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        }</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">_current_band</a> = <a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <a class="code hl_variable" href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">_current_channel</a> = <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> = <a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a27fc36df8308ebf3acc823c972c35b6c">_current_options</a> = <a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a2a031f3d2251f3dc1171d1d2b0de4134">_current_enabled</a> = <a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a>;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a23ba5a6be90528a4f4ba3de8f073bad5">_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>}</div>
</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="foldopen" id="foldopen00170" data-start="{" data-end="}">
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a00e3a8c2c66b5309b4986023e9e2878c">  170</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#a00e3a8c2c66b5309b4986023e9e2878c">AP_VideoTX::get_band_and_channel</a>(uint16_t freq, <a class="code hl_enumeration" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfd">VideoBand</a>&amp; band, uint8_t&amp; channel)</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>{</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_enumvalue" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfda9df1808c145fc9886449942dd290da01">AP_VideoTX::MAX_BANDS</a>; i++) {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        <span class="keywordflow">for</span> (uint8_t j = 0; j &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#a7203c369bf1a8f6a5551d69b4a2aa6d5">VTX_MAX_CHANNELS</a>; j++) {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#aa468ce987c1f14ad02956252f3e8c600">VIDEO_CHANNELS</a>[i][j] == freq) {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                band = <a class="code hl_enumeration" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfd">VideoBand</a>(i);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                channel = j;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>            }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        }</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>}</div>
</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="comment">// set the current power</span></div>
<div class="foldopen" id="foldopen00185" data-start="{" data-end="}">
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#ab90a52d1fee4d7a9a06d6b3adb64fee9">  185</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#ab90a52d1fee4d7a9a06d6b3adb64fee9">AP_VideoTX::set_configured_power_mw</a>(uint16_t power)</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>{</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.set_and_save_ifchanged(power);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>}</div>
</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="foldopen" id="foldopen00190" data-start="{" data-end="}">
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a2b8ad4e802d928f05c1a2312bc0686e4">  190</a></span>uint8_t <a class="code hl_function" href="classAP__VideoTX.html#a2b8ad4e802d928f05c1a2312bc0686e4">AP_VideoTX::find_current_power</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw) {</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>            <span class="keywordflow">return</span> i;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    }</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>}</div>
</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment">// set the power in dbm, rounding appropriately</span></div>
<div class="foldopen" id="foldopen00201" data-start="{" data-end="}">
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a49808899b10eb63b96d7e54d579150d1">  201</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#a49808899b10eb63b96d7e54d579150d1">AP_VideoTX::set_power_dbm</a>(uint8_t power, <a class="code hl_enumeration" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365c">PowerActive</a> active)</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>{</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].dbm</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].active == active) {</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    }</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].dbm) {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = active;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;learned power %ddbm&quot;</span>, power);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            <span class="comment">// now unlearn the &quot;other&quot; power level since we have no other way of guessing</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            <span class="comment">// the supported levels</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level &amp; 0xF0) == 0x10) {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">level</a> = <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">level</a> &amp; 0xF;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            }</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i-1].level == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level) {</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;invalidated power %dwm, level %d is now %dmw&quot;</span>, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i-1].mw, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">level</a> = 0xFF;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1 &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i+1].level == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level) {</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;invalidated power %dwm, level %d is now %dmw&quot;</span>, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i+1].mw, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i+1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">level</a> = 0xFF;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i+1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        }</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="comment">// learn the non-standard power</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = <a class="code hl_function" href="classAP__VideoTX.html#a8b6b664ec5edf3dedfea671ce274381c">update_power_dbm</a>(power, active);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>}</div>
</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="comment">// add an active power setting in dbm</span></div>
<div class="foldopen" id="foldopen00235" data-start="{" data-end="}">
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a8b6b664ec5edf3dedfea671ce274381c">  235</a></span>uint8_t <a class="code hl_function" href="classAP__VideoTX.html#a8b6b664ec5edf3dedfea671ce274381c">AP_VideoTX::update_power_dbm</a>(uint8_t power, <a class="code hl_enumeration" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365c">PowerActive</a> active)</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>{</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].dbm) {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].active != active) {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = active;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;%s power %ddbm&quot;</span>, active == <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca4d3d769b812b6faa6b76e1a8abaece2d">PowerActive::Active</a> ? <span class="stringliteral">&quot;learned&quot;</span> : <span class="stringliteral">&quot;invalidated&quot;</span>, power);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            <span class="keywordflow">return</span> i;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        }</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="comment">// handed a non-standard value, use the last slot</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a67c6211aefff76e5c7d67eb25416403d">dbm</a> = power;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">level</a> = 255;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aec82bb84bd916f5dccb371c1b6d0e614">dac</a> = 255;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a857161594a2676459c368a261da29772">mw</a> = uint16_t(roundf(powf(10, power / 10.0f)));</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = active;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;non-standard power %ddbm -&gt; %dmw&quot;</span>, power, <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1].mw);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>}</div>
</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="comment">// add all active power setting in dbm</span></div>
<div class="foldopen" id="foldopen00257" data-start="{" data-end="}">
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aa930334686caedd01ec66fd0d1632fee">  257</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aa930334686caedd01ec66fd0d1632fee">AP_VideoTX::update_all_power_dbm</a>(uint8_t nlevels, <span class="keyword">const</span> uint8_t power[])</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>{</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; nlevels; i++) {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <a class="code hl_function" href="classAP__VideoTX.html#a8b6b664ec5edf3dedfea671ce274381c">update_power_dbm</a>(power[i], <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca4d3d769b812b6faa6b76e1a8abaece2d">PowerActive::Active</a>);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <span class="comment">// invalidate the remaining ones</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].active == <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca88183b946cc5f0e8c96b2e66e1c74a7e">PowerActive::Unknown</a>) {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>}</div>
</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="comment">// set the power in mw</span></div>
<div class="foldopen" id="foldopen00271" data-start="{" data-end="}">
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aa8e084f93691bfd7030b24bf3eeb00a8">  271</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aa8e084f93691bfd7030b24bf3eeb00a8">AP_VideoTX::set_power_mw</a>(uint16_t power)</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>{</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw) {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    }</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>}</div>
</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="comment">// set the power &quot;level&quot;</span></div>
<div class="foldopen" id="foldopen00282" data-start="{" data-end="}">
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a83c90806d0886b24d2e386bbe6e00454">  282</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#a83c90806d0886b24d2e386bbe6e00454">AP_VideoTX::set_power_level</a>(uint8_t level, <a class="code hl_enumeration" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365c">PowerActive</a> active)</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>{</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordflow">if</span> (level == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].level</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].active == active) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="keywordflow">if</span> (level == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].level) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = active;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;learned power level %d: %dmw&quot;</span>, level, <a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>());</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>}</div>
</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">// set the power dac</span></div>
<div class="foldopen" id="foldopen00300" data-start="{" data-end="}">
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a4fc559ab572c0e548c0ae21146097c6a">  300</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#a4fc559ab572c0e548c0ae21146097c6a">AP_VideoTX::set_power_dac</a>(uint16_t power, <a class="code hl_enumeration" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365c">PowerActive</a> active)</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>{</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].dac</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a>].active == active) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        <span class="keywordflow">if</span> (power == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].dac) {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">_current_power</a> = i;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">active</a> = active;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>            <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;learned power %dmw&quot;</span>, <a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>());</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        }</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>}</div>
</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment">// set the current channel</span></div>
<div class="foldopen" id="foldopen00317" data-start="{" data-end="}">
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a9fa60fa89deb1460a01620dec0bb9382">  317</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#a9fa60fa89deb1460a01620dec0bb9382">AP_VideoTX::set_enabled</a>(<span class="keywordtype">bool</span> enabled)</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>{</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a2a031f3d2251f3dc1171d1d2b0de4134">_current_enabled</a> = enabled;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a>.configured()) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a>.set_and_save(enabled);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    }</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>}</div>
</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="foldopen" id="foldopen00325" data-start="{" data-end="}">
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#ae9729b3f3c48571bed0a31adc3d1d8a7">  325</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#ae9729b3f3c48571bed0a31adc3d1d8a7">AP_VideoTX::set_power_is_current</a>()</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>{</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <a class="code hl_function" href="classAP__VideoTX.html#a49808899b10eb63b96d7e54d579150d1">set_power_dbm</a>(<a class="code hl_function" href="classAP__VideoTX.html#a49efbe0ea3ce3bc962b121a75c228ef8">get_configured_power_dbm</a>());</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>}</div>
</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="foldopen" id="foldopen00330" data-start="{" data-end="}">
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aeaae2fa97af3b59ee84a164bd63b2c21">  330</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aeaae2fa97af3b59ee84a164bd63b2c21">AP_VideoTX::set_freq_is_current</a>()</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>{</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> = <a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <a class="code hl_variable" href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">_current_band</a> = <a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_variable" href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">_current_channel</a> = <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>}</div>
</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="comment">// periodic update</span></div>
<div class="foldopen" id="foldopen00338" data-start="{" data-end="}">
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#afa4cf772db054fd7a0d852b354a04e64">  338</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#afa4cf772db054fd7a0d852b354a04e64">AP_VideoTX::update</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>{</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a>) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="preprocessor">#if HAL_CRSF_TELEM_ENABLED</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    AP_CRSF_Telem* crsf = AP::crsf_telem();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <span class="keywordflow">if</span> (crsf != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        crsf-&gt;<a class="code hl_function" href="classAP__RCProtocol__CRSF.html#a52ed002beb58e3b17c3c9b7ed14bccf3">update</a>();</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="comment">// manipulate pitmode if pitmode-on-disarm or power-on-arm is set</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa707ebd5f0324ae04ce6cc6fb1a099112">VideoOptions::VTX_PITMODE_ON_DISARM</a>) || <a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafafe46a3b2bab0c50d5b92f8de9161d32a">VideoOptions::VTX_PITMODE_UNTIL_ARM</a>)) {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#a287a2b82fa30b92c8d52aad61d4d27b7">get_soft_armed</a>() &amp;&amp; <a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>)) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>.set(<a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a> &amp; ~uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>));</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#a287a2b82fa30b92c8d52aad61d4d27b7">get_soft_armed</a>() &amp;&amp; !<a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>)</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            &amp;&amp; <a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa707ebd5f0324ae04ce6cc6fb1a099112">VideoOptions::VTX_PITMODE_ON_DISARM</a>)) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>.set(<a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a> | uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>));</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="comment">// check that the requested power is actually allowed</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <span class="comment">// reset if not</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> != <a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>()) {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[<a class="code hl_function" href="classAP__VideoTX.html#a2b8ad4e802d928f05c1a2312bc0686e4">find_current_power</a>()].active == <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>) {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            <span class="comment">// reset to something we know works</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;power reset to %dmw from %dmw&quot;</span>, <a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>(), <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.get());</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.set_and_save(<a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>());</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>}</div>
</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="foldopen" id="foldopen00371" data-start="{" data-end="}">
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a9af115b5e12a16612f975712c40c9fd4">  371</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#a9af115b5e12a16612f975712c40c9fd4">AP_VideoTX::update_options</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#ac34698b5484510fc123cc8b77e6ab193">_defaults_set</a>) {</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    }</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">// check pitmode</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a> &amp; uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>))</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        != (<a class="code hl_variable" href="classAP__VideoTX.html#a27fc36df8308ebf3acc823c972c35b6c">_current_options</a> &amp; uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>))) {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="preprocessor">#if HAL_CRSF_TELEM_ENABLED</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">// using CRSF so unlock is not an option</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <span class="keywordflow">if</span> (AP::crsf_telem() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="comment">// check unlock only</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a> &amp; uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa9502d01fef6b9b48a58b9550636502eb">VideoOptions::VTX_UNLOCKED</a>)) != 0</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        &amp;&amp; (<a class="code hl_variable" href="classAP__VideoTX.html#a27fc36df8308ebf3acc823c972c35b6c">_current_options</a> &amp; uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa9502d01fef6b9b48a58b9550636502eb">VideoOptions::VTX_UNLOCKED</a>)) == 0) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    }</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="comment">// ignore everything else</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>}</div>
</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="foldopen" id="foldopen00398" data-start="{" data-end="}">
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#a186f92a02b1f54b4ca9c17ca4955b373">  398</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#a186f92a02b1f54b4ca9c17ca4955b373">AP_VideoTX::update_power</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#ac34698b5484510fc123cc8b77e6ab193">_defaults_set</a> || <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> == <a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>() || <a class="code hl_function" href="classAP__VideoTX.html#a69cdd3902662eeb963905cc6df2f2ffa">get_pitmode</a>()) {</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    }</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="comment">// check that the requested power is actually allowed</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a> == <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>            &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].active != <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        }</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    }</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="comment">// asked for something unsupported - only SA2.1 allows this and will have already provided a list</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>}</div>
</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="foldopen" id="foldopen00413" data-start="{" data-end="}">
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#abb4ecef27245c95992e33e95e4f1b9b5">  413</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#abb4ecef27245c95992e33e95e4f1b9b5">AP_VideoTX::have_params_changed</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        &amp;&amp; (<a class="code hl_function" href="classAP__VideoTX.html#a186f92a02b1f54b4ca9c17ca4955b373">update_power</a>()</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        || <a class="code hl_function" href="classAP__VideoTX.html#a3fb3daefe5d165f69f309775c87bc2a7">update_band</a>()</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        || <a class="code hl_function" href="classAP__VideoTX.html#a59956d72d54dd6d9e9523153a88740c3">update_channel</a>()</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        || <a class="code hl_function" href="classAP__VideoTX.html#a315876511697a94ecbd5dde7855b1f21">update_frequency</a>()</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        || <a class="code hl_function" href="classAP__VideoTX.html#a9af115b5e12a16612f975712c40c9fd4">update_options</a>());</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>}</div>
</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="comment">// update the configured frequency to match the channel and band</span></div>
<div class="foldopen" id="foldopen00424" data-start="{" data-end="}">
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aeb76b7b55f0a335c6dc45b4df179b806">  424</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aeb76b7b55f0a335c6dc45b4df179b806">AP_VideoTX::update_configured_frequency</a>()</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>{</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>.set_and_save(<a class="code hl_function" href="classAP__VideoTX.html#a67ca27732ecc878a08d14a3822b4b5bb">get_frequency_mhz</a>(<a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>, <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>));</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>}</div>
</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span><span class="comment">// update the configured channel and band to match the frequency</span></div>
<div class="foldopen" id="foldopen00430" data-start="{" data-end="}">
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#ad876ef2a0a224a2ee109e015f3561608">  430</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#ad876ef2a0a224a2ee109e015f3561608">AP_VideoTX::update_configured_channel_and_band</a>()</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>{</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <a class="code hl_enumeration" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfd">VideoBand</a> band;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    uint8_t channel;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__VideoTX.html#a00e3a8c2c66b5309b4986023e9e2878c">get_band_and_channel</a>(<a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>, band, channel)) {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>.set_and_save(band);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>.set_and_save(channel);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>        <a class="code hl_function" href="classAP__VideoTX.html#aeb76b7b55f0a335c6dc45b4df179b806">update_configured_frequency</a>();</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>}</div>
</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="comment">// set the current configured values if not currently set in storage</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span><span class="comment">// this is necessary so that the current settings can be seen</span></div>
<div class="foldopen" id="foldopen00444" data-start="{" data-end="}">
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#ab0763873fbbd897789085147cd1d269b">  444</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__VideoTX.html#ab0763873fbbd897789085147cd1d269b">AP_VideoTX::set_defaults</a>()</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>{</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#ac34698b5484510fc123cc8b77e6ab193">_defaults_set</a>) {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">// check that our current view of frequency matches band/channel</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="comment">// if not then force one to be correct</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    uint16_t calced_freq = <a class="code hl_function" href="classAP__VideoTX.html#a67ca27732ecc878a08d14a3822b4b5bb">get_frequency_mhz</a>(<a class="code hl_variable" href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">_current_band</a>, <a class="code hl_variable" href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">_current_channel</a>);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> != calced_freq) {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> &gt; 0) {</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            <a class="code hl_enumeration" href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfd">VideoBand</a> band;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>            uint8_t channel;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__VideoTX.html#a00e3a8c2c66b5309b4986023e9e2878c">get_band_and_channel</a>(<a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a>, band, channel)) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">_current_band</a> = band;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>                <a class="code hl_variable" href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">_current_channel</a> = channel;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                <a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> = calced_freq;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>            <a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a> = calced_freq;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    }</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>.configured()) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">_options</a>.set_and_save(<a class="code hl_variable" href="classAP__VideoTX.html#a27fc36df8308ebf3acc823c972c35b6c">_current_options</a>);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    }</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>.configured()) {</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>.set_and_save(<a class="code hl_variable" href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">_current_channel</a>);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    }</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>.configured()) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>.set_and_save(<a class="code hl_variable" href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">_current_band</a>);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    }</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.configured()) {</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.set_and_save(<a class="code hl_function" href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">get_power_mw</a>());</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>.configured()) {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        <a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>.set_and_save(<a class="code hl_variable" href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">_current_frequency</a>);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="comment">// Now check that the user didn&#39;t screw up by selecting incompatible options</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a> != <a class="code hl_function" href="classAP__VideoTX.html#a67ca27732ecc878a08d14a3822b4b5bb">get_frequency_mhz</a>(<a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>, <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>)) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a> &gt; 0) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <a class="code hl_function" href="classAP__VideoTX.html#ad876ef2a0a224a2ee109e015f3561608">update_configured_channel_and_band</a>();</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            <a class="code hl_function" href="classAP__VideoTX.html#aeb76b7b55f0a335c6dc45b4df179b806">update_configured_frequency</a>();</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        }</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    }</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <a class="code hl_variable" href="classAP__VideoTX.html#ac34698b5484510fc123cc8b77e6ab193">_defaults_set</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <a class="code hl_function" href="classAP__VideoTX.html#aa1f1b81b73632a48e1623813be473cfa">announce_vtx_settings</a>();</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>}</div>
</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="foldopen" id="foldopen00500" data-start="{" data-end="}">
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aa1f1b81b73632a48e1623813be473cfa">  500</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aa1f1b81b73632a48e1623813be473cfa">AP_VideoTX::announce_vtx_settings</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <span class="comment">// Output a friendly message so the user knows the VTX has been detected</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;VTX: %s%d %dMHz, PWR: %dmW&quot;</span>,</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>        <a class="code hl_variable" href="classAP__VideoTX.html#a9526d86ea8841c1e4e342893a56dc53d">band_names</a>[<a class="code hl_variable" href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">_band</a>.get()], <a class="code hl_variable" href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">_channel</a>.get() + 1, <a class="code hl_variable" href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">_frequency_mhz</a>.get(),</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        <a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>) ? 0 : <a class="code hl_variable" href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">_power_mw</a>.get());</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>}</div>
</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">// change the video power based on switch input</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span><span class="comment">// 6-pos range is in the middle of the available range</span></div>
<div class="foldopen" id="foldopen00510" data-start="{" data-end="}">
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno"><a class="line" href="classAP__VideoTX.html#aa3a2888e3af8deaa29c1123e2ac09d71">  510</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__VideoTX.html#aa3a2888e3af8deaa29c1123e2ac09d71">AP_VideoTX::change_power</a>(int8_t position)</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>{</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">_enabled</a> || position &lt; 0 || position &gt; 5) {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    }</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <span class="comment">// first find out how many possible levels there are</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    uint8_t num_active_levels = 0;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>; i++) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].active != <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a> &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[i].mw &lt;= <a class="code hl_variable" href="classAP__VideoTX.html#a21859fb1157d56a9939f804af21ffa24">_max_power_mw</a>) {</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>            num_active_levels++;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>        }</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    }</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="comment">// iterate through to find the level</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    uint16_t level = <a class="code hl_function" href="AP__Math_8h.html#a68558c4f79a8582543daefde13c64abc">constrain_int16</a>(roundf((num_active_levels * (position + 1)/ 6.0f) - 1), 0, num_active_levels - 1);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;looking for pos %d power level %d from %d&quot;</span>, position, level, num_active_levels);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    uint16_t power = 0;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="keywordflow">for</span> (uint8_t i = 0, j = 0; i &lt; num_active_levels; i++, j++) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <span class="keywordflow">while</span> (j &lt; <a class="code hl_define" href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a>-1 &amp;&amp; <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[j].active == <a class="code hl_enumvalue" href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">PowerActive::Inactive</a>) {</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            j++;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="keywordflow">if</span> (i == level) {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            power = <a class="code hl_variable" href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">_power_levels</a>[j].<a class="code hl_variable" href="structAP__VideoTX_1_1PowerLevel.html#a857161594a2676459c368a261da29772">mw</a>;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            <a class="code hl_define" href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a>(<span class="stringliteral">&quot;selected power %dmw&quot;</span>, power);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        }</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="keywordflow">if</span> (power == 0) {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#a287a2b82fa30b92c8d52aad61d4d27b7">get_soft_armed</a>()) {    <span class="comment">// don&#39;t allow pitmode to be entered if already armed</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            <a class="code hl_function" href="classAP__VideoTX.html#a2a0d278cb502ff08d7f72a7dd4d13667">set_configured_options</a>(<a class="code hl_function" href="classAP__VideoTX.html#a2fc5716e79b162e128b95fcd65e77972">get_configured_options</a>() | uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>));</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">has_option</a>(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>)) {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            <a class="code hl_function" href="classAP__VideoTX.html#a2a0d278cb502ff08d7f72a7dd4d13667">set_configured_options</a>(<a class="code hl_function" href="classAP__VideoTX.html#a2fc5716e79b162e128b95fcd65e77972">get_configured_options</a>() &amp; ~uint8_t(<a class="code hl_enumvalue" href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">VideoOptions::VTX_PITMODE</a>));</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <a class="code hl_function" href="classAP__VideoTX.html#ab90a52d1fee4d7a9a06d6b3adb64fee9">set_configured_power_mw</a>(power);</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>}</div>
</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceAP.html">AP</a> {</div>
<div class="foldopen" id="foldopen00550" data-start="{" data-end="}">
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno"><a class="line" href="namespaceAP.html#addbcda2c64392bd274a855c3846a8e02">  550</a></span>    <a class="code hl_class" href="classAP__VideoTX.html">AP_VideoTX</a>&amp; <a class="code hl_function" href="namespaceAP.html#addbcda2c64392bd274a855c3846a8e02">vtx</a>() {</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="keywordflow">return</span> *<a class="code hl_function" href="classAP__VideoTX.html#a29799dfe596fd5cd23896defe02acbbc">AP_VideoTX::get_singleton</a>();</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    }</div>
</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>};</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aAC__AttitudeControl_8cpp_html_a240c1a4ae2a70d1855f91e4a0b1ac938"><div class="ttname"><a href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition</b> <a href="AP__Compass__AK09916_8cpp_source.html#l00059">AP_Compass_AK09916.cpp:59</a></div></div>
<div class="ttc" id="aAP__ADC__ADS1115_8cpp_html_a4cabfd12f7acea54d1d16436e9de5dc8"><div class="ttname"><a href="AP__ADC__ADS1115_8cpp.html#a4cabfd12f7acea54d1d16436e9de5dc8">debug</a></div><div class="ttdeci">#define debug(fmt, args ...)</div><div class="ttdef"><b>Definition</b> <a href="AP__ADC__ADS1115_8cpp_source.html#l00090">AP_ADC_ADS1115.cpp:90</a></div></div>
<div class="ttc" id="aAP__CRSF__Telem_8h_html"><div class="ttname"><a href="AP__CRSF__Telem_8h.html">AP_CRSF_Telem.h</a></div></div>
<div class="ttc" id="aAP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a68558c4f79a8582543daefde13c64abc"><div class="ttname"><a href="AP__Math_8h.html#a68558c4f79a8582543daefde13c64abc">constrain_int16</a></div><div class="ttdeci">int16_t constrain_int16(const int16_t amt, const int16_t low, const int16_t high)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00177">AP_Math.h:177</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00163">AP_Param.h:163</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00145">AP_Param.h:145</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_ac24e2eb16c2194e975d27e47ddcb7f1c"><div class="ttname"><a href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a></div><div class="ttdeci">#define AP_GROUPINFO_FLAGS(name, idx, clazz, element, def, flags)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00133">AP_Param.h:133</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_ad9ca22a1e508dceea20feda89a344f9aa0b4d6edc70defa90b393a877f6178d42"><div class="ttname"><a href="AP__Param_8h.html#ad9ca22a1e508dceea20feda89a344f9aa0b4d6edc70defa90b393a877f6178d42">AP_PARAM_INT16</a></div><div class="ttdeci">@ AP_PARAM_INT16</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00181">AP_Param.h:181</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_ae25c1c7495435989f8be5781c86be078"><div class="ttname"><a href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a></div><div class="ttdeci">#define AP_PARAM_FLAG_ENABLE</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00087">AP_Param.h:87</a></div></div>
<div class="ttc" id="aAP__VideoTX_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__VideoTX_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition</b> <a href="#l00088">AP_VideoTX.cpp:88</a></div></div>
<div class="ttc" id="aAP__VideoTX_8h_html"><div class="ttname"><a href="AP__VideoTX_8h.html">AP_VideoTX.h</a></div></div>
<div class="ttc" id="aAP__VideoTX_8h_html_a7203c369bf1a8f6a5551d69b4a2aa6d5"><div class="ttname"><a href="AP__VideoTX_8h.html#a7203c369bf1a8f6a5551d69b4a2aa6d5">VTX_MAX_CHANNELS</a></div><div class="ttdeci">#define VTX_MAX_CHANNELS</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00023">AP_VideoTX.h:23</a></div></div>
<div class="ttc" id="aAP__VideoTX_8h_html_af4cfe21269d6f1f28fea6afccd7ce3ae"><div class="ttname"><a href="AP__VideoTX_8h.html#af4cfe21269d6f1f28fea6afccd7ce3ae">VTX_MAX_POWER_LEVELS</a></div><div class="ttdeci">#define VTX_MAX_POWER_LEVELS</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00024">AP_VideoTX.h:24</a></div></div>
<div class="ttc" id="aGCS_8h_html"><div class="ttname"><a href="GCS_8h.html">GCS.h</a></div><div class="ttdoc">Interface definition for the various Ground Control System.</div></div>
<div class="ttc" id="aGCS_8h_html_a266bfe8eda675e1092f045e93932b4a6"><div class="ttname"><a href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a></div><div class="ttdeci">#define GCS_SEND_TEXT(severity, format, args...)</div><div class="ttdef"><b>Definition</b> <a href="GCS_8h_source.html#l01349">GCS.h:1349</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html_a9337a60383f4264fa96a20dbe43a4e2e"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">AP_HAL::HAL::util</a></div><div class="ttdeci">AP_HAL::Util * util</div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00131">HAL.h:131</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Util_html_a287a2b82fa30b92c8d52aad61d4d27b7"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a287a2b82fa30b92c8d52aad61d4d27b7">AP_HAL::Util::get_soft_armed</a></div><div class="ttdeci">bool get_soft_armed() const</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Util_8h_source.html#l00018">Util.h:18</a></div></div>
<div class="ttc" id="aclassAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00010">main.cpp:10</a></div></div>
<div class="ttc" id="aclassAP__RCProtocol__CRSF_html_a52ed002beb58e3b17c3c9b7ed14bccf3"><div class="ttname"><a href="classAP__RCProtocol__CRSF.html#a52ed002beb58e3b17c3c9b7ed14bccf3">AP_RCProtocol_CRSF::update</a></div><div class="ttdeci">void update(void) override</div><div class="ttdef"><b>Definition</b> <a href="AP__RCProtocol__CRSF_8cpp_source.html#l00343">AP_RCProtocol_CRSF.cpp:343</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html"><div class="ttname"><a href="classAP__VideoTX.html">AP_VideoTX</a></div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00026">AP_VideoTX.h:26</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a00e3a8c2c66b5309b4986023e9e2878c"><div class="ttname"><a href="classAP__VideoTX.html#a00e3a8c2c66b5309b4986023e9e2878c">AP_VideoTX::get_band_and_channel</a></div><div class="ttdeci">static bool get_band_and_channel(uint16_t freq, VideoBand &amp;band, uint8_t &amp;channel)</div><div class="ttdef"><b>Definition</b> <a href="#l00170">AP_VideoTX.cpp:170</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a03573a6043a1de498867987b049955eb"><div class="ttname"><a href="classAP__VideoTX.html#a03573a6043a1de498867987b049955eb">AP_VideoTX::~AP_VideoTX</a></div><div class="ttdeci">~AP_VideoTX()</div><div class="ttdef"><b>Definition</b> <a href="#l00132">AP_VideoTX.cpp:132</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a08eb99b3af33a6381a6f5c50bcbe376c"><div class="ttname"><a href="classAP__VideoTX.html#a08eb99b3af33a6381a6f5c50bcbe376c">AP_VideoTX::singleton</a></div><div class="ttdeci">static AP_VideoTX * singleton</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00166">AP_VideoTX.h:166</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a186f92a02b1f54b4ca9c17ca4955b373"><div class="ttname"><a href="classAP__VideoTX.html#a186f92a02b1f54b4ca9c17ca4955b373">AP_VideoTX::update_power</a></div><div class="ttdeci">bool update_power() const</div><div class="ttdef"><b>Definition</b> <a href="#l00398">AP_VideoTX.cpp:398</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a21859fb1157d56a9939f804af21ffa24"><div class="ttname"><a href="classAP__VideoTX.html#a21859fb1157d56a9939f804af21ffa24">AP_VideoTX::_max_power_mw</a></div><div class="ttdeci">AP_Int16 _max_power_mw</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00177">AP_VideoTX.h:177</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a23ba5a6be90528a4f4ba3de8f073bad5"><div class="ttname"><a href="classAP__VideoTX.html#a23ba5a6be90528a4f4ba3de8f073bad5">AP_VideoTX::_initialized</a></div><div class="ttdeci">bool _initialized</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00194">AP_VideoTX.h:194</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a27fc36df8308ebf3acc823c972c35b6c"><div class="ttname"><a href="classAP__VideoTX.html#a27fc36df8308ebf3acc823c972c35b6c">AP_VideoTX::_current_options</a></div><div class="ttdeci">uint16_t _current_options</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00189">AP_VideoTX.h:189</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a29799dfe596fd5cd23896defe02acbbc"><div class="ttname"><a href="classAP__VideoTX.html#a29799dfe596fd5cd23896defe02acbbc">AP_VideoTX::get_singleton</a></div><div class="ttdeci">static AP_VideoTX * get_singleton(void)</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00040">AP_VideoTX.h:40</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a2a031f3d2251f3dc1171d1d2b0de4134"><div class="ttname"><a href="classAP__VideoTX.html#a2a031f3d2251f3dc1171d1d2b0de4134">AP_VideoTX::_current_enabled</a></div><div class="ttdeci">bool _current_enabled</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00192">AP_VideoTX.h:192</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a2a0d278cb502ff08d7f72a7dd4d13667"><div class="ttname"><a href="classAP__VideoTX.html#a2a0d278cb502ff08d7f72a7dd4d13667">AP_VideoTX::set_configured_options</a></div><div class="ttdeci">void set_configured_options(uint16_t options)</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00140">AP_VideoTX.h:140</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a2b8ad4e802d928f05c1a2312bc0686e4"><div class="ttname"><a href="classAP__VideoTX.html#a2b8ad4e802d928f05c1a2312bc0686e4">AP_VideoTX::find_current_power</a></div><div class="ttdeci">uint8_t find_current_power() const</div><div class="ttdef"><b>Definition</b> <a href="#l00190">AP_VideoTX.cpp:190</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a2fc5716e79b162e128b95fcd65e77972"><div class="ttname"><a href="classAP__VideoTX.html#a2fc5716e79b162e128b95fcd65e77972">AP_VideoTX::get_configured_options</a></div><div class="ttdeci">uint16_t get_configured_options() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00141">AP_VideoTX.h:141</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a315876511697a94ecbd5dde7855b1f21"><div class="ttname"><a href="classAP__VideoTX.html#a315876511697a94ecbd5dde7855b1f21">AP_VideoTX::update_frequency</a></div><div class="ttdeci">bool update_frequency() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00095">AP_VideoTX.h:95</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a3b5dccf84fd29f225e28e8b16d1cafac"><div class="ttname"><a href="classAP__VideoTX.html#a3b5dccf84fd29f225e28e8b16d1cafac">AP_VideoTX::_power_levels</a></div><div class="ttdeci">static PowerLevel _power_levels[VTX_MAX_POWER_LEVELS]</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00107">AP_VideoTX.h:107</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a3fb3daefe5d165f69f309775c87bc2a7"><div class="ttname"><a href="classAP__VideoTX.html#a3fb3daefe5d165f69f309775c87bc2a7">AP_VideoTX::update_band</a></div><div class="ttdeci">bool update_band() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00130">AP_VideoTX.h:130</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a44d89d222b8f3131e8365f8ac7785942"><div class="ttname"><a href="classAP__VideoTX.html#a44d89d222b8f3131e8365f8ac7785942">AP_VideoTX::_options</a></div><div class="ttdeci">AP_Int16 _options</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00188">AP_VideoTX.h:188</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a49808899b10eb63b96d7e54d579150d1"><div class="ttname"><a href="classAP__VideoTX.html#a49808899b10eb63b96d7e54d579150d1">AP_VideoTX::set_power_dbm</a></div><div class="ttdeci">void set_power_dbm(uint8_t power, PowerActive active=PowerActive::Active)</div><div class="ttdef"><b>Definition</b> <a href="#l00201">AP_VideoTX.cpp:201</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a49efbe0ea3ce3bc962b121a75c228ef8"><div class="ttname"><a href="classAP__VideoTX.html#a49efbe0ea3ce3bc962b121a75c228ef8">AP_VideoTX::get_configured_power_dbm</a></div><div class="ttdeci">uint8_t get_configured_power_dbm() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00110">AP_VideoTX.h:110</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a4f42b17d4c654c78f881ce7339f9ceac"><div class="ttname"><a href="classAP__VideoTX.html#a4f42b17d4c654c78f881ce7339f9ceac">AP_VideoTX::_current_power</a></div><div class="ttdeci">uint16_t _current_power</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00176">AP_VideoTX.h:176</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a4fc559ab572c0e548c0ae21146097c6a"><div class="ttname"><a href="classAP__VideoTX.html#a4fc559ab572c0e548c0ae21146097c6a">AP_VideoTX::set_power_dac</a></div><div class="ttdeci">void set_power_dac(uint16_t power, PowerActive active=PowerActive::Active)</div><div class="ttdef"><b>Definition</b> <a href="#l00300">AP_VideoTX.cpp:300</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a5052437b01fd7622a80e986f34fca5d8"><div class="ttname"><a href="classAP__VideoTX.html#a5052437b01fd7622a80e986f34fca5d8">AP_VideoTX::_enabled</a></div><div class="ttdeci">AP_Int8 _enabled</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00191">AP_VideoTX.h:191</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a59956d72d54dd6d9e9523153a88740c3"><div class="ttname"><a href="classAP__VideoTX.html#a59956d72d54dd6d9e9523153a88740c3">AP_VideoTX::update_channel</a></div><div class="ttdeci">bool update_channel() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00136">AP_VideoTX.h:136</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a6620c6acabc71b8ddbd4f41469242ec4"><div class="ttname"><a href="classAP__VideoTX.html#a6620c6acabc71b8ddbd4f41469242ec4">AP_VideoTX::_current_frequency</a></div><div class="ttdeci">uint16_t _current_frequency</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00172">AP_VideoTX.h:172</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a67ca27732ecc878a08d14a3822b4b5bb"><div class="ttname"><a href="classAP__VideoTX.html#a67ca27732ecc878a08d14a3822b4b5bb">AP_VideoTX::get_frequency_mhz</a></div><div class="ttdeci">uint16_t get_frequency_mhz() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00093">AP_VideoTX.h:93</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a69cdd3902662eeb963905cc6df2f2ffa"><div class="ttname"><a href="classAP__VideoTX.html#a69cdd3902662eeb963905cc6df2f2ffa">AP_VideoTX::get_pitmode</a></div><div class="ttdeci">bool get_pitmode() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00145">AP_VideoTX.h:145</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a6efda3e0eb380973346c3499952b8b6c"><div class="ttname"><a href="classAP__VideoTX.html#a6efda3e0eb380973346c3499952b8b6c">AP_VideoTX::has_option</a></div><div class="ttdeci">bool has_option(VideoOptions option) const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00143">AP_VideoTX.h:143</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a76dac8b6261eb58cc098d527d0e108ad"><div class="ttname"><a href="classAP__VideoTX.html#a76dac8b6261eb58cc098d527d0e108ad">AP_VideoTX::_band</a></div><div class="ttdeci">AP_Int8 _band</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00180">AP_VideoTX.h:180</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a79b48609eeda2cf540f6630d30bd4f16"><div class="ttname"><a href="classAP__VideoTX.html#a79b48609eeda2cf540f6630d30bd4f16">AP_VideoTX::_power_mw</a></div><div class="ttdeci">AP_Int16 _power_mw</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00175">AP_VideoTX.h:175</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a81d8d802bfced62604a5cf0a14e13ebb"><div class="ttname"><a href="classAP__VideoTX.html#a81d8d802bfced62604a5cf0a14e13ebb">AP_VideoTX::get_power_mw</a></div><div class="ttdeci">uint16_t get_power_mw() const</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00107">AP_VideoTX.h:107</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a83c90806d0886b24d2e386bbe6e00454"><div class="ttname"><a href="classAP__VideoTX.html#a83c90806d0886b24d2e386bbe6e00454">AP_VideoTX::set_power_level</a></div><div class="ttdeci">void set_power_level(uint8_t level, PowerActive active=PowerActive::Active)</div><div class="ttdef"><b>Definition</b> <a href="#l00282">AP_VideoTX.cpp:282</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a852a9d0349351ba7e1f3ad83d3412cfd"><div class="ttname"><a href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfd">AP_VideoTX::VideoBand</a></div><div class="ttdeci">VideoBand</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00058">AP_VideoTX.h:58</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a852a9d0349351ba7e1f3ad83d3412cfda9df1808c145fc9886449942dd290da01"><div class="ttname"><a href="classAP__VideoTX.html#a852a9d0349351ba7e1f3ad83d3412cfda9df1808c145fc9886449942dd290da01">AP_VideoTX::MAX_BANDS</a></div><div class="ttdeci">@ MAX_BANDS</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00068">AP_VideoTX.h:67</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a8b6b664ec5edf3dedfea671ce274381c"><div class="ttname"><a href="classAP__VideoTX.html#a8b6b664ec5edf3dedfea671ce274381c">AP_VideoTX::update_power_dbm</a></div><div class="ttdeci">uint8_t update_power_dbm(uint8_t power, PowerActive active=PowerActive::Active)</div><div class="ttdef"><b>Definition</b> <a href="#l00235">AP_VideoTX.cpp:235</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a9526d86ea8841c1e4e342893a56dc53d"><div class="ttname"><a href="classAP__VideoTX.html#a9526d86ea8841c1e4e342893a56dc53d">AP_VideoTX::band_names</a></div><div class="ttdeci">static const char * band_names[]</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00090">AP_VideoTX.h:90</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a965bd863451c2504ea427ed96d9787fc"><div class="ttname"><a href="classAP__VideoTX.html#a965bd863451c2504ea427ed96d9787fc">AP_VideoTX::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00029">AP_VideoTX.h:29</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a9af115b5e12a16612f975712c40c9fd4"><div class="ttname"><a href="classAP__VideoTX.html#a9af115b5e12a16612f975712c40c9fd4">AP_VideoTX::update_options</a></div><div class="ttdeci">bool update_options() const</div><div class="ttdef"><b>Definition</b> <a href="#l00371">AP_VideoTX.cpp:371</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a9c8fbf757f3f2b7f7b7486a3e45dcbfb"><div class="ttname"><a href="classAP__VideoTX.html#a9c8fbf757f3f2b7f7b7486a3e45dcbfb">AP_VideoTX::_current_band</a></div><div class="ttdeci">uint16_t _current_band</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00181">AP_VideoTX.h:181</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a9fa60fa89deb1460a01620dec0bb9382"><div class="ttname"><a href="classAP__VideoTX.html#a9fa60fa89deb1460a01620dec0bb9382">AP_VideoTX::set_enabled</a></div><div class="ttdeci">void set_enabled(bool enabled)</div><div class="ttdef"><b>Definition</b> <a href="#l00317">AP_VideoTX.cpp:317</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_a9fc0196fc2d07006ea3fdeae5685d01e"><div class="ttname"><a href="classAP__VideoTX.html#a9fc0196fc2d07006ea3fdeae5685d01e">AP_VideoTX::init</a></div><div class="ttdeci">bool init()</div><div class="ttdef"><b>Definition</b> <a href="#l00137">AP_VideoTX.cpp:137</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aa1f1b81b73632a48e1623813be473cfa"><div class="ttname"><a href="classAP__VideoTX.html#aa1f1b81b73632a48e1623813be473cfa">AP_VideoTX::announce_vtx_settings</a></div><div class="ttdeci">void announce_vtx_settings() const</div><div class="ttdef"><b>Definition</b> <a href="#l00500">AP_VideoTX.cpp:500</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aa3a2888e3af8deaa29c1123e2ac09d71"><div class="ttname"><a href="classAP__VideoTX.html#aa3a2888e3af8deaa29c1123e2ac09d71">AP_VideoTX::change_power</a></div><div class="ttdeci">void change_power(int8_t position)</div><div class="ttdef"><b>Definition</b> <a href="#l00510">AP_VideoTX.cpp:510</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aa468ce987c1f14ad02956252f3e8c600"><div class="ttname"><a href="classAP__VideoTX.html#aa468ce987c1f14ad02956252f3e8c600">AP_VideoTX::VIDEO_CHANNELS</a></div><div class="ttdeci">static const uint16_t VIDEO_CHANNELS[MAX_BANDS][VTX_MAX_CHANNELS]</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00092">AP_VideoTX.h:92</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aa8e084f93691bfd7030b24bf3eeb00a8"><div class="ttname"><a href="classAP__VideoTX.html#aa8e084f93691bfd7030b24bf3eeb00a8">AP_VideoTX::set_power_mw</a></div><div class="ttdeci">void set_power_mw(uint16_t power)</div><div class="ttdef"><b>Definition</b> <a href="#l00271">AP_VideoTX.cpp:271</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aa930334686caedd01ec66fd0d1632fee"><div class="ttname"><a href="classAP__VideoTX.html#aa930334686caedd01ec66fd0d1632fee">AP_VideoTX::update_all_power_dbm</a></div><div class="ttdeci">void update_all_power_dbm(uint8_t nlevels, const uint8_t levels[])</div><div class="ttdef"><b>Definition</b> <a href="#l00257">AP_VideoTX.cpp:257</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a"><div class="ttname"><a href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa0ccf3897079c9e543d1e767a6be26b9a">AP_VideoTX::VideoOptions::VTX_PITMODE</a></div><div class="ttdeci">@ VTX_PITMODE</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aace853f2bc9cfdd0ba947e5e91d2ecafa707ebd5f0324ae04ce6cc6fb1a099112"><div class="ttname"><a href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa707ebd5f0324ae04ce6cc6fb1a099112">AP_VideoTX::VideoOptions::VTX_PITMODE_ON_DISARM</a></div><div class="ttdeci">@ VTX_PITMODE_ON_DISARM</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aace853f2bc9cfdd0ba947e5e91d2ecafa9502d01fef6b9b48a58b9550636502eb"><div class="ttname"><a href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafa9502d01fef6b9b48a58b9550636502eb">AP_VideoTX::VideoOptions::VTX_UNLOCKED</a></div><div class="ttdeci">@ VTX_UNLOCKED</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aace853f2bc9cfdd0ba947e5e91d2ecafafe46a3b2bab0c50d5b92f8de9161d32a"><div class="ttname"><a href="classAP__VideoTX.html#aace853f2bc9cfdd0ba947e5e91d2ecafafe46a3b2bab0c50d5b92f8de9161d32a">AP_VideoTX::VideoOptions::VTX_PITMODE_UNTIL_ARM</a></div><div class="ttdeci">@ VTX_PITMODE_UNTIL_ARM</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ab0763873fbbd897789085147cd1d269b"><div class="ttname"><a href="classAP__VideoTX.html#ab0763873fbbd897789085147cd1d269b">AP_VideoTX::set_defaults</a></div><div class="ttdeci">bool set_defaults()</div><div class="ttdef"><b>Definition</b> <a href="#l00444">AP_VideoTX.cpp:444</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ab90a52d1fee4d7a9a06d6b3adb64fee9"><div class="ttname"><a href="classAP__VideoTX.html#ab90a52d1fee4d7a9a06d6b3adb64fee9">AP_VideoTX::set_configured_power_mw</a></div><div class="ttdeci">void set_configured_power_mw(uint16_t power)</div><div class="ttdef"><b>Definition</b> <a href="#l00185">AP_VideoTX.cpp:185</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_abb4ecef27245c95992e33e95e4f1b9b5"><div class="ttname"><a href="classAP__VideoTX.html#abb4ecef27245c95992e33e95e4f1b9b5">AP_VideoTX::have_params_changed</a></div><div class="ttdeci">bool have_params_changed() const</div><div class="ttdef"><b>Definition</b> <a href="#l00413">AP_VideoTX.cpp:413</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_abc691f733a8665bd6e257011b5e642ff"><div class="ttname"><a href="classAP__VideoTX.html#abc691f733a8665bd6e257011b5e642ff">AP_VideoTX::_current_channel</a></div><div class="ttdeci">uint8_t _current_channel</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00185">AP_VideoTX.h:185</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ac34698b5484510fc123cc8b77e6ab193"><div class="ttname"><a href="classAP__VideoTX.html#ac34698b5484510fc123cc8b77e6ab193">AP_VideoTX::_defaults_set</a></div><div class="ttdeci">bool _defaults_set</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00196">AP_VideoTX.h:196</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad21b61b7c777f70a0d0521754d55365c"><div class="ttname"><a href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365c">AP_VideoTX::PowerActive</a></div><div class="ttdeci">PowerActive</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00070">AP_VideoTX.h:70</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0"><div class="ttname"><a href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca3cab03c00dbd11bc3569afa0748013f0">AP_VideoTX::PowerActive::Inactive</a></div><div class="ttdeci">@ Inactive</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad21b61b7c777f70a0d0521754d55365ca4d3d769b812b6faa6b76e1a8abaece2d"><div class="ttname"><a href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca4d3d769b812b6faa6b76e1a8abaece2d">AP_VideoTX::PowerActive::Active</a></div><div class="ttdeci">@ Active</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad21b61b7c777f70a0d0521754d55365ca88183b946cc5f0e8c96b2e66e1c74a7e"><div class="ttname"><a href="classAP__VideoTX.html#ad21b61b7c777f70a0d0521754d55365ca88183b946cc5f0e8c96b2e66e1c74a7e">AP_VideoTX::PowerActive::Unknown</a></div><div class="ttdeci">@ Unknown</div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad49eddd91d4c033d477419338b841cd5"><div class="ttname"><a href="classAP__VideoTX.html#ad49eddd91d4c033d477419338b841cd5">AP_VideoTX::AP_VideoTX</a></div><div class="ttdeci">AP_VideoTX()</div><div class="ttdef"><b>Definition</b> <a href="#l00121">AP_VideoTX.cpp:121</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ad876ef2a0a224a2ee109e015f3561608"><div class="ttname"><a href="classAP__VideoTX.html#ad876ef2a0a224a2ee109e015f3561608">AP_VideoTX::update_configured_channel_and_band</a></div><div class="ttdeci">void update_configured_channel_and_band()</div><div class="ttdef"><b>Definition</b> <a href="#l00430">AP_VideoTX.cpp:430</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_adcd59abd75f873e2add105c96dfae29a"><div class="ttname"><a href="classAP__VideoTX.html#adcd59abd75f873e2add105c96dfae29a">AP_VideoTX::_frequency_mhz</a></div><div class="ttdeci">AP_Int16 _frequency_mhz</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00171">AP_VideoTX.h:171</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_ae9729b3f3c48571bed0a31adc3d1d8a7"><div class="ttname"><a href="classAP__VideoTX.html#ae9729b3f3c48571bed0a31adc3d1d8a7">AP_VideoTX::set_power_is_current</a></div><div class="ttdeci">void set_power_is_current()</div><div class="ttdef"><b>Definition</b> <a href="#l00325">AP_VideoTX.cpp:325</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aeaae2fa97af3b59ee84a164bd63b2c21"><div class="ttname"><a href="classAP__VideoTX.html#aeaae2fa97af3b59ee84a164bd63b2c21">AP_VideoTX::set_freq_is_current</a></div><div class="ttdeci">void set_freq_is_current()</div><div class="ttdef"><b>Definition</b> <a href="#l00330">AP_VideoTX.cpp:330</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aeb76b7b55f0a335c6dc45b4df179b806"><div class="ttname"><a href="classAP__VideoTX.html#aeb76b7b55f0a335c6dc45b4df179b806">AP_VideoTX::update_configured_frequency</a></div><div class="ttdeci">void update_configured_frequency()</div><div class="ttdef"><b>Definition</b> <a href="#l00424">AP_VideoTX.cpp:424</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_aef3371cfedb9cd86cbd4bae1f6c42dce"><div class="ttname"><a href="classAP__VideoTX.html#aef3371cfedb9cd86cbd4bae1f6c42dce">AP_VideoTX::_channel</a></div><div class="ttdeci">AP_Int8 _channel</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00184">AP_VideoTX.h:184</a></div></div>
<div class="ttc" id="aclassAP__VideoTX_html_afa4cf772db054fd7a0d852b354a04e64"><div class="ttname"><a href="classAP__VideoTX.html#afa4cf772db054fd7a0d852b354a04e64">AP_VideoTX::update</a></div><div class="ttdeci">void update()</div><div class="ttdef"><b>Definition</b> <a href="#l00338">AP_VideoTX.cpp:338</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a52edeef7d5ffaa365e1229b87c170307"><div class="ttname"><a href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a></div><div class="ttdeci">void panic(const char *errormsg,...) FMT_PRINTF(1</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00327">system.cpp:327</a></div></div>
<div class="ttc" id="anamespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition</b> <a href="AC__Avoid_8cpp_source.html#l01481">AC_Avoid.cpp:1481</a></div></div>
<div class="ttc" id="anamespaceAP_html_addbcda2c64392bd274a855c3846a8e02"><div class="ttname"><a href="namespaceAP.html#addbcda2c64392bd274a855c3846a8e02">AP::vtx</a></div><div class="ttdeci">AP_VideoTX &amp; vtx()</div><div class="ttdef"><b>Definition</b> <a href="#l00550">AP_VideoTX.cpp:550</a></div></div>
<div class="ttc" id="astructAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00199">AP_Param.h:199</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html">AP_VideoTX::PowerLevel</a></div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00076">AP_VideoTX.h:76</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html_a51fa29ee6b23489d2508d5bd37a70bbb"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html#a51fa29ee6b23489d2508d5bd37a70bbb">AP_VideoTX::PowerLevel::level</a></div><div class="ttdeci">uint8_t level</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00077">AP_VideoTX.h:77</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html_a67c6211aefff76e5c7d67eb25416403d"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html#a67c6211aefff76e5c7d67eb25416403d">AP_VideoTX::PowerLevel::dbm</a></div><div class="ttdeci">uint8_t dbm</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00079">AP_VideoTX.h:79</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html_a857161594a2676459c368a261da29772"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html#a857161594a2676459c368a261da29772">AP_VideoTX::PowerLevel::mw</a></div><div class="ttdeci">uint16_t mw</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00078">AP_VideoTX.h:78</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html_aa6ecaa2f3f8c833ff25bdc70e8e75536"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html#aa6ecaa2f3f8c833ff25bdc70e8e75536">AP_VideoTX::PowerLevel::active</a></div><div class="ttdeci">PowerActive active</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00081">AP_VideoTX.h:81</a></div></div>
<div class="ttc" id="astructAP__VideoTX_1_1PowerLevel_html_aec82bb84bd916f5dccb371c1b6d0e614"><div class="ttname"><a href="structAP__VideoTX_1_1PowerLevel.html#aec82bb84bd916f5dccb371c1b6d0e614">AP_VideoTX::PowerLevel::dac</a></div><div class="ttdeci">uint8_t dac</div><div class="ttdef"><b>Definition</b> <a href="AP__VideoTX_8h_source.html#l00080">AP_VideoTX.h:80</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 22 2024 16:14:15 for APM:Libraries by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
