<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AC_AutoTune/AC_AutoTune_Heli.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_e0c590d1e561ab822e9a3251e267ee24.html">AC_AutoTune</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AC_AutoTune_Heli.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="AC__AutoTune__Heli_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">   This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"></span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> */</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">/*</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">  support for autotune of helicopters. Based on original autotune code from ArduCopter, written by Leonard Hall</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">  Converted to a library by Andrew Tridgell, and rewritten to include helicopters by Bill Geyer</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> */</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="AC__AutoTune__config_8h.html">AC_AutoTune_config.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#if AC_AUTOTUNE_ENABLED</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="AC__AutoTune__Heli_8h.html">AC_AutoTune_Heli.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Logger_8h.html">AP_Logger/AP_Logger.h</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="GCS_8h.html">GCS_MAVLink/GCS.h</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#ad8003e1f859e9ed253661357dfcb5902">   29</a></span><span class="preprocessor">#define AUTOTUNE_TESTING_STEP_TIMEOUT_MS   5000U     </span><span class="comment">// timeout for tuning mode&#39;s testing step</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a3a163446aaa027a54e1907d5ca135e6a">   31</a></span><span class="preprocessor">#define AUTOTUNE_RD_STEP                  0.0005f     </span><span class="comment">// minimum increment when increasing/decreasing Rate D term</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#af8ebe9eeee9bd7c76ca9a1c23aff8799">   32</a></span><span class="preprocessor">#define AUTOTUNE_RP_STEP                  0.005f     </span><span class="comment">// minimum increment when increasing/decreasing Rate P term</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a4b955fa422db08fed83f6bba56318c1a">   33</a></span><span class="preprocessor">#define AUTOTUNE_SP_STEP                  0.05f     </span><span class="comment">// minimum increment when increasing/decreasing Stab P term</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a3d98ea203baafde6ade13041bd58a9f2">   34</a></span><span class="preprocessor">#define AUTOTUNE_PI_RATIO_FOR_TESTING      0.1f     </span><span class="comment">// I is set 10x smaller than P during testing</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a949858511c435b8b37033e872fb8b916">   35</a></span><span class="preprocessor">#define AUTOTUNE_PI_RATIO_FINAL            1.0f     </span><span class="comment">// I is set 1x P after testing</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">   36</a></span><span class="preprocessor">#define AUTOTUNE_YAW_PI_RATIO_FINAL        0.1f     </span><span class="comment">// I is set 1x P after testing</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a42e52a68df1c0540bdb883985177b6ab">   37</a></span><span class="preprocessor">#define AUTOTUNE_RD_MAX                  0.020f     </span><span class="comment">// maximum Rate D value</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a2d4c86ab0a84c81b0d4fee3d20e3a9bc">   38</a></span><span class="preprocessor">#define AUTOTUNE_RP_MIN                   0.02f     </span><span class="comment">// minimum Rate P value</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a8a024030a7c5194b96fe9db6439505b0">   39</a></span><span class="preprocessor">#define AUTOTUNE_RP_MAX                   0.3f     </span><span class="comment">// maximum Rate P value</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#ab945759a3a4243849d884df545dc4619">   40</a></span><span class="preprocessor">#define AUTOTUNE_SP_MAX                    10.0f     </span><span class="comment">// maximum Stab P value</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">   41</a></span><span class="preprocessor">#define AUTOTUNE_SP_MIN                    3.0f     </span><span class="comment">// maximum Stab P value</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">   42</a></span><span class="preprocessor">#define AUTOTUNE_RFF_MAX                   0.5f     </span><span class="comment">// maximum Stab P value</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">   43</a></span><span class="preprocessor">#define AUTOTUNE_RFF_MIN                   0.025f    </span><span class="comment">// maximum Stab P value</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a1aaab6d17517f6f667ee54a8dcceec99">   44</a></span><span class="preprocessor">#define AUTOTUNE_RD_BACKOFF                1.0f     </span><span class="comment">// Rate D gains are reduced to 50% of their maximum value discovered during tuning</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#aaabbaebe134f2a50b24aa7548fb527a5">   45</a></span><span class="preprocessor">#define AUTOTUNE_RP_BACKOFF                1.0f     </span><span class="comment">// Rate P gains are reduced to 97.5% of their maximum value discovered during tuning</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#aa4559356c8b3ab98ca85717d99af17e8">   46</a></span><span class="preprocessor">#define AUTOTUNE_SP_BACKOFF                1.0f     </span><span class="comment">// Stab P gains are reduced to 90% of their maximum value discovered during tuning</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#adf5a63fef87226655c4ff680601598e3">   47</a></span><span class="preprocessor">#define AUTOTUNE_ACCEL_RP_BACKOFF          1.0f     </span><span class="comment">// back off from maximum acceleration</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a86c947b2cfe53f7748c081c1189efb55">   48</a></span><span class="preprocessor">#define AUTOTUNE_ACCEL_Y_BACKOFF           1.0f     </span><span class="comment">// back off from maximum acceleration</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a6d2f73bed50ddfb5decefc2d19457012">   50</a></span><span class="preprocessor">#define AUTOTUNE_HELI_TARGET_ANGLE_RLLPIT_CD     1500   </span><span class="comment">// target roll/pitch angle during AUTOTUNE FeedForward rate test</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a0916971038b21abfd6eebaed66232059">   51</a></span><span class="preprocessor">#define AUTOTUNE_HELI_TARGET_RATE_RLLPIT_CDS     5000   </span><span class="comment">// target roll/pitch rate during AUTOTUNE FeedForward rate test</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a1dd8193779c326451b93b0cd5595005c">   52</a></span><span class="preprocessor">#define AUTOTUNE_FFI_RATIO_FOR_TESTING     0.5f     </span><span class="comment">// I is set 2x smaller than VFF during testing</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">   53</a></span><span class="preprocessor">#define AUTOTUNE_FFI_RATIO_FINAL           0.5f     </span><span class="comment">// I is set 0.5x VFF after testing</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a6781a25a0f825a9a6d405f197e2635b6">   54</a></span><span class="preprocessor">#define AUTOTUNE_RP_ACCEL_MIN           20000.0f     </span><span class="comment">// Minimum acceleration for Roll and Pitch</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#ad4a7b3ad167fb9dafd2f4b72f96260dc">   55</a></span><span class="preprocessor">#define AUTOTUNE_Y_ACCEL_MIN            10000.0f     </span><span class="comment">// Minimum acceleration for Yaw</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a86fcbf3bcd56e624aea8afdd26e37316">   57</a></span><span class="preprocessor">#define AUTOTUNE_SEQ_BITMASK_VFF             1</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a96cc84e40aa26f7865d22dad94920164">   58</a></span><span class="preprocessor">#define AUTOTUNE_SEQ_BITMASK_RATE_D          2</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a9e10028cbcb7cd80dff633a2841b24f8">   59</a></span><span class="preprocessor">#define AUTOTUNE_SEQ_BITMASK_ANGLE_P         4</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a3fa2dfb42f3e3b9ac3e53ef88344e5c7">   60</a></span><span class="preprocessor">#define AUTOTUNE_SEQ_BITMASK_MAX_GAIN        8</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno"><a class="line" href="AC__AutoTune__Heli_8cpp.html#a8c07b408f9ca6abe62ea89a871332321">   61</a></span><span class="preprocessor">#define AUTOTUNE_SEQ_BITMASK_TUNE_CHECK      16</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">const</span> <a class="code hl_struct" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a65df61266b1e07bfcee687db07fbbf92">AC_AutoTune_Heli::var_info</a>[] = {</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">// @Param: AXES</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">// @DisplayName: Autotune axis bitmask</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">// @Description: 1-byte bitmap of axes to autotune</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="comment">// @Bitmask: 0:Roll,1:Pitch,2:Yaw</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;AXES&quot;</span>, 1, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, axis_bitmask,  1),</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="comment">// @Param: SEQ</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// @DisplayName: AutoTune Sequence Bitmask</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="comment">// @Description: 2-byte bitmask to select what tuning should be performed.  Max gain automatically performed if Rate D is selected. Values: 7:All,1:VFF Only,2:Rate D/Rate P Only(incl max gain),4:Angle P Only,8:Max Gain Only,16:Tune Check,3:VFF and Rate D/Rate P(incl max gain),5:VFF and Angle P,6:Rate D/Rate P(incl max gain) and angle P</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">// @Bitmask: 0:VFF,1:Rate D/Rate P(incl max gain),2:Angle P,3:Max Gain Only,4:Tune Check</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;SEQ&quot;</span>, 2, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, seq_bitmask,  3),</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="comment">// @Param: FRQ_MIN</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="comment">// @DisplayName: AutoTune minimum sweep frequency</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="comment">// @Description: Defines the start frequency for sweeps and dwells</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">// @Range: 10 30</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;FRQ_MIN&quot;</span>, 3, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, min_sweep_freq,  10.0f),</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="comment">// @Param: FRQ_MAX</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="comment">// @DisplayName: AutoTune maximum sweep frequency</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="comment">// @Description: Defines the end frequency for sweeps and dwells</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="comment">// @Range: 50 120</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;FRQ_MAX&quot;</span>, 4, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, max_sweep_freq,  70.0f),</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="comment">// @Param: GN_MAX</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="comment">// @DisplayName: AutoTune maximum response gain</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="comment">// @Description: Defines the response gain (output/input) to tune</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// @Range: 1 2.5</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GN_MAX&quot;</span>, 5, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, max_resp_gain,  1.0f),</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="comment">// @Param: VELXY_P</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="comment">// @DisplayName: AutoTune velocity xy P gain</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="comment">// @Description: Velocity xy P gain used to hold position during Max Gain, Rate P, and Rate D frequency sweeps</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="comment">// @Range: 0 1</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="comment">// @User: Standard</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;VELXY_P&quot;</span>, 6, <a class="code hl_class" href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a>, vel_hold_gain,  0.1f),</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <a class="code hl_define" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>};</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment">// constructor</span></div>
<div class="foldopen" id="foldopen00111" data-start="{" data-end="}">
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a09f00689b08fa53dd8eab10d5ca7a4e9">  111</a></span><a class="code hl_function" href="classAC__AutoTune__Heli.html#a09f00689b08fa53dd8eab10d5ca7a4e9">AC_AutoTune_Heli::AC_AutoTune_Heli</a>()</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>{</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[0] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a">TUNE_COMPLETE</a>;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <a class="code hl_function" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, var_info);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>}</div>
</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">// initialize tests for each tune type</span></div>
<div class="foldopen" id="foldopen00118" data-start="{" data-end="}">
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#af6c010324c9ac265b7ab2728f03f954c">  118</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#af6c010324c9ac265b7ab2728f03f954c">AC_AutoTune_Heli::test_init</a>()</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>{</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>) {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">RFF_UP</a>:</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a3e1970bbf9d38685cd73fce245362812">rate_ff_test_init</a>();</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> = 10000;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>:</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>:</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>:</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>        <span class="comment">// initialize start frequency</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>) {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                <span class="comment">// continue using frequency where testing left off or RD_UP completed</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[12] &gt; 0.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[12] &lt; 180.0f) {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 12;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                <span class="comment">// start with freq found for sweep where phase was 180 deg</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 12;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.25f * 3.14159f * 2.0f;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                <span class="comment">// otherwise start at min freq to step up in dwell frequency until phase &gt; 160 deg</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 0;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            <span class="comment">// MAX_GAINS and RD_UP both start with a sweep initially but if it has been completed then start dwells at the freq for 180 deg phase</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 12;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.25f * 3.14159f * 2.0f;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>) {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>                        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0ff6782729ee915e99e2b3c3f3de258e">reset_maxgains_update_gain_variables</a>();</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                    }</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">max_sweep_freq</a>;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>            <span class="comment">// initialize determine_gain function whenever test is initialized</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">init</a>(<a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a10f69dacf1a3214bb2ad66eebda4458c">AC_AutoTune_FreqResp::InputType::SWEEP</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751a5305d515dc96c98fb352f7fb7264dd15">AC_AutoTune_FreqResp::ResponseType::RATE</a>);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">dwell_test_init</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            <span class="comment">// initialize determine_gain function whenever test is initialized</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">init</a>(<a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a245199b7189ce03119b6d1bde5921419">AC_AutoTune_FreqResp::InputType::DWELL</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751a5305d515dc96c98fb352f7fb7264dd15">AC_AutoTune_FreqResp::ResponseType::RATE</a>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">dwell_test_init</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        }</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            <span class="comment">// 4 seconds is added to allow aircraft to achieve start attitude.  Then the time to conduct the dwells is added to it.</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> = (uint32_t)(4000 + (<span class="keywordtype">float</span>)(<a class="code hl_define" href="AC__AutoTune__FreqResp_8h.html#a8566a41a5eba54860c1d1e69299481cf">AUTOTUNE_DWELL_CYCLES</a> + 2) * 1000.0f * <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a> / <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        }</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>:</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="comment">// initialize start frequency</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 12;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.25f * 3.14159f * 2.0f;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a> = 0.0f;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">max_sweep_freq</a>;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>            }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">bf_feedforward</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>            <span class="comment">// initialize determine gain function</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">init</a>(<a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a10f69dacf1a3214bb2ad66eebda4458c">AC_AutoTune_FreqResp::InputType::SWEEP</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751aedaeabcf681c6e1f4c5932e46825d3b1">AC_AutoTune_FreqResp::ResponseType::ANGLE</a>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">dwell_test_init</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            <span class="comment">// initialize determine gain function</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">init</a>(<a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a245199b7189ce03119b6d1bde5921419">AC_AutoTune_FreqResp::InputType::DWELL</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751aedaeabcf681c6e1f4c5932e46825d3b1">AC_AutoTune_FreqResp::ResponseType::ANGLE</a>);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">dwell_test_init</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="comment">// TODO add time limit for sweep test</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="comment">// 1 seconds is added for a little buffer.  Then the time to conduct the dwells is added to it.</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> = (uint32_t)(2000 + (<span class="keywordtype">float</span>)(<a class="code hl_define" href="AC__AutoTune__FreqResp_8h.html#a8566a41a5eba54860c1d1e69299481cf">AUTOTUNE_DWELL_CYCLES</a> + 7) * 1000.0f * <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a> / <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>:</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <span class="comment">// initialize start frequency</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">max_sweep_freq</a>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        <span class="comment">// initialize determine gain function</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">init</a>(<a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a10f69dacf1a3214bb2ad66eebda4458c">AC_AutoTune_FreqResp::InputType::SWEEP</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751aedaeabcf681c6e1f4c5932e46825d3b1">AC_AutoTune_FreqResp::ResponseType::ANGLE</a>);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">dwell_test_init</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8afb37a88b8565cb3555252f256a16767f">ANGLE</a>);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        <span class="comment">// TODO add time limit for sweep test</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)) {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="comment">// 1 seconds is added for a little buffer.  Then the time to conduct the dwells is added to it.</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> = (uint32_t)(2000 + (<span class="keywordtype">float</span>)(<a class="code hl_define" href="AC__AutoTune__FreqResp_8h.html#a8566a41a5eba54860c1d1e69299481cf">AUTOTUNE_DWELL_CYCLES</a> + 7) * 1000.0f * <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a> / <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    }</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a> = <a class="code hl_typedef" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>(<a class="code hl_variable" href="classAC__AutoTune.html#abd3d037cb7c3b1886b6be864678babb8">roll_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#abe7597ab34dde279a85791ad4bddd1d8">pitch_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0b236d7e42ff3ebf413e4d8246e567c9">desired_yaw_cd</a>);  <span class="comment">// heli specific</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>}</div>
</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="comment">// run tests for each tune type</span></div>
<div class="foldopen" id="foldopen00234" data-start="{" data-end="}">
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a581fd3200d08720e87bb6fb6fe7ee301">  234</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a581fd3200d08720e87bb6fb6fe7ee301">AC_AutoTune_Heli::test_run</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis, <span class="keyword">const</span> <span class="keywordtype">float</span> dir_sign)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>{</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="comment">// if tune complete or beyond frequency range or no max allowed gains then exit testing</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a">TUNE_COMPLETE</a> ||</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>       ((<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>) &amp;&amp; (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> &lt;= 0.0f || <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> &lt;= 0.0f)) ||</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>       ((<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>) &amp;&amp; <a class="code hl_function" href="classAC__AutoTune__Heli.html#a7e9b39f876c3352326e32ad7cbf39063">exceeded_freq_range</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>))){</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <a class="code hl_function" href="classAC__AutoTune.html#ad4ad5bae7bd4f3f9aa7bd89fe131cd16">load_gains</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a05b6bacf7ac1ce165661fcb83139fa23a5fed84a5d9b3c0b9430f821ca2b886e9">GAIN_ORIGINAL</a>);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a4e87dfa269d0c59e5ac25045476263bf">use_sqrt_controller</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <a class="code hl_function" href="classAC__AutoTune.html#aa7f1eda48ae6e8ce3b894c384e2e7f3a">get_poshold_attitude</a>(<a class="code hl_variable" href="classAC__AutoTune.html#abd3d037cb7c3b1886b6be864678babb8">roll_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#abe7597ab34dde279a85791ad4bddd1d8">pitch_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0b236d7e42ff3ebf413e4d8246e567c9">desired_yaw_cd</a>);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="comment">// hold level attitude</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aa111691a6822ceea4c70c434ee6d38e7">input_euler_angle_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune.html#abd3d037cb7c3b1886b6be864678babb8">roll_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#abe7597ab34dde279a85791ad4bddd1d8">pitch_cd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0b236d7e42ff3ebf413e4d8246e567c9">desired_yaw_cd</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>) &amp;&amp; (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> &lt;= 0.0f || <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> &lt;= 0.0f)) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Max Gain Determination Failed&quot;</span>);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a24dd9bb4e4da8006c603f1a3971e0b97">mode</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#a0b9e432c872de3ed7930a57e78a102c7a3358e7c4bed15fda66b05d88d0eb0fde">FAILED</a>;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981afd96b5c7a2b26dbcfd668d72018cf2fd">LogEvent::AUTOTUNE_FAILED</a>);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            <a class="code hl_function" href="classAC__AutoTune.html#a8f41a74af8681d65f681864ba4cc4ac8">update_gcs</a>(<a class="code hl_define" href="AC__AutoTune_8h.html#a09957b77f03c6f541b8c6e1d281d3e91">AUTOTUNE_MESSAGE_FAILED</a>);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>) &amp;&amp; <a class="code hl_function" href="classAC__AutoTune__Heli.html#a7e9b39f876c3352326e32ad7cbf39063">exceeded_freq_range</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>)){</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Exceeded frequency range&quot;</span>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a24dd9bb4e4da8006c603f1a3971e0b97">mode</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#a0b9e432c872de3ed7930a57e78a102c7a3358e7c4bed15fda66b05d88d0eb0fde">FAILED</a>;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981afd96b5c7a2b26dbcfd668d72018cf2fd">LogEvent::AUTOTUNE_FAILED</a>);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            <a class="code hl_function" href="classAC__AutoTune.html#a8f41a74af8681d65f681864ba4cc4ac8">update_gcs</a>(<a class="code hl_define" href="AC__AutoTune_8h.html#a09957b77f03c6f541b8c6e1d281d3e91">AUTOTUNE_MESSAGE_FAILED</a>);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a">TUNE_COMPLETE</a>) {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>) {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">RFF_UP</a>:</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae4f0684ddb2081516f8bd34aea2f742f">rate_ff_test_run</a>(<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a6d2f73bed50ddfb5decefc2d19457012">AUTOTUNE_HELI_TARGET_ANGLE_RLLPIT_CD</a>, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a0916971038b21abfd6eebaed66232059">AUTOTUNE_HELI_TARGET_RATE_RLLPIT_CDS</a>, dir_sign);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>:</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>:</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">dwell_test_run</a>(1, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>:</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">dwell_test_run</a>(0, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>:</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">dwell_test_run</a>(1, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>:</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">dwell_test_run</a>(1, <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8afb37a88b8565cb3555252f256a16767f">ANGLE</a>);</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>}</div>
</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">// heli specific gcs announcements</span></div>
<div class="foldopen" id="foldopen00291" data-start="{" data-end="}">
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a9c2606fa93c53ecb89b4aa4c26c8545a">  291</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9c2606fa93c53ecb89b4aa4c26c8545a">AC_AutoTune_Heli::do_gcs_announcements</a>()</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>{</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    <span class="keyword">const</span> uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="keywordflow">if</span> (now - <a class="code hl_variable" href="classAC__AutoTune.html#a44a0645b7d5372007007ff044d8dcaaf">announce_time</a> &lt; <a class="code hl_define" href="AC__AutoTune_8h.html#a48bfe2b4b02644d586535150fb8f2d3d">AUTOTUNE_ANNOUNCE_INTERVAL_MS</a>) {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: %s %s&quot;</span>, <a class="code hl_function" href="classAC__AutoTune.html#ab408486b00a60d5a6e6b952287c14a29">axis_string</a>(), <a class="code hl_function" href="classAC__AutoTune.html#a3ce7b2e92e303a0836101699344c9e54">type_string</a>());</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <a class="code hl_function" href="classAC__AutoTune.html#aa1a6681ba5d15288419f8bc76b5874b3">send_step_string</a>();</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>) {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>:</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>:</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>:</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>:</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>:</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Dwell&quot;</span>);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Sweep&quot;</span>);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>                <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: freq=%f gain=%f phase=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a>));</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            }</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a44a0645b7d5372007007ff044d8dcaaf">announce_time</a> = now;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>}</div>
</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">// send post test updates to user</span></div>
<div class="foldopen" id="foldopen00323" data-start="{" data-end="}">
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a24c218fc3981df6c9ec22d67ad8af044">  323</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a24c218fc3981df6c9ec22d67ad8af044">AC_AutoTune_Heli::do_post_test_gcs_announcements</a>() {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="keywordtype">float</span> tune_rp = 0.0f;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="keywordtype">float</span> tune_rd = 0.0f;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordtype">float</span> tune_rff = 0.0f;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordtype">float</span> tune_sp = 0.0f;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordtype">float</span> tune_accel = 0.0f;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        tune_rp = <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        tune_rd = <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        tune_rff = <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        tune_sp = <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        tune_accel = <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        tune_rp = <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        tune_rd = <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        tune_rff = <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        tune_sp = <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        tune_accel = <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a>;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        tune_rp = <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        tune_rd = <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        tune_rff = <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        tune_sp = <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        tune_accel = <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>) {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">RFF_UP</a>:</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: target=%f rotation=%f command=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a>*57.3f), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a>*57.3f), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a>));</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>            <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: ff=%f&quot;</span>, (<span class="keywordtype">double</span>)tune_rff);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>:</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>:</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>:</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>:</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                <span class="comment">// announce results of dwell</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>                <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: freq=%f gain=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>]), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>]));</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>                <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: ph=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>]));</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>) {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                   <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: rate_p=%f&quot;</span>, (<span class="keywordtype">double</span>)(tune_rp));</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>               <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: rate_d=%f&quot;</span>, (<span class="keywordtype">double</span>)(tune_rd));</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>) {</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>                   <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: angle_p=%f tune_accel=%f max_accel=%f&quot;</span>, (<span class="keywordtype">double</span>)(tune_sp), (<span class="keywordtype">double</span>)(tune_accel), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a>));</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>               }</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: max_freq=%f max_gain=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a>));</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: ph180_freq=%f ph180_gain=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a>));</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>            }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>}</div>
</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="comment">// backup_gains_and_initialise - store current gains as originals</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="comment">//  called before tuning starts to backup original gains</span></div>
<div class="foldopen" id="foldopen00389" data-start="{" data-end="}">
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#afec312e9f685069bdc8742105dfcdf5a">  389</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#afec312e9f685069bdc8742105dfcdf5a">AC_AutoTune_Heli::backup_gains_and_initialise</a>()</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>{</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <a class="code hl_function" href="classAC__AutoTune.html#a056a45355b20fe8d605dc38f5c1e1d4b">AC_AutoTune::backup_gains_and_initialise</a>();</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <span class="comment">// initializes dwell test sequence for rate_p_up and rate_d_up tests for tradheli</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 0;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = 0.0f;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a2a000632a2a1b3b3fee03efc3ac21295">orig_bf_feedforward</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a4b0e45d449268c319b63534dccebe134">get_bf_feedforward</a>();</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="comment">// backup original pids and initialise tuned pid values</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a9680b00ac8177acf9dbe677112e7579d">orig_roll_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a2dee86f41193c3d5d90d5e8b1d86386a">orig_roll_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a02f30299e7d8f62e0637e37b8cb70eaf">orig_roll_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">orig_roll_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>();</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">orig_roll_smax</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>();</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a3b6d61487f2dbf5ba77189d4a662748d">orig_roll_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">get_angle_roll_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ac18f6f470a433dda4a961094aaf4c41f">orig_roll_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aed596797461545fe38edc44669ae60e8">get_accel_roll_max_cdss</a>();</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">get_angle_roll_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aed596797461545fe38edc44669ae60e8">get_accel_roll_max_cdss</a>();</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ad48110a5e9d484f0e88385a037e1bdf6">orig_pitch_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a0c544a4d38385a925779dd72c5a646f0">orig_pitch_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ae0dfe44d3697ccbfc5e64c2e2032e040">orig_pitch_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">orig_pitch_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>();</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">orig_pitch_smax</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>();</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0">orig_pitch_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">get_angle_pitch_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a8bb0aa278e42e63304e1118c3b57d086">orig_pitch_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af4caeece5ed0e6d1038ecfacb0043fd3">get_accel_pitch_max_cdss</a>();</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">get_angle_pitch_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af4caeece5ed0e6d1038ecfacb0043fd3">get_accel_pitch_max_cdss</a>();</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">orig_yaw_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a1e387aaf6c97daf0dde4c2fdead2eb76">orig_yaw_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aa8e14ea72d0fbf721a21654a83e9599f">orig_yaw_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a00b3258a64dd355dc9fe45580ca1d390">orig_yaw_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>();</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">orig_yaw_smax</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>();</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">orig_yaw_rLPF</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#aac6ff2f362aa6ab5c41343019342dc6f">filt_E_hz</a>();</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a4b8f0d6e5605047cf71fc2babdfdaf33">orig_yaw_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae4cea1c7fcffb5a7dbdf2508fea73380">get_accel_yaw_max_cdss</a>();</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <a class="code hl_variable" href="classAC__AutoTune.html#adc211cea45fcba3d85cb88bfac224d25">orig_yaw_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">get_angle_yaw_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a57bdd4161989d4e5f64dc86e7f850936">tune_yaw_rLPF</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#aac6ff2f362aa6ab5c41343019342dc6f">filt_E_hz</a>();</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">get_angle_yaw_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae4cea1c7fcffb5a7dbdf2508fea73380">get_accel_yaw_max_cdss</a>();</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981a42946be177aeab3531580f3ca2434c71">LogEvent::AUTOTUNE_INITIALISED</a>);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>}</div>
</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="comment">// load_orig_gains - set gains to their original values</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">//  called by stop and failed functions</span></div>
<div class="foldopen" id="foldopen00450" data-start="{" data-end="}">
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ad84003c3e324eb94e02b478b0c26c931">  450</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad84003c3e324eb94e02b478b0c26c931">AC_AutoTune_Heli::load_orig_gains</a>()</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>{</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">bf_feedforward</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a2a000632a2a1b3b3fee03efc3ac21295">orig_bf_feedforward</a>);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#a08cf46046687e39c100b975d07025938">roll_enabled</a>()) {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9680b00ac8177acf9dbe677112e7579d">orig_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a2dee86f41193c3d5d90d5e8b1d86386a">orig_roll_ri</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a02f30299e7d8f62e0637e37b8cb70eaf">orig_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">orig_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a3b6d61487f2dbf5ba77189d4a662748d">orig_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ac18f6f470a433dda4a961094aaf4c41f">orig_roll_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">orig_roll_smax</a>);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#aeceafc59aecb2c0e50765b136c3c2fd9">pitch_enabled</a>()) {</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ad48110a5e9d484f0e88385a037e1bdf6">orig_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0c544a4d38385a925779dd72c5a646f0">orig_pitch_ri</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae0dfe44d3697ccbfc5e64c2e2032e040">orig_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">orig_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0">orig_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8bb0aa278e42e63304e1118c3b57d086">orig_pitch_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">orig_pitch_smax</a>);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    }</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#ab718371cbc44318f02d751a77fc80f94">yaw_enabled</a>()) {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">orig_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1e387aaf6c97daf0dde4c2fdead2eb76">orig_yaw_ri</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aa8e14ea72d0fbf721a21654a83e9599f">orig_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a00b3258a64dd355dc9fe45580ca1d390">orig_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#adc211cea45fcba3d85cb88bfac224d25">orig_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a4b8f0d6e5605047cf71fc2babdfdaf33">orig_yaw_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">orig_yaw_rLPF</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">orig_yaw_smax</a>);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    }</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>}</div>
</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">// load_tuned_gains - load tuned gains</span></div>
<div class="foldopen" id="foldopen00465" data-start="{" data-end="}">
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a9c135efcd591da91b69b32cbdc37ed00">  465</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9c135efcd591da91b69b32cbdc37ed00">AC_AutoTune_Heli::load_tuned_gains</a>()</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>{</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a4b0e45d449268c319b63534dccebe134">get_bf_feedforward</a>()) {</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">bf_feedforward</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a9d7ac4baee54cfede81b09ab06fc8060">set_accel_roll_max_cdss</a>(0.0f);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ad48f67abaf5974e51aa783f4e80fd10c">set_accel_pitch_max_cdss</a>(0.0f);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    }</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#a08cf46046687e39c100b975d07025938">roll_enabled</a>()) {</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">orig_roll_smax</a>);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    }</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#aeceafc59aecb2c0e50765b136c3c2fd9">pitch_enabled</a>()) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">orig_pitch_smax</a>);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#ab718371cbc44318f02d751a77fc80f94">yaw_enabled</a>()) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>)) {</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">AUTOTUNE_YAW_PI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a57bdd4161989d4e5f64dc86e7f850936">tune_yaw_rLPF</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">orig_yaw_smax</a>);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        }</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>}</div>
</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">// load_intra_test_gains - gains used between tests</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="comment">//  called during testing mode&#39;s update-gains step to set gains ahead of return-to-level step</span></div>
<div class="foldopen" id="foldopen00487" data-start="{" data-end="}">
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a44b3391933543eacfcdad7abcf922157">  487</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a44b3391933543eacfcdad7abcf922157">AC_AutoTune_Heli::load_intra_test_gains</a>()</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>{</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="comment">// we are restarting tuning so reset gains to tuning-start gains (i.e. low I term)</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="comment">// sanity check the gains</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">bf_feedforward</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#a08cf46046687e39c100b975d07025938">roll_enabled</a>()) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9680b00ac8177acf9dbe677112e7579d">orig_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">orig_roll_rff</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a1dd8193779c326451b93b0cd5595005c">AUTOTUNE_FFI_RATIO_FOR_TESTING</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a02f30299e7d8f62e0637e37b8cb70eaf">orig_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">orig_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a3b6d61487f2dbf5ba77189d4a662748d">orig_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ac18f6f470a433dda4a961094aaf4c41f">orig_roll_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">orig_roll_smax</a>);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#aeceafc59aecb2c0e50765b136c3c2fd9">pitch_enabled</a>()) {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ad48110a5e9d484f0e88385a037e1bdf6">orig_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">orig_pitch_rff</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a1dd8193779c326451b93b0cd5595005c">AUTOTUNE_FFI_RATIO_FOR_TESTING</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae0dfe44d3697ccbfc5e64c2e2032e040">orig_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">orig_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0">orig_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8bb0aa278e42e63304e1118c3b57d086">orig_pitch_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">orig_pitch_smax</a>);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAC__AutoTune.html#ab718371cbc44318f02d751a77fc80f94">yaw_enabled</a>()) {</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">orig_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">orig_yaw_rp</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3d98ea203baafde6ade13041bd58a9f2">AUTOTUNE_PI_RATIO_FOR_TESTING</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aa8e14ea72d0fbf721a21654a83e9599f">orig_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a00b3258a64dd355dc9fe45580ca1d390">orig_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#adc211cea45fcba3d85cb88bfac224d25">orig_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a4b8f0d6e5605047cf71fc2babdfdaf33">orig_yaw_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">orig_yaw_rLPF</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">orig_yaw_smax</a>);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    }</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>}</div>
</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">// load_test_gains - load the to-be-tested gains for a single axis</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">// called by control_attitude() just before it beings testing a gain (i.e. just before it twitches)</span></div>
<div class="foldopen" id="foldopen00505" data-start="{" data-end="}">
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#afc7e02c4e2098f2452baa507b780e71f">  505</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#afc7e02c4e2098f2452baa507b780e71f">AC_AutoTune_Heli::load_test_gains</a>()</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>{</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="keywordtype">float</span> rate_p, rate_i, rate_d;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>            rate_i = <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            <span class="comment">// freeze integrator to hold trim by making i term small during rate controller tuning</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            rate_i = 0.01f * <a class="code hl_variable" href="classAC__AutoTune.html#a2dee86f41193c3d5d90d5e8b1d86386a">orig_roll_ri</a>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        }</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>)) {</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            rate_p = 0.0f;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>            rate_d = 0.0f;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            rate_p = <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            rate_d = <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>        }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>, rate_p, rate_i, rate_d, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a>, 0.0f, 0.0f);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            rate_i = <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            <span class="comment">// freeze integrator to hold trim by making i term small during rate controller tuning</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>            rate_i = 0.01f * <a class="code hl_variable" href="classAC__AutoTune.html#a0c544a4d38385a925779dd72c5a646f0">orig_pitch_ri</a>;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        }</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>)) {</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            rate_p = 0.0f;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            rate_d = 0.0f;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            rate_p = <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            rate_d = <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>, rate_p, rate_i, rate_d, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a>, 0.0f, 0.0f);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a> || <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>) {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            rate_i = <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">AUTOTUNE_YAW_PI_RATIO_FINAL</a>;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>            <span class="comment">// freeze integrator to hold trim by making i term small during rate controller tuning</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>            rate_i = 0.01f * <a class="code hl_variable" href="classAC__AutoTune.html#a1e387aaf6c97daf0dde4c2fdead2eb76">orig_yaw_ri</a>;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        }</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, rate_i, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a57bdd4161989d4e5f64dc86e7f850936">tune_yaw_rLPF</a>, 0.0f);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    }</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>}</div>
</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span><span class="comment">// load gains</span></div>
<div class="foldopen" id="foldopen00555" data-start="{" data-end="}">
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">  555</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">AC_AutoTune_Heli::load_gain_set</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> s_axis, <span class="keywordtype">float</span> rate_p, <span class="keywordtype">float</span> rate_i, <span class="keywordtype">float</span> rate_d, <span class="keywordtype">float</span> rate_ff, <span class="keywordtype">float</span> angle_p, <span class="keywordtype">float</span> max_accel, <span class="keywordtype">float</span> rate_fltt, <span class="keywordtype">float</span> rate_flte, <span class="keywordtype">float</span> smax)</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>{</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keywordflow">switch</span> (s_axis) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>(rate_p);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>(rate_i);</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>(rate_d);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>(rate_ff);</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>(rate_fltt);</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>(smax);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">get_angle_roll_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>(angle_p);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a9d7ac4baee54cfede81b09ab06fc8060">set_accel_roll_max_cdss</a>(max_accel);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>(rate_p);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>(rate_i);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>(rate_d);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>(rate_ff);</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>(rate_fltt);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>(smax);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">get_angle_pitch_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>(angle_p);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ad48f67abaf5974e51aa783f4e80fd10c">set_accel_pitch_max_cdss</a>(max_accel);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>(rate_p);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>(rate_i);</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>(rate_d);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>(rate_ff);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">filt_T_hz</a>(rate_fltt);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">slew_limit</a>(smax);</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#aac6ff2f362aa6ab5c41343019342dc6f">filt_E_hz</a>(rate_flte);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">get_angle_yaw_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>(angle_p);</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ab62747dc70b886a2e3affdee4e8bda09">set_accel_yaw_max_cdss</a>(max_accel);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>}</div>
</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">// save_tuning_gains - save the final tuned gains for each axis</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="comment">// save discovered gains to eeprom if autotuner is enabled (i.e. switch is in the high position)</span></div>
<div class="foldopen" id="foldopen00595" data-start="{" data-end="}">
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a9a8d1a1fc00366d6964f01951767accd">  595</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9a8d1a1fc00366d6964f01951767accd">AC_AutoTune_Heli::save_tuning_gains</a>()</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>{</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <span class="comment">// see if we successfully completed tuning of at least one axis</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a994866d5a325bd2d2774c08e4d060347">axes_completed</a> == 0) {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a4b0e45d449268c319b63534dccebe134">get_bf_feedforward</a>()) {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a1da892418310d6779dad6a65f66203cc">bf_feedforward_save</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a767288d62f3dfb4c384c8b380b734856">save_accel_roll_max_cdss</a>(0.0f);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aad7a6a93245781a107fec17a850f6902">save_accel_pitch_max_cdss</a>(0.0f);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="comment">// sanity check the rate P values</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAC__AutoTune.html#a994866d5a325bd2d2774c08e4d060347">axes_completed</a> &amp; <a class="code hl_define" href="AC__AutoTune_8h.html#a5497ff920ceb814093df36b2b5fad79e">AUTOTUNE_AXIS_BITMASK_ROLL</a>) &amp;&amp; <a class="code hl_function" href="classAC__AutoTune.html#a08cf46046687e39c100b975d07025938">roll_enabled</a>()) {</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">orig_roll_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">orig_roll_smax</a>);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        <span class="comment">// save rate roll gains</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ac0065460e0b0ed3600b60494f6c2a44b">save_gains</a>();</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        <span class="comment">// save stabilize roll</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">get_angle_roll_p</a>().<a class="code hl_function" href="classAC__P.html#ac4b7fac705bba7deb0a0640cc9182003">save_gains</a>();</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>        <span class="comment">// resave pids to originals in case the autotune is run again</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a9680b00ac8177acf9dbe677112e7579d">orig_roll_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a2dee86f41193c3d5d90d5e8b1d86386a">orig_roll_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a02f30299e7d8f62e0637e37b8cb70eaf">orig_roll_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">orig_roll_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3b6d61487f2dbf5ba77189d4a662748d">orig_roll_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">get_angle_roll_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac18f6f470a433dda4a961094aaf4c41f">orig_roll_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aed596797461545fe38edc44669ae60e8">get_accel_roll_max_cdss</a>();</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    }</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAC__AutoTune.html#a994866d5a325bd2d2774c08e4d060347">axes_completed</a> &amp; <a class="code hl_define" href="AC__AutoTune_8h.html#aabe00050c468b57664c128474d55278f">AUTOTUNE_AXIS_BITMASK_PITCH</a>) &amp;&amp; <a class="code hl_function" href="classAC__AutoTune.html#aeceafc59aecb2c0e50765b136c3c2fd9">pitch_enabled</a>()) {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">orig_pitch_fltt</a>, 0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">orig_pitch_smax</a>);</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        <span class="comment">// save rate pitch gains</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ac0065460e0b0ed3600b60494f6c2a44b">save_gains</a>();</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        <span class="comment">// save stabilize pitch</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">get_angle_pitch_p</a>().<a class="code hl_function" href="classAC__P.html#ac4b7fac705bba7deb0a0640cc9182003">save_gains</a>();</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        <span class="comment">// resave pids to originals in case the autotune is run again</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ad48110a5e9d484f0e88385a037e1bdf6">orig_pitch_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a0c544a4d38385a925779dd72c5a646f0">orig_pitch_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ae0dfe44d3697ccbfc5e64c2e2032e040">orig_pitch_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">orig_pitch_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0">orig_pitch_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">get_angle_pitch_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8bb0aa278e42e63304e1118c3b57d086">orig_pitch_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af4caeece5ed0e6d1038ecfacb0043fd3">get_accel_pitch_max_cdss</a>();</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAC__AutoTune.html#a994866d5a325bd2d2774c08e4d060347">axes_completed</a> &amp; <a class="code hl_define" href="AC__AutoTune_8h.html#aebd28483149e9ca433dbb79f254bdf58">AUTOTUNE_AXIS_BITMASK_YAW</a>) &amp;&amp; <a class="code hl_function" href="classAC__AutoTune.html#ab718371cbc44318f02d751a77fc80f94">yaw_enabled</a>() &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>)) {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">load_gain_set</a>(<a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">AUTOTUNE_YAW_PI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">orig_yaw_fltt</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">orig_yaw_rLPF</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">orig_yaw_smax</a>);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>        <span class="comment">// save rate yaw gains</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ac0065460e0b0ed3600b60494f6c2a44b">save_gains</a>();</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span> </div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        <span class="comment">// save stabilize yaw</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">get_angle_yaw_p</a>().<a class="code hl_function" href="classAC__P.html#ac4b7fac705bba7deb0a0640cc9182003">save_gains</a>();</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        <span class="comment">// resave pids to originals in case the autotune is run again</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">orig_yaw_rp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>();</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a1e387aaf6c97daf0dde4c2fdead2eb76">orig_yaw_ri</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">kI</a>();</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        <a class="code hl_variable" href="classAC__AutoTune.html#aa8e14ea72d0fbf721a21654a83e9599f">orig_yaw_rd</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">kD</a>();</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a00b3258a64dd355dc9fe45580ca1d390">orig_yaw_rff</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>();</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">orig_yaw_rLPF</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#aac6ff2f362aa6ab5c41343019342dc6f">filt_E_hz</a>();</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        <a class="code hl_variable" href="classAC__AutoTune.html#adc211cea45fcba3d85cb88bfac224d25">orig_yaw_sp</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">get_angle_yaw_p</a>().<a class="code hl_function" href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">kP</a>();</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a4b8f0d6e5605047cf71fc2babdfdaf33">orig_yaw_accel</a> = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae4cea1c7fcffb5a7dbdf2508fea73380">get_accel_yaw_max_cdss</a>();</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    }</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    <span class="comment">// update GCS and log save gains event</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    <a class="code hl_function" href="classAC__AutoTune.html#a8f41a74af8681d65f681864ba4cc4ac8">update_gcs</a>(<a class="code hl_define" href="AC__AutoTune_8h.html#af31f96eca02ad4daf09274cb61472d7a">AUTOTUNE_MESSAGE_SAVED_GAINS</a>);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ab5b53ea9f4907f052c78719268b5120a">LogEvent::AUTOTUNE_SAVEDGAINS</a>);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    <a class="code hl_function" href="classAC__AutoTune.html#a1c95bf9bc9e06ae04c56f5e6953a0758">reset</a>();</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>}</div>
</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="comment">// report final gains for a given axis to GCS</span></div>
<div class="foldopen" id="foldopen00669" data-start="{" data-end="}">
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a896f9586792bdc0e368a2168e5b5b30a">  669</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a896f9586792bdc0e368a2168e5b5b30a">AC_AutoTune_Heli::report_final_gains</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)<span class="keyword"> const</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">report_axis_gains</a>(<span class="stringliteral">&quot;Roll&quot;</span>, <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">tune_roll_accel</a>);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">report_axis_gains</a>(<span class="stringliteral">&quot;Pitch&quot;</span>, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">tune_pitch_accel</a>);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">report_axis_gains</a>(<span class="stringliteral">&quot;Yaw&quot;</span>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>*<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">AUTOTUNE_YAW_PI_RATIO_FINAL</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">tune_yaw_accel</a>);</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>}</div>
</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">// report gain formatting helper</span></div>
<div class="foldopen" id="foldopen00686" data-start="{" data-end="}">
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">  686</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">AC_AutoTune_Heli::report_axis_gains</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* axis_string, <span class="keywordtype">float</span> rate_P, <span class="keywordtype">float</span> rate_I, <span class="keywordtype">float</span> rate_D, <span class="keywordtype">float</span> rate_ff, <span class="keywordtype">float</span> angle_P, <span class="keywordtype">float</span> max_accel)<span class="keyword"> const</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_NOTICE,<span class="stringliteral">&quot;AutoTune: %s complete&quot;</span>, <a class="code hl_function" href="classAC__AutoTune.html#ab408486b00a60d5a6e6b952287c14a29">axis_string</a>);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>    <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_NOTICE,<span class="stringliteral">&quot;AutoTune: %s Rate: P:%0.4f, I:%0.4f, D:%0.5f, FF:%0.4f&quot;</span>,<a class="code hl_function" href="classAC__AutoTune.html#ab408486b00a60d5a6e6b952287c14a29">axis_string</a>,rate_P,rate_I,rate_D,rate_ff);</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_NOTICE,<span class="stringliteral">&quot;AutoTune: %s Angle P:%0.2f, Max Accel:%0.0f&quot;</span>,<a class="code hl_function" href="classAC__AutoTune.html#ab408486b00a60d5a6e6b952287c14a29">axis_string</a>,angle_P,max_accel);</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>}</div>
</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="foldopen" id="foldopen00694" data-start="{" data-end="}">
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a3e1970bbf9d38685cd73fce245362812">  694</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a3e1970bbf9d38685cd73fce245362812">AC_AutoTune_Heli::rate_ff_test_init</a>()</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>{</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 0;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(5.0f);</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(5.0f);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(5.0f);</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a> = 0.0f;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a> = 0.0f;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a> = 0.0f;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a> = 0.0f;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> = 200;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3ba294c5dd5856c7802f2546541ebda1">phase_out_time</a> = 500;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(1.0f);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(1.0f);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>}</div>
</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="foldopen" id="foldopen00715" data-start="{" data-end="}">
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ae4f0684ddb2081516f8bd34aea2f742f">  715</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae4f0684ddb2081516f8bd34aea2f742f">AC_AutoTune_Heli::rate_ff_test_run</a>(<span class="keywordtype">float</span> max_angle_cd, <span class="keywordtype">float</span> target_rate_cds, <span class="keywordtype">float</span> dir_sign)</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>{</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <span class="keywordtype">float</span> gyro_reading = 0.0f;</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    <span class="keywordtype">float</span> command_reading =0.0f;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <span class="keywordtype">float</span> tgt_rate_reading = 0.0f;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="keyword">const</span> uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    target_rate_cds = dir_sign * target_rate_cds;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9d6fff42778f7a4337b549c76cedfd75">get_roll</a>();</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> &gt; 0) {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a>--;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aca584a7982e7bbf4c2eedf99f8157def">trim_command_reading</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9d6fff42778f7a4337b549c76cedfd75">get_roll</a>();</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(gyro_reading);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f, 0.0f);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &gt; max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &lt; -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 1;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f, 0.0f);</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a3b474a8d875b7fbdba044567f08ac972">rate_bf_roll_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f, 0.0f);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a3b474a8d875b7fbdba044567f08ac972">rate_bf_roll_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &lt; -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &gt; max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 2;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae352616dda789b6496b714a993564637">reset_target_and_rate</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a>);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, 0.0f);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 2 ) {</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, 0.0f);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3ba294c5dd5856c7802f2546541ebda1">phase_out_time</a>--;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        }</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>        command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a761e52f1a7a67a6d22cb581d6c08de08">get_pitch</a>();</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> &gt; 0) {</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a>--;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aca584a7982e7bbf4c2eedf99f8157def">trim_command_reading</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a761e52f1a7a67a6d22cb581d6c08de08">get_pitch</a>();</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(gyro_reading);</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &gt; max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &lt; -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 1;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a0b0a032fc5cf7e19a570e680df54a6d8">rate_bf_pitch_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f);</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a0b0a032fc5cf7e19a570e680df54a6d8">rate_bf_pitch_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &lt; -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>                   || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &gt; max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 2;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae352616dda789b6496b714a993564637">reset_target_and_rate</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a>);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f);</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 2 ) {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), 0.0f);</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3ba294c5dd5856c7802f2546541ebda1">phase_out_time</a>--;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        }</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>        gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>        command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9386115b33c9fdb54505d66439963ab4">get_yaw</a>();</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>        tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> &gt; 0) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a>--;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aca584a7982e7bbf4c2eedf99f8157def">trim_command_reading</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9386115b33c9fdb54505d66439963ab4">get_yaw</a>();</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a>;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(gyro_reading);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &lt;= 2.0f * max_angle_cd &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>                   || (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &gt;= -2.0f * max_angle_cd &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &gt; 2.0f * max_angle_cd &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>                   || (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &lt; -2.0f * max_angle_cd &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 0) {</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 1;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#abd68c885291f6295086d634f69c013b0">rate_bf_yaw_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &gt;= -2.0f * max_angle_cd &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>                   || (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &lt;= 2.0f * max_angle_cd &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(-target_rate_cds, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#abd68c885291f6295086d634f69c013b0">rate_bf_yaw_target</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">rate_request_cds</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>());</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &lt; -2.0f * max_angle_cd &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>                   || (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &gt; 2.0f * max_angle_cd &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>                   &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> = 2;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a4aae58ad7f851d2cf936d68809eaeba8">reset_yaw_target_and_rate</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>));</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aa111691a6822ceea4c70c434ee6d38e7">input_euler_angle_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 2 ) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(0.0f, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aa111691a6822ceea4c70c434ee6d38e7">input_euler_angle_roll_pitch_yaw</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">start_angles</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code hl_function" href="AP__Math_8cpp.html#af836ccbc389735a6f129d85126eab30a">wrap_360_cd</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">angle_request_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>()), <span class="keyword">false</span>);</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        }</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    }</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(gyro_reading,</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>                    <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>((command_reading - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aca584a7982e7bbf4c2eedf99f8157def">trim_command_reading</a>),</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>                                     <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(tgt_rate_reading,</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                       <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span> </div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <span class="comment">// record steady state rate and motor command</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>            || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>            &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>;</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        }</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &gt;= -max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            || (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> &lt;= max_angle_cd + <a class="code hl_variable" href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">start_angle</a> &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>        }</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>        <span class="keywordflow">if</span> (((<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &gt;= -2.0f * max_angle_cd &amp;&amp; <a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign))</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>            || (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">trim_heading</a>) &lt;= 2.0f * max_angle_cd &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(dir_sign)))</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>            &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 1 ) {</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        }</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    }</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    <span class="keywordflow">if</span> (now - <a class="code hl_variable" href="classAC__AutoTune.html#a87c7c8399fd1458fb91cfea8a92b00a6">step_start_time_ms</a> &gt;= <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> || (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">ff_test_phase</a> == 2 &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a3ba294c5dd5856c7802f2546541ebda1">phase_out_time</a> == 0)) {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <span class="comment">// we have passed the maximum stop time</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        <a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>}</div>
</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="foldopen" id="foldopen00890" data-start="{" data-end="}">
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">  890</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">AC_AutoTune_Heli::dwell_test_init</a>(<span class="keywordtype">float</span> start_frq, <span class="keywordtype">float</span> stop_frq, <span class="keywordtype">float</span> filt_freq, <a class="code hl_enumeration" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8">DwellType</a> dwell_type)</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>{</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a> = 0.0f;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> = 200;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span> </div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(filt_freq);</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(filt_freq);</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(filt_freq);</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0);</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a> = 0.0f;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a> = 0.0f;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a> = 0.0f;</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    <span class="comment">// filter at lower frequency to remove steady state</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a166399159373f7f885562efc88d89bbf">filt_command_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aa68cfb13c1b93811e6e59119fded6c90">filt_gyro_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a03d240cbe0c90b562b1a2ae0f87a1c83">filt_tgt_rate_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span> </div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>) {</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">filt_pit_roll_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aea94968e29187b913750b53fc4d0383d">filt_heading_error_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">set_cutoff_frequency</a>(0.2f * start_frq);</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="comment">// save the trim output from PID controller</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordtype">float</span> ff_term = 0.0f;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="keywordtype">float</span> p_term = 0.0f;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>            ff_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad78d03d125980bae0d247e9db48b7460">get_ff</a>();</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            p_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a79324d6af91b6fbe7d4203585d254bf3">get_p</a>();</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>            ff_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad78d03d125980bae0d247e9db48b7460">get_ff</a>();</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            p_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a79324d6af91b6fbe7d4203585d254bf3">get_p</a>();</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            ff_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#ad78d03d125980bae0d247e9db48b7460">get_ff</a>();</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            p_term = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a79324d6af91b6fbe7d4203585d254bf3">get_p</a>();</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aed31e91d609992a7bc57c7deafe38586">trim_pff_out</a> = ff_term + p_term;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>    }</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(start_frq, stop_frq)) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">reset_sweep_variables</a>();</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a> = 0.0f;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> = 0.0f;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    }</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span> </div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a760cc913abd3315fbd4fc42bee107c56">chirp_input</a>.<a class="code hl_function" href="classChirp.html#af3fe76d250680ab3c5c89fdc604e2f16">init</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4833595f5105f24a4c59a969bc34f39b">sweep_time_ms</a> * 0.001f, start_frq / <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>, stop_frq / <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>, 0.0f, 0.0001f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4833595f5105f24a4c59a969bc34f39b">sweep_time_ms</a>, 0.0f);</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>}</div>
</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="foldopen" id="foldopen00950" data-start="{" data-end="}">
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">  950</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">AC_AutoTune_Heli::dwell_test_run</a>(uint8_t freq_resp_input, <span class="keywordtype">float</span> start_frq, <span class="keywordtype">float</span> stop_frq, <span class="keywordtype">float</span> &amp;dwell_gain, <span class="keywordtype">float</span> &amp;dwell_phase, <a class="code hl_enumeration" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8">DwellType</a> dwell_type)</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>{</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordtype">float</span> gyro_reading = 0.0f;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    <span class="keywordtype">float</span> command_reading = 0.0f;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>    <span class="keywordtype">float</span> tgt_rate_reading = 0.0f;</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keywordtype">float</span> tgt_attitude;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>    <span class="keyword">const</span> uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>    <span class="keywordtype">float</span> target_angle_cd = 0.0f;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    <span class="keywordtype">float</span> target_rate_cds = 0.0f;</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    <span class="keywordtype">float</span> dwell_freq = start_frq;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <span class="keywordtype">float</span> target_rate_mag_cds;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> att_hold_gain = 4.5f;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <span class="keywordtype">float</span> cycle_time_ms = 0;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(dwell_freq)) {</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        cycle_time_ms = 1000.0f * <a class="code hl_define" href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a> / dwell_freq;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    }</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span> </div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>) {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <span class="comment">// keep controller from requesting too high of a rate</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        tgt_attitude = 2.5f * 0.01745f;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        target_rate_mag_cds = dwell_freq * tgt_attitude * 5730.0f;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <span class="keywordflow">if</span> (target_rate_mag_cds &gt; 5000.0f) {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            target_rate_mag_cds = 5000.0f;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>        }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        tgt_attitude = 5.0f * 0.01745f;</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        <span class="comment">// adjust target attitude based on input_tc so amplitude decrease with increased frequency is minimized</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> freq_co = 1.0f / <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a72c6b498bd3873052810de9a218913a6">get_input_tc</a>();</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> added_ampl = (<a class="code hl_function" href="AP__Math_8cpp.html#ac89eb1832d8e4d67fcf1ac07e3c25184">safe_sqrt</a>(powf(dwell_freq,2.0) + powf(freq_co,2.0)) / freq_co) - 1.0f;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        tgt_attitude = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(0.08725f * (1.0f + 0.2f * added_ampl), 0.08725f, 0.5235f);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    }</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    <span class="comment">// body frame calculation of velocity</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    <a class="code hl_class" href="classVector3.html">Vector3f</a> velocity_ned, velocity_bf;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a71fba0fa37fe88f841b8f76379974809">get_velocity_NED</a>(velocity_ned)) {</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        velocity_bf.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> = velocity_ned.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a3f98bb641a87a41f52f532747ca7c9b5">cos_yaw</a>() + velocity_ned.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5cba0e970b7df616645025113e75ee41">sin_yaw</a>();</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>        velocity_bf.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> = -velocity_ned.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5cba0e970b7df616645025113e75ee41">sin_yaw</a>() + velocity_ned.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a3f98bb641a87a41f52f532747ca7c9b5">cos_yaw</a>();</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    }</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <a class="code hl_class" href="classVector3.html">Vector3f</a> attitude_cd = <a class="code hl_typedef" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>((<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a>, (<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a>, (<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a>);</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>) {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>            target_rate_cds = -<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a760cc913abd3315fbd4fc42bee107c56">chirp_input</a>.<a class="code hl_function" href="classChirp.html#a51eaed939817e2783633ba83a194a422">update</a>((now - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a>) * 0.001, target_rate_mag_cds);</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">filt_pit_roll_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(<a class="code hl_typedef" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(attitude_cd.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>,attitude_cd.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>), <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aea94968e29187b913750b53fc4d0383d">filt_heading_error_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af6c811e7b1020a14e2d21cff2ed1f327">trim_attitude_cd</a>.<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> - attitude_cd.<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>), <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>            target_angle_cd = -<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a760cc913abd3315fbd4fc42bee107c56">chirp_input</a>.<a class="code hl_function" href="classChirp.html#a51eaed939817e2783633ba83a194a422">update</a>((now - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a>) * 0.001, tgt_attitude * 5730.0f);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        }</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <span class="keyword">const</span> <a class="code hl_class" href="structVector2.html">Vector2f</a> att_fdbk {</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            -5730.0f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aeca6f1a1af2da29008c56faddd9d647a">vel_hold_gain</a> * velocity_bf.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>,</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            5730.0f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aeca6f1a1af2da29008c56faddd9d647a">vel_hold_gain</a> * velocity_bf.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>        };</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(att_fdbk, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().get_loop_period_s());</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>        dwell_freq = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a760cc913abd3315fbd4fc42bee107c56">chirp_input</a>.<a class="code hl_function" href="classChirp.html#a02930ebd08b6a1563f337708cc2107cd">get_frequency_rads</a>();</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>        <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>) {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>            target_rate_cds = 0.0f;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a0fb2e627a1c2c4f470b6b95289fe2d2a">trim_command</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af6c811e7b1020a14e2d21cff2ed1f327">trim_attitude_cd</a> = attitude_cd;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">filt_pit_roll_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(<a class="code hl_typedef" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(attitude_cd.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>,attitude_cd.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>));</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aea94968e29187b913750b53fc4d0383d">filt_heading_error_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(0.0f);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>            target_angle_cd = 0.0f;</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad6258ef563283b567ef4fe11fa4204e2">trim_yaw_tgt_reading</a> = (float)<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae97a67a22eb0150b1fb097c58d36b961">get_att_target_euler_cd</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9e4829910362301dae7313389c2f8e40">trim_yaw_heading_reading</a> = (float)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>        }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a> = now;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(<a class="code hl_typedef" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(0.0f,0.0f));</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a>--;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    }</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">RATE</a>) {</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        <span class="comment">// limit rate correction for position hold</span></div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <a class="code hl_class" href="classVector3.html">Vector3f</a> trim_rate_cds {</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>            <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(att_hold_gain * ((<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af6c811e7b1020a14e2d21cff2ed1f327">trim_attitude_cd</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>) - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">filt_pit_roll_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>), -15000.0f, 15000.0f),</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>            <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(att_hold_gain * ((<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af6c811e7b1020a14e2d21cff2ed1f327">trim_attitude_cd</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>) - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">filt_pit_roll_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>), -15000.0f, 15000.0f),</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>            <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(att_hold_gain * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aea94968e29187b913750b53fc4d0383d">filt_heading_error_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>(), -15000.0f, 15000.0f)</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        };</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>            gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9d6fff42778f7a4337b549c76cedfd75">get_roll</a>();</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>            tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>                <span class="keywordtype">float</span> ff_rate_contr = 0.0f;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>                    ff_rate_contr = 5730.0f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a0fb2e627a1c2c4f470b6b95289fe2d2a">trim_command</a> / <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>                }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>                trim_rate_cds.x += ff_rate_contr;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, trim_rate_cds.y, 0.0f);</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a3b474a8d875b7fbdba044567f08ac972">rate_bf_roll_target</a>(target_rate_cds + trim_rate_cds.x);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, 0.0f);</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>())) {</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>                    <span class="keywordtype">float</span> trim_tgt_rate_cds = 5730.0f * (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aed31e91d609992a7bc57c7deafe38586">trim_pff_out</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> * <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>()) / (<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">get_rate_roll_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>());</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a3b474a8d875b7fbdba044567f08ac972">rate_bf_roll_target</a>(trim_tgt_rate_cds);</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>                }</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>            }</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>            gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a761e52f1a7a67a6d22cb581d6c08de08">get_pitch</a>();</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>            tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>                <span class="keywordtype">float</span> ff_rate_contr = 0.0f;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>                    ff_rate_contr = 5730.0f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a0fb2e627a1c2c4f470b6b95289fe2d2a">trim_command</a> / <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>;</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>                }</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>                trim_rate_cds.y += ff_rate_contr;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(trim_rate_cds.x, 0.0f, 0.0f);</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a0b0a032fc5cf7e19a570e680df54a6d8">rate_bf_pitch_target</a>(target_rate_cds + trim_rate_cds.y);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, 0.0f);</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>())) {</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                    <span class="keywordtype">float</span> trim_tgt_rate_cds = 5730.0f * (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aed31e91d609992a7bc57c7deafe38586">trim_pff_out</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> * <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>()) / (<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">get_rate_pitch_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>());</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a0b0a032fc5cf7e19a570e680df54a6d8">rate_bf_pitch_target</a>(trim_tgt_rate_cds);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>                }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>            }</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>            gyro_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_function" href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">get_gyro</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9386115b33c9fdb54505d66439963ab4">get_yaw</a>();</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>            tgt_rate_reading = <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">rate_bf_targets</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                <span class="keywordtype">float</span> rp_rate_contr = 0.0f;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>                    rp_rate_contr = 5730.0f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a0fb2e627a1c2c4f470b6b95289fe2d2a">trim_command</a> / <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>                }</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>                trim_rate_cds.z += rp_rate_contr;</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(trim_rate_cds.x, trim_rate_cds.y, 0.0f);</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#abd68c885291f6295086d634f69c013b0">rate_bf_yaw_target</a>(target_rate_cds + trim_rate_cds.z);</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>                <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">input_rate_bf_roll_pitch_yaw</a>(0.0f, 0.0f, 0.0f);</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>())) {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>                    <span class="keywordtype">float</span> trim_tgt_rate_cds = 5730.0f * (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aed31e91d609992a7bc57c7deafe38586">trim_pff_out</a> + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">trim_meas_rate</a> * <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>()) / (<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">ff</a>() + <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">get_rate_yaw_pid</a>().<a class="code hl_function" href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">kP</a>());</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#abd68c885291f6295086d634f69c013b0">rate_bf_yaw_target</a>(trim_tgt_rate_cds);</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                }</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>            }</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>        }</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>        <span class="keyword">const</span> <a class="code hl_class" href="structVector2.html">Vector2f</a> trim_angle_cd {</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>            <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>, -2000.0f, 2000.0f),</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>            <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">filt_att_fdbk_from_velxy_cd</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>().<a class="code hl_variable" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>, -2000.0f, 2000.0f)</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>        };</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(target_angle_cd + trim_angle_cd.x, trim_angle_cd.y, 0.0f);</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9d6fff42778f7a4337b549c76cedfd75">get_roll</a>();</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>            <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>) {</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>                tgt_rate_reading = (target_angle_cd) / 5730.0f;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>                gyro_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a> + trim_angle_cd.x - target_angle_cd) / 5730.0f;</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>                tgt_rate_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae97a67a22eb0150b1fb097c58d36b961">get_att_target_euler_cd</a>().<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>) / 5730.0f;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>                gyro_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">roll_sensor</a>) / 5730.0f;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>            }</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">input_euler_angle_roll_pitch_euler_rate_yaw</a>(trim_angle_cd.x, target_angle_cd + trim_angle_cd.y, 0.0f);</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a761e52f1a7a67a6d22cb581d6c08de08">get_pitch</a>();</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>            <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>) {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>                tgt_rate_reading = (target_angle_cd) / 5730.0f;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>                gyro_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a> + trim_angle_cd.y - target_angle_cd) / 5730.0f;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>                tgt_rate_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae97a67a22eb0150b1fb097c58d36b961">get_att_target_euler_cd</a>().<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>) / 5730.0f;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                gyro_reading = ((float)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">pitch_sensor</a>) / 5730.0f;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>            }</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>            command_reading = <a class="code hl_variable" href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">motors</a>-&gt;<a class="code hl_function" href="classAP__Motors.html#a9386115b33c9fdb54505d66439963ab4">get_yaw</a>();</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>            <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>) {</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                tgt_rate_reading = (target_angle_cd) / 5730.0f;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                gyro_reading = (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>((<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9e4829910362301dae7313389c2f8e40">trim_yaw_heading_reading</a> - target_angle_cd)) / 5730.0f;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>                tgt_rate_reading = (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>((<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ae97a67a22eb0150b1fb097c58d36b961">get_att_target_euler_cd</a>().<a class="code hl_variable" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad6258ef563283b567ef4fe11fa4204e2">trim_yaw_tgt_reading</a>)) / 5730.0f;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>                gyro_reading = (<a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>((<span class="keywordtype">float</span>)<a class="code hl_variable" href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">ahrs_view</a>-&gt;<a class="code hl_variable" href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">yaw_sensor</a> - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a9e4829910362301dae7313389c2f8e40">trim_yaw_heading_reading</a>)) / 5730.0f;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>            }</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#aa111691a6822ceea4c70c434ee6d38e7">input_euler_angle_roll_pitch_yaw</a>(trim_angle_cd.x, trim_angle_cd.y, <a class="code hl_function" href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad6258ef563283b567ef4fe11fa4204e2">trim_yaw_tgt_reading</a> + target_angle_cd), <span class="keyword">false</span>);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>        }</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    }</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0) {</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a166399159373f7f885562efc88d89bbf">filt_command_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(command_reading, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aa68cfb13c1b93811e6e59119fded6c90">filt_gyro_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(gyro_reading, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a03d240cbe0c90b562b1a2ae0f87a1c83">filt_tgt_rate_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>(tgt_rate_reading, <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a166399159373f7f885562efc88d89bbf">filt_command_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(command_reading);</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aa68cfb13c1b93811e6e59119fded6c90">filt_gyro_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(gyro_reading);</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a03d240cbe0c90b562b1a2ae0f87a1c83">filt_tgt_rate_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">reset</a>(tgt_rate_reading);</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>    }</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span> </div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    <span class="comment">// looks at gain and phase of input rate to output rate</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">rotation_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>((gyro_reading - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aa68cfb13c1b93811e6e59119fded6c90">filt_gyro_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>()),</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>                <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">target_rate_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>((tgt_rate_reading - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a03d240cbe0c90b562b1a2ae0f87a1c83">filt_tgt_rate_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>()),</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>                <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">command_filt</a>.<a class="code hl_function" href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">apply</a>((command_reading - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a166399159373f7f885562efc88d89bbf">filt_command_reading</a>.<a class="code hl_function" href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">get</a>()),</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>                <a class="code hl_function" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a>().<a class="code hl_function" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>());</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span> </div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <span class="comment">// wait for dwell to start before determining gain and phase</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    <span class="keywordflow">if</span> ((<span class="keywordtype">float</span>)(now - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a>) &gt; 6.25f * cycle_time_ms || (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(start_frq,stop_frq) &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">settle_time</a> == 0)) {</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>        <span class="keywordflow">if</span> (freq_resp_input == 1) {</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a68603a35134d6216679858e3a2c05748">update</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>,<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>,<a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>, dwell_freq);</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a68603a35134d6216679858e3a2c05748">update</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>,<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>,<a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>, dwell_freq);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        }</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span> </div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#ab8d1752a1b8b19898145dc3b68abf94c">is_cycle_complete</a>()) {</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(start_frq,stop_frq)) {</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#ac892e279bc5219214db8a3db7061a9e1">get_freq</a>();</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#afd5dde1c801ede267a682c1af0ab72e6">get_gain</a>();</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a665ca37dd506117c3d91c393f11faef5">get_phase</a>();</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>                <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>) {<a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a526c10cbf56910b8c0c7d9e06317d0ef">get_accel_max</a>();}</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>                <span class="comment">// reset cycle_complete to allow indication of next cycle</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a37b9c88a3f81ad7ab6ae5c399c50c40a">reset_cycle_complete</a>();</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>                <span class="comment">// log sweep data</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>                Log_AutoTuneSweep();</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>                dwell_gain = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#afd5dde1c801ede267a682c1af0ab72e6">get_gain</a>();</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>                dwell_phase = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a665ca37dd506117c3d91c393f11faef5">get_phase</a>();</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>                <span class="keywordflow">if</span> (dwell_type == <a class="code hl_enumvalue" href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">DRB</a>) {<a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#a526c10cbf56910b8c0c7d9e06317d0ef">get_accel_max</a>();}</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>            }</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>        }</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>    }</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span> </div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    <span class="comment">// set sweep data if a frequency sweep is being conducted</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(start_frq,stop_frq) &amp;&amp; (<span class="keywordtype">float</span>)(now - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">dwell_start_time_ms</a>) &gt; 2.5f * cycle_time_ms) {</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>        <span class="comment">// track sweep phase to prevent capturing 180 deg and 270 deg data after phase has wrapped.</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &gt; 180.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> == 0) {</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> = 1;</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &gt; 270.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> == 1) {</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> = 2;</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        }</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &lt;= 160.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &gt;= 150.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> == 0) {</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        }</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &lt;= 250.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a> &gt;= 240.0f &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> == 1) {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a531df29170bff692a4dbb2fffd1e72d2">ph270</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>;</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>        }</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a> &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a>) {</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>;</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        }</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="keywordflow">if</span> (now - <a class="code hl_variable" href="classAC__AutoTune.html#a87c7c8399fd1458fb91cfea8a92b00a6">step_start_time_ms</a> &gt;= <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4833595f5105f24a4c59a969bc34f39b">sweep_time_ms</a> + 200) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            <span class="comment">// we have passed the maximum stop time</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>        }</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        <span class="keywordflow">if</span> (now - <a class="code hl_variable" href="classAC__AutoTune.html#a87c7c8399fd1458fb91cfea8a92b00a6">step_start_time_ms</a> &gt;= <a class="code hl_variable" href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">step_time_limit_ms</a> || <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">freqresp</a>.<a class="code hl_function" href="classAC__AutoTune__FreqResp.html#ab8d1752a1b8b19898145dc3b68abf94c">is_cycle_complete</a>()) {</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>            <span class="comment">// we have passed the maximum stop time</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>            <a class="code hl_variable" href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">step</a> = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">UPDATE_GAINS</a>;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        }</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    }</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>}</div>
</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span> </div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span><span class="comment">// update gains for the rate p up tune type</span></div>
<div class="foldopen" id="foldopen01211" data-start="{" data-end="}">
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ac4e59ecc5bb7fd291df5b8482b50e790"> 1211</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ac4e59ecc5bb7fd291df5b8482b50e790">AC_AutoTune_Heli::updating_rate_p_up_all</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>{</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d">updating_rate_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>);</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d">updating_rate_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>);</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d">updating_rate_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>);</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    }</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>}</div>
</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span><span class="comment">// update gains for the rate d up tune type</span></div>
<div class="foldopen" id="foldopen01228" data-start="{" data-end="}">
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a67f9abab43ff7ebda72f334a46cc5ef9"> 1228</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a67f9abab43ff7ebda72f334a46cc5ef9">AC_AutoTune_Heli::updating_rate_d_up_all</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>{</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966">updating_rate_d_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>);</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966">updating_rate_d_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>);</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966">updating_rate_d_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>);</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    }</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>}</div>
</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span> </div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span><span class="comment">// update gains for the rate ff up tune type</span></div>
<div class="foldopen" id="foldopen01245" data-start="{" data-end="}">
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#aedbf8216f99bf2f47aa93726a4da1c7f"> 1245</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#aedbf8216f99bf2f47aa93726a4da1c7f">AC_AutoTune_Heli::updating_rate_ff_up_all</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>{</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921">updating_rate_ff_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a>);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921">updating_rate_ff_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a>);</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921">updating_rate_ff_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">test_tgt_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">test_rate_filt</a>*5730.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">test_command_filt</a>);</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>        <span class="comment">// TODO make FF updating routine determine when to set rff gain to zero based on A/C response</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a> &lt;= <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a> &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a> = 0.0f;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>        }</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    }</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>}</div>
</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="comment">// update gains for the angle p up tune type</span></div>
<div class="foldopen" id="foldopen01266" data-start="{" data-end="}">
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a13997db00069868aa0e409e7799b60e8"> 1266</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a13997db00069868aa0e409e7799b60e8">AC_AutoTune_Heli::updating_angle_p_up_all</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>{</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    <a class="code hl_variable" href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">attitude_control</a>-&gt;<a class="code hl_function" href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">bf_feedforward</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a2a000632a2a1b3b3fee03efc3ac21295">orig_bf_feedforward</a>);</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span> </div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385">updating_angle_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385">updating_angle_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>);</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385">updating_angle_p_up</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>);</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    }</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>}</div>
</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span><span class="comment">// update gains for the max gain tune type</span></div>
<div class="foldopen" id="foldopen01285" data-start="{" data-end="}">
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a03fd4c5ca9e069d3b32ea046ad146611"> 1285</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a03fd4c5ca9e069d3b32ea046ad146611">AC_AutoTune_Heli::updating_max_gains_all</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>{</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2">updating_max_gains</a>(&amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[0], <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>, <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>);</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2">updating_max_gains</a>(&amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[0], <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>);</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2">updating_max_gains</a>(&amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[0], &amp;<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[0], <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <span class="comment">// rate P and rate D can be non zero for yaw and need to be included in the max allowed gain</span></div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>) &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> += <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        }</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>) &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> += <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        }</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    }</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>}</div>
</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span> </div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span><span class="comment">// set gains post tune for the tune type</span></div>
<div class="foldopen" id="foldopen01309" data-start="{" data-end="}">
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a523d503e13a1e032d2bf063aef736093"> 1309</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a523d503e13a1e032d2bf063aef736093">AC_AutoTune_Heli::set_gains_post_tune</a>(<a class="code hl_enumeration" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AxisType</a> test_axis)</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>{</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>) {</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>:</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>        <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a1aaab6d17517f6f667ee54a8dcceec99">AUTOTUNE_RD_BACKOFF</a>);</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a1aaab6d17517f6f667ee54a8dcceec99">AUTOTUNE_RD_BACKOFF</a>);</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a1aaab6d17517f6f667ee54a8dcceec99">AUTOTUNE_RD_BACKOFF</a>);</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>        }</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>:</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>        <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>            <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aaabbaebe134f2a50b24aa7548fb527a5">AUTOTUNE_RP_BACKOFF</a>);</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>            <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.0f, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aaabbaebe134f2a50b24aa7548fb527a5">AUTOTUNE_RP_BACKOFF</a>);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a2d4c86ab0a84c81b0d4fee3d20e3a9bc">AUTOTUNE_RP_MIN</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aaabbaebe134f2a50b24aa7548fb527a5">AUTOTUNE_RP_BACKOFF</a>);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>        }</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>:</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>        <span class="keywordflow">switch</span> (test_axis) {</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aa4559356c8b3ab98ca85717d99af17e8">AUTOTUNE_SP_BACKOFF</a>);</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aa4559356c8b3ab98ca85717d99af17e8">AUTOTUNE_SP_BACKOFF</a>);</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a> = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a> * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#aa4559356c8b3ab98ca85717d99af17e8">AUTOTUNE_SP_BACKOFF</a>);</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>        }</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">RFF_UP</a>:</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>    }</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>}</div>
</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span> </div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span><span class="comment">// updating_rate_ff_up - adjust FF to ensure the target is reached</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span><span class="comment">// FF is adjusted until rate requested is achieved</span></div>
<div class="foldopen" id="foldopen01363" data-start="{" data-end="}">
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921"> 1363</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921">AC_AutoTune_Heli::updating_rate_ff_up</a>(<span class="keywordtype">float</span> &amp;tune_ff, <span class="keywordtype">float</span> rate_target, <span class="keywordtype">float</span> meas_rate, <span class="keywordtype">float</span> meas_command)</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>{</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a3ed419400f13c688e118de7bfce5f6b0">ff_up_first_iter</a>) {</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(meas_rate)) {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>            tune_ff = 5730.0f * meas_command / meas_rate;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>        }</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        tune_ff = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(tune_ff, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a>, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a>);</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ed419400f13c688e118de7bfce5f6b0">ff_up_first_iter</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(rate_target * meas_rate) &amp;&amp; fabsf(meas_rate) &lt; 1.05f * fabsf(rate_target) &amp;&amp;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>               fabsf(meas_rate) &gt; 0.95f * fabsf(rate_target)) {</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5f0e443c19b4a31608a0b14af12e7c1b">first_dir_complete</a>) {</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad1937bd0fefb79633ece02d9f227bbd8">first_dir_rff</a> = tune_ff;</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5f0e443c19b4a31608a0b14af12e7c1b">first_dir_complete</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a28831c9aa3aa548bf93880161ab390bc">positive_direction</a> = !<a class="code hl_variable" href="classAC__AutoTune.html#a28831c9aa3aa548bf93880161ab390bc">positive_direction</a>;</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>            tune_ff = 0.95f * 0.5 * (tune_ff + <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad1937bd0fefb79633ece02d9f227bbd8">first_dir_rff</a>);</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>            tune_ff = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(tune_ff, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a>, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a>);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>        }</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(rate_target * meas_rate) &amp;&amp; fabsf(meas_rate) &gt; 1.05f * fabsf(rate_target)) {</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>        tune_ff = 0.98f * tune_ff;</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>        <span class="keywordflow">if</span> (tune_ff &lt;= <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a>) {</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            tune_ff = <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a>;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>            <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28">LogEvent::AUTOTUNE_REACHED_LIMIT</a>);</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>        }</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(rate_target * meas_rate) &amp;&amp; fabsf(meas_rate) &lt; 0.95f * fabsf(rate_target)) {</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>        tune_ff = 1.02f * tune_ff;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>        <span class="keywordflow">if</span> (tune_ff &gt;= <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a>) {</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>            tune_ff = <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a>;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>            <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28">LogEvent::AUTOTUNE_REACHED_LIMIT</a>);</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>        }</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(meas_rate)) {</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>            tune_ff = 5730.0f * meas_command / meas_rate;</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>        }</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>        tune_ff = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(tune_ff, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a>, <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a>);</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>    }</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>}</div>
</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span> </div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span><span class="comment">// updating_rate_p_up - uses maximum allowable gain determined from max_gain test to determine rate p gain that does not exceed exceed max response gain</span></div>
<div class="foldopen" id="foldopen01406" data-start="{" data-end="}">
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d"> 1406</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d">AC_AutoTune_Heli::updating_rate_p_up</a>(<span class="keywordtype">float</span> &amp;tune_p, <span class="keywordtype">float</span> *freq, <span class="keywordtype">float</span> *gain, <span class="keywordtype">float</span> *phase, uint8_t &amp;frq_cnt, <a class="code hl_struct" href="structAC__AutoTune__Heli_1_1max__gain__data.html">max_gain_data</a> &amp;max_gain_p)</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>{</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>    <span class="keywordtype">float</span> test_freq_incr = 0.25f * 3.14159f * 2.0f;</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span> </div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>    <span class="keywordflow">if</span> (frq_cnt &lt; 12 &amp;&amp; <a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>        <span class="keywordflow">if</span> (phase[frq_cnt] &lt;= 180.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a1ebf93793397d70df71b631f2aeb92a5">rp_prev_good_frq_cnt</a> = frq_cnt;</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt &gt; 1 &amp;&amp; phase[frq_cnt] &gt; phase[frq_cnt-1] + 360.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>            <span class="keywordflow">if</span> (phase[frq_cnt] - 360.0f &lt; 180.0f) {</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a1ebf93793397d70df71b631f2aeb92a5">rp_prev_good_frq_cnt</a> = frq_cnt;</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>            }</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt &gt; 1 &amp;&amp; phase[frq_cnt] &gt; 200.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>            frq_cnt = 11;</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>        }</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>        frq_cnt++;</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>        <span class="keywordflow">if</span> (frq_cnt == 12) {</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>            freq[frq_cnt] = freq[<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a1ebf93793397d70df71b631f2aeb92a5">rp_prev_good_frq_cnt</a>];</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>            freq[frq_cnt] = freq[frq_cnt-1] + test_freq_incr;</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>        }</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>        <span class="keywordflow">if</span> (phase[frq_cnt] &gt; 180.0f) {</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phase[frq_cnt] &lt; 160.0f) {</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> + 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phase[frq_cnt] &lt;= 180.0f &amp;&amp; phase[frq_cnt] &gt;= 160.0f) {</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>            <span class="keywordflow">if</span> (gain[frq_cnt] &lt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; tune_p &lt; 0.6f * max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>) {</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>                tune_p += 0.05f * max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>;</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>                <span class="comment">// reset curr_test.freq and frq_cnt for next test</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[0];</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>                frq_cnt = 0;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>                tune_p -= 0.05f * max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>                tune_p = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(tune_p,0.0f,0.6f * max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>);</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>            }</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        }</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>    }</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span> </div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;  <span class="comment">//initializes next test that uses dwell test</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>    }</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>}</div>
</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span> </div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span><span class="comment">// updating_rate_d_up - uses maximum allowable gain determined from max_gain test to determine rate d gain where the response gain is at a minimum</span></div>
<div class="foldopen" id="foldopen01458" data-start="{" data-end="}">
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966"> 1458</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966">AC_AutoTune_Heli::updating_rate_d_up</a>(<span class="keywordtype">float</span> &amp;tune_d, <span class="keywordtype">float</span> *freq, <span class="keywordtype">float</span> *gain, <span class="keywordtype">float</span> *phase, uint8_t &amp;frq_cnt, <a class="code hl_struct" href="structAC__AutoTune__Heli_1_1max__gain__data.html">max_gain_data</a> &amp;max_gain_d)</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>{</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>    <span class="keywordtype">float</span> test_freq_incr = 0.25f * 3.14159f * 2.0f;  <span class="comment">// set for 1/4 hz increments</span></div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span> </div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <span class="comment">// frequency sweep was conducted.  check to see if freq for 180 deg phase was determined and start there if it was</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>            frq_cnt = 12;</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a> = frq_cnt;</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>            frq_cnt = 1;</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>        }</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>    }</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>    <span class="comment">// if sweep failed to find frequency for 180 phase then use dwell to find frequency</span></div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>    <span class="keywordflow">if</span> (frq_cnt &lt; 12 &amp;&amp; <a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>        <span class="keywordflow">if</span> (phase[frq_cnt] &lt;= 180.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a34179f328be78eefae7e4037ddf46947">rd_prev_good_frq_cnt</a> = frq_cnt;</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt &gt; 1 &amp;&amp; phase[frq_cnt] &gt; phase[frq_cnt-1] + 360.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>            <span class="keywordflow">if</span> (phase[frq_cnt] - 360.0f &lt; 180.0f) {</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a34179f328be78eefae7e4037ddf46947">rd_prev_good_frq_cnt</a> = frq_cnt;</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>            }</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt &gt; 1 &amp;&amp; phase[frq_cnt] &gt; 200.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) {</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>            frq_cnt = 11;</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>        }</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>        frq_cnt++;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>        <span class="keywordflow">if</span> (frq_cnt == 12) {</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>            freq[frq_cnt] = freq[<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a34179f328be78eefae7e4037ddf46947">rd_prev_good_frq_cnt</a>];</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>            freq[frq_cnt] = freq[frq_cnt-1] + test_freq_incr;</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>        }</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>        <span class="keywordflow">if</span> (phase[frq_cnt] &gt; 180.0f) {</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phase[frq_cnt] &lt; 160.0f) {</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> + 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phase[frq_cnt] &lt;= 180.0f &amp;&amp; phase[frq_cnt] &gt;= 160.0f) {</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>            <span class="keywordflow">if</span> ((gain[frq_cnt] &lt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">rd_prev_gain</a> || <a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">rd_prev_gain</a>)) &amp;&amp; tune_d &lt; 0.6f * max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>) {</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>                tune_d += 0.05f * max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>;</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">rd_prev_gain</a> = gain[frq_cnt];</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>                <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>                <span class="comment">// reset curr_test.freq and frq_cnt for next test</span></div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[0];</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>                frq_cnt = 0;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">rd_prev_gain</a> = 0.0f;</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>                tune_d -= 0.05f * max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>;</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>                tune_d = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(tune_d,0.0f,0.6f * max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>);</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>            }</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>        }</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>    }</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;  <span class="comment">//initializes next test that uses dwell test</span></div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">reset_sweep_variables</a>();</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>    }</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>}</div>
</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span> </div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span><span class="comment">// updating_angle_p_up - determines maximum angle p gain for pitch and roll</span></div>
<div class="foldopen" id="foldopen01525" data-start="{" data-end="}">
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385"> 1525</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385">AC_AutoTune_Heli::updating_angle_p_up</a>(<span class="keywordtype">float</span> &amp;tune_p, <span class="keywordtype">float</span> *freq, <span class="keywordtype">float</span> *gain, <span class="keywordtype">float</span> *phase, uint8_t &amp;frq_cnt)</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>{</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>    <span class="keywordtype">float</span> test_freq_incr = 0.5f * 3.14159f * 2.0f;</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>    <span class="keywordtype">float</span> gain_incr = 0.5f;</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span> </div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>            frq_cnt = 12;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a> = frq_cnt;</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>            frq_cnt = 1;</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a> = 0;</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>        }</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>    }</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> &lt; 12 &amp;&amp; <a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>        <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; tune_p &gt; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>) {</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>            <span class="comment">// exceeded max response gain already, reduce tuning gain to remain under max response gain</span></div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>            tune_p -= gain_incr;</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>            <span class="comment">// force counter to stay on frequency</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> -= 1;</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; tune_p &lt;= <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>) {</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>            <span class="comment">// exceeded max response gain at the minimum allowable tuning gain. terminate testing.</span></div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>            tune_p = <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a>;</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>            <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28">LogEvent::AUTOTUNE_REACHED_LIMIT</a>);</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; gain[<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a>]) {</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a> = <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>;</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab9a2e58f767ac0346fd3c7fcb6becdc6">phase_max</a> = phase[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a> = gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">max_sweep_freq</a> || (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; 0.0f &amp;&amp; gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &lt; 0.5f)) {</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>            <span class="comment">// must be past peak, continue on to determine angle p</span></div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 11;</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        }</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>++;</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> == 12) {</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>            freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = freq[<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a>];</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>            freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>-1] + test_freq_incr;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>        }</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>    }</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span> </div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>    <span class="comment">// once finished with sweep of frequencies, cnt = 12 is used to then tune for max response gain</span></div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> &gt;= 12 &amp;&amp; <a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>        <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &lt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; tune_p &lt; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ab945759a3a4243849d884df545dc4619">AUTOTUNE_SP_MAX</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a>) {</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>            <span class="comment">// keep increasing tuning gain unless phase changes or max response gain is achieved</span></div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>            <span class="keywordflow">if</span> (phase[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>]-<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab9a2e58f767ac0346fd3c7fcb6becdc6">phase_max</a> &gt; 20.0f &amp;&amp; phase[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &lt; 210.0f) {</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>                freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] += 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>                tune_p += gain_incr;</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>                freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] = freq[<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">freq_cnt_max</a>];</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>                <span class="keywordflow">if</span> (tune_p &gt;= <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ab945759a3a4243849d884df545dc4619">AUTOTUNE_SP_MAX</a>) {</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>                    tune_p = <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ab945759a3a4243849d884df545dc4619">AUTOTUNE_SP_MAX</a>;</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>                    <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>                    <a class="code hl_define" href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28">LogEvent::AUTOTUNE_REACHED_LIMIT</a>);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>                }</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>            }</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a> = gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; 1.1f * <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; tune_p &gt; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a>) {</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>            tune_p -= gain_incr;</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a>) {</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>            <span class="comment">// find the frequency where the response gain is maximum</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>            <span class="keywordflow">if</span> (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a>) {</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>                freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] += 0.5 * test_freq_incr;</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>                <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab9a2e58f767ac0346fd3c7fcb6becdc6">phase_max</a> = phase[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>            }</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a> = gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>];</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>            <span class="comment">// adjust tuning gain so max response gain is not exceeded</span></div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a> &lt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> &amp;&amp; gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a>) {</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>                <span class="keywordtype">float</span> adj_factor = (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">max_resp_gain</a> - gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>]) / (gain[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>] - <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a>);</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>                tune_p = tune_p + gain_incr * adj_factor; </div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>            }</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>        }</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>    }</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> == <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>) {</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;  <span class="comment">//initializes next test that uses dwell test</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>        <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">reset_sweep_variables</a>();</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[0];</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 0;</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>    }</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>}</div>
</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span> </div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span><span class="comment">// updating_max_gains: use dwells at increasing frequency to determine gain at which instability will occur</span></div>
<div class="foldopen" id="foldopen01622" data-start="{" data-end="}">
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2"> 1622</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2">AC_AutoTune_Heli::updating_max_gains</a>(<span class="keywordtype">float</span> *freq, <span class="keywordtype">float</span> *gain, <span class="keywordtype">float</span> *phase, uint8_t &amp;frq_cnt, <a class="code hl_struct" href="structAC__AutoTune__Heli_1_1max__gain__data.html">max_gain_data</a> &amp;max_gain_p, <a class="code hl_struct" href="structAC__AutoTune__Heli_1_1max__gain__data.html">max_gain_data</a> &amp;max_gain_d, <span class="keywordtype">float</span> &amp;tune_p, <span class="keywordtype">float</span> &amp;tune_d)</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>{</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>    <span class="keywordtype">float</span> test_freq_incr = 1.0f * <a class="code hl_define" href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * 2.0f;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span> </div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>        frq_cnt = 2;</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>            freq[frq_cnt] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">min_sweep_freq</a>;</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        }</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>        <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span> </div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt &lt; 12 &amp;&amp; <a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>,<a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        <span class="keywordflow">if</span> (frq_cnt &gt; 2 &amp;&amp; phase[frq_cnt] &gt; 161.0f &amp;&amp; phase[frq_cnt] &lt; 270.0f &amp;&amp;</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>            !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a>) {</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a>) {</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>            <span class="keywordflow">if</span> (phase[frq_cnt] &gt; 161.0f) {</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>                <span class="comment">// interpolate between frq_cnt-2 and frq_cnt</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>                max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(freq[frq_cnt-2],freq[frq_cnt],161.0f,phase[frq_cnt-2],phase[frq_cnt]);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>                max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(gain[frq_cnt-2],gain[frq_cnt],161.0f,phase[frq_cnt-2],phase[frq_cnt]);</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>                <span class="comment">// interpolate between frq_cnt-1 and frq_cnt</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>                max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(freq[frq_cnt],freq[frq_cnt-1],161.0f,phase[frq_cnt],phase[frq_cnt-1]);</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>                max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(gain[frq_cnt],gain[frq_cnt-1],161.0f,phase[frq_cnt],phase[frq_cnt-1]);</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>            }</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>            max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a8ba7d1071debf84aa62c22a2025b30d5">phase</a> = 161.0f;</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>            max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> = powf(10.0f,-1 * (log10f(max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a>) * 20.0f + 2.42) / 20.0f);</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>            <span class="comment">// limit max gain allowed to be no more than 2x the max p gain limit to keep initial gains bounded</span></div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>            max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(max_gain_p.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>, 0.0f, 2.0f * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a8a024030a7c5194b96fe9db6439505b0">AUTOTUNE_RP_MAX</a>);</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span> </div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a531df29170bff692a4dbb2fffd1e72d2">ph270</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>)) {</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>                <span class="comment">// set freq cnt back to reinitialize process</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>                frq_cnt = 1;  <span class="comment">// set to 1 because it will be incremented</span></div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>                <span class="comment">// set frequency back at least one test_freq_incr as it will be added</span></div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>                freq[1] = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a531df29170bff692a4dbb2fffd1e72d2">ph270</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> - 1.5f * test_freq_incr;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>            }</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        }</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>        <span class="keywordflow">if</span> (frq_cnt &gt; 2 &amp;&amp; phase[frq_cnt] &gt; 251.0f &amp;&amp; phase[frq_cnt] &lt; 360.0f &amp;&amp;</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>            !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a> &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a>) {</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a> &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a>) {</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>            <span class="keywordflow">if</span> (phase[frq_cnt] &gt; 251.0f) {</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>                <span class="comment">// interpolate between frq_cnt-2 and frq_cnt</span></div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>                max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(freq[frq_cnt-2],freq[frq_cnt],251.0f,phase[frq_cnt-2],phase[frq_cnt]);</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>                max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(gain[frq_cnt-2],gain[frq_cnt],251.0f,phase[frq_cnt-2],phase[frq_cnt]);</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>                <span class="comment">// interpolate between frq_cnt-1 and frq_cnt</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>                max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(freq[frq_cnt],freq[frq_cnt-1],251.0f,phase[frq_cnt],phase[frq_cnt-1]);</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>                max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a>(gain[frq_cnt],gain[frq_cnt-1],251.0f,phase[frq_cnt],phase[frq_cnt-1]);</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>            }</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>            max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a8ba7d1071debf84aa62c22a2025b30d5">phase</a> = 251.0f;</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>            max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> = powf(10.0f,-1 * (log10f(max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a> * max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a>) * 20.0f + 2.42) / 20.0f);</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>            <span class="comment">// limit max gain allowed to be no more than 2x the max d gain limit to keep initial gains bounded</span></div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>            max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a> = <a class="code hl_define" href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a>(max_gain_d.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>, 0.0f, 2.0f * <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a42e52a68df1c0540bdb883985177b6ab">AUTOTUNE_RD_MAX</a>);</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>        }</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>        <span class="comment">// stop progression in frequency.</span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>        <span class="keywordflow">if</span> ((frq_cnt &gt; 1 &amp;&amp; phase[frq_cnt] &gt; 330.0f &amp;&amp; !<a class="code hl_function" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(phase[frq_cnt])) || <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a>) {</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>            frq_cnt = 11;</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>        }</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>        frq_cnt++;</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>        <span class="keywordflow">if</span> (frq_cnt == 12) {</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">counter</a> = <a class="code hl_define" href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a>;</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>            <span class="comment">// reset variables for next test</span></div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[0];</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>            frq_cnt = 0;</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;  <span class="comment">//initializes next test that uses dwell test</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>            <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">reset_sweep_variables</a>();</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>            <span class="keywordflow">if</span> (frq_cnt == 3 &amp;&amp; phase[2] &gt;= 161.0f &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a>) {</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>                <span class="comment">// phase greater than 161 deg won&#39;t allow max p to be found</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>                <span class="comment">// reset freq cnt to 2 and lower dwell freq to push phase below 161 deg</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>                frq_cnt = 2;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>                freq[frq_cnt] = freq[frq_cnt] - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frq_cnt == 3 &amp;&amp; phase[2] &gt;= 251.0f &amp;&amp; !<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a>) {</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>                <span class="comment">// phase greater than 161 deg won&#39;t allow max p to be found</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>                <span class="comment">// reset freq cnt to 2 and lower dwell freq to push phase below 161 deg</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>                frq_cnt = 2;</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>                freq[frq_cnt] = freq[frq_cnt] - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a>) {</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>                freq[frq_cnt] = freq[frq_cnt-1] - 0.5f * test_freq_incr;</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>                freq[frq_cnt] = freq[frq_cnt-1] + test_freq_incr;</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>            }</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>            <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a> = freq[frq_cnt];</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>            <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>;</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>        }</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>    }</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a> &amp;&amp; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a>) {</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>        <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Max rate P freq=%f gain=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a>));</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>        <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: ph=%f rate_p=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a8ba7d1071debf84aa62c22a2025b30d5">phase</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>));</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>        <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: Max Rate D freq=%f gain=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">freq</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">gain</a>));</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>        <a class="code hl_function" href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a>().<a class="code hl_function" href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">send_text</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;AutoTune: ph=%f rate_d=%f&quot;</span>, (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#a8ba7d1071debf84aa62c22a2025b30d5">phase</a>), (<span class="keywordtype">double</span>)(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">max_allowed</a>));</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>    }</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span> </div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>}</div>
</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span> </div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span><span class="comment">// log autotune summary data</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_AutoTune()</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>{</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span> </div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>) {</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">ROLL</a>:</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>        Log_Write_AutoTune(<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">tune_roll_rff</a>,  <a class="code hl_variable" href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">tune_roll_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">tune_roll_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">tune_roll_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a>);</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">PITCH</a>:</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>        Log_Write_AutoTune(<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">tune_pitch_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">tune_pitch_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">tune_pitch_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">tune_pitch_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a>);</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">YAW</a>:</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">YAW_D</a>:</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>        Log_Write_AutoTune(<a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">test_freq</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">test_gain</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">test_phase</a>[<a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a>], <a class="code hl_variable" href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">tune_yaw_rff</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">tune_yaw_rp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">tune_yaw_rd</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">tune_yaw_sp</a>, <a class="code hl_variable" href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">test_accel_max</a>);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>    }</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>}</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span><span class="comment">// log autotune time history results for command, angular rate, and attitude</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_AutoTuneDetails()</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>{</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">tune_type</a> == <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>) {</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>        Log_Write_AutoTuneDetails(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>, 0.0f, 0.0f, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>);</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>        Log_Write_AutoTuneDetails(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">command_out</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">filt_target_rate</a>, <a class="code hl_variable" href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">rotation_rate</a>, 0.0f, 0.0f);</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>    }</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>}</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span> </div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span><span class="comment">// log autotune frequency response data</span></div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_AutoTuneSweep()</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>{</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>    Log_Write_AutoTuneSweep(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">freq</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">gain</a>, <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">curr_test</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">phase</a>);</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>}</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span> </div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span><span class="comment">// @LoggerMessage: ATNH</span></div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span><span class="comment">// @Description: Heli AutoTune</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span><span class="comment">// @Vehicles: Copter</span></div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span><span class="comment">// @Field: TimeUS: Time since system startup</span></div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span><span class="comment">// @Field: Axis: which axis is currently being tuned</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span><span class="comment">// @Field: TuneStep: step in autotune process</span></div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span><span class="comment">// @Field: Freq: target dwell frequency</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span><span class="comment">// @Field: Gain: measured gain of dwell</span></div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span><span class="comment">// @Field: Phase: measured phase of dwell</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span><span class="comment">// @Field: RFF: new rate gain FF term</span></div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span><span class="comment">// @Field: RP: new rate gain P term</span></div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span><span class="comment">// @Field: RD: new rate gain D term</span></div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span><span class="comment">// @Field: SP: new angle P term</span></div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span><span class="comment">// @Field: ACC: new max accel term</span></div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span> </div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span><span class="comment">// Write an Autotune summary data packet</span></div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_Write_AutoTune(uint8_t _axis, uint8_t tune_step, <span class="keywordtype">float</span> dwell_freq, <span class="keywordtype">float</span> meas_gain, <span class="keywordtype">float</span> meas_phase, <span class="keywordtype">float</span> new_gain_rff, <span class="keywordtype">float</span> new_gain_rp, <span class="keywordtype">float</span> new_gain_rd, <span class="keywordtype">float</span> new_gain_sp, <span class="keywordtype">float</span> max_accel)</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>{</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>    <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#a320182e24dfaf50d436cf065c97169bb">Write</a>(</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        <span class="stringliteral">&quot;ATNH&quot;</span>,</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>        <span class="stringliteral">&quot;TimeUS,Axis,TuneStep,Freq,Gain,Phase,RFF,RP,RD,SP,ACC&quot;</span>,</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>        <span class="stringliteral">&quot;s--E-d-----&quot;</span>,</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>        <span class="stringliteral">&quot;F--000-----&quot;</span>,</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>        <span class="stringliteral">&quot;QBBffffffff&quot;</span>,</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>(),</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">axis</a>,</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>        tune_step,</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>        dwell_freq,</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        meas_gain,</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>        meas_phase,</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>        new_gain_rff,</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>        new_gain_rp,</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>        new_gain_rd,</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>        new_gain_sp,</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>        max_accel);</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>}</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span> </div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span><span class="comment">// Write an Autotune detailed data packet</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_Write_AutoTuneDetails(<span class="keywordtype">float</span> motor_cmd, <span class="keywordtype">float</span> tgt_rate_rads, <span class="keywordtype">float</span> rate_rads, <span class="keywordtype">float</span> tgt_ang_rad, <span class="keywordtype">float</span> ang_rad)</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>{</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <span class="comment">// @LoggerMessage: ATDH</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>    <span class="comment">// @Description: Heli AutoTune data packet</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>    <span class="comment">// @Vehicles: Copter</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>    <span class="comment">// @Field: TimeUS: Time since system startup</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>    <span class="comment">// @Field: Cmd: current motor command</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>    <span class="comment">// @Field: TRate: current target angular rate</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>    <span class="comment">// @Field: Rate: current angular rate</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>    <span class="comment">// @Field: TAng: current target angle</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>    <span class="comment">// @Field: Ang: current angle</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>    <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#abab7cb26825a8dfb1e5e92cf7fcf4152">WriteStreaming</a>(</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>        <span class="stringliteral">&quot;ATDH&quot;</span>,</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>        <span class="stringliteral">&quot;TimeUS,Cmd,TRate,Rate,TAng,Ang&quot;</span>,</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>        <span class="stringliteral">&quot;s-kkdd&quot;</span>,</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>        <span class="stringliteral">&quot;F00000&quot;</span>,</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>        <span class="stringliteral">&quot;Qfffff&quot;</span>,</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>(),</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>        motor_cmd,</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>        tgt_rate_rads*57.3,</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>        rate_rads*57.3f,</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>        tgt_ang_rad*57.3,</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>        ang_rad*57.3f);</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>}</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span> </div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span><span class="comment">// Write an Autotune frequency response data packet</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span><span class="keywordtype">void</span> AC_AutoTune_Heli::Log_Write_AutoTuneSweep(<span class="keywordtype">float</span> freq, <span class="keywordtype">float</span> gain, <span class="keywordtype">float</span> phase)</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>{</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>    <span class="comment">// @LoggerMessage: ATSH</span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <span class="comment">// @Description: Heli AutoTune Sweep packet</span></div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>    <span class="comment">// @Vehicles: Copter</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>    <span class="comment">// @Field: TimeUS: Time since system startup</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>    <span class="comment">// @Field: freq: current frequency</span></div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>    <span class="comment">// @Field: gain: current response gain</span></div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>    <span class="comment">// @Field: phase: current response phase</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>    <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#abab7cb26825a8dfb1e5e92cf7fcf4152">WriteStreaming</a>(</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>        <span class="stringliteral">&quot;ATSH&quot;</span>,</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>        <span class="stringliteral">&quot;TimeUS,freq,gain,phase&quot;</span>,</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>        <span class="stringliteral">&quot;sE-d&quot;</span>,</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>        <span class="stringliteral">&quot;F000&quot;</span>,</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>        <span class="stringliteral">&quot;Qfff&quot;</span>,</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>(),</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>        freq,</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>        gain,</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>        phase);</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>}</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span><span class="preprocessor">#endif  </span><span class="comment">// HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span> </div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span><span class="comment">// reset the test variables for each vehicle</span></div>
<div class="foldopen" id="foldopen01849" data-start="{" data-end="}">
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a9733f5a3ee7c254d16b9883d7a4d4d76"> 1849</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a9733f5a3ee7c254d16b9883d7a4d4d76">AC_AutoTune_Heli::reset_vehicle_test_variables</a>()</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>{</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>    <span class="comment">// reset dwell test variables if sweep was interrupted in order to restart sweep</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a>(<a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a>, <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a>)) {</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">freq_cnt</a> = 0;</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">start_freq</a> = 0.0f;</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">stop_freq</a> = 0.0f;</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>    }</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>}</div>
</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span> </div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span><span class="comment">// reset the update gain variables for heli</span></div>
<div class="foldopen" id="foldopen01860" data-start="{" data-end="}">
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a62d343838ecb85e1400e6d6770e6f6c9"> 1860</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a62d343838ecb85e1400e6d6770e6f6c9">AC_AutoTune_Heli::reset_update_gain_variables</a>()</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>{</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>    <span class="comment">// reset feedforward update gain variables</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a3ed419400f13c688e118de7bfce5f6b0">ff_up_first_iter</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5f0e443c19b4a31608a0b14af12e7c1b">first_dir_complete</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span> </div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>    <span class="comment">// reset max gain variables</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>    <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0ff6782729ee915e99e2b3c3f3de258e">reset_maxgains_update_gain_variables</a>();</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span> </div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>    <span class="comment">// reset rd_up variables</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a34179f328be78eefae7e4037ddf46947">rd_prev_good_frq_cnt</a> = 0;</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">rd_prev_gain</a> = 0.0f;</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span> </div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>    <span class="comment">// reset rp_up variables</span></div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a1ebf93793397d70df71b631f2aeb92a5">rp_prev_good_frq_cnt</a> = 0;</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span> </div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>    <span class="comment">// reset sp_up variables</span></div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ab9a2e58f767ac0346fd3c7fcb6becdc6">phase_max</a> = 0.0f;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">sp_prev_gain</a> = 0.0f;</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">find_peak</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span> </div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>}</div>
</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span> </div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span><span class="comment">// reset the max_gains update gain variables</span></div>
<div class="foldopen" id="foldopen01884" data-start="{" data-end="}">
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a0ff6782729ee915e99e2b3c3f3de258e"> 1884</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a0ff6782729ee915e99e2b3c3f3de258e">AC_AutoTune_Heli::reset_maxgains_update_gain_variables</a>()</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>{</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">max_rate_p</a> = {};</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">max_rate_d</a> = {};</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">found_max_p</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">found_max_d</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">find_middle</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span> </div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>}</div>
</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span> </div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span><span class="comment">// reset the max_gains update gain variables</span></div>
<div class="foldopen" id="foldopen01895" data-start="{" data-end="}">
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790"> 1895</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">AC_AutoTune_Heli::reset_sweep_variables</a>()</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>{</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">ph180</a> = {};</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a531df29170bff692a4dbb2fffd1e72d2">ph270</a> = {};</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">maxgain</a> = {};</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span> </div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">sweep</a>.<a class="code hl_variable" href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">progress</a> = 0;</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>}</div>
</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span> </div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span><span class="comment">// set the tuning test sequence</span></div>
<div class="foldopen" id="foldopen01905" data-start="{" data-end="}">
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#ac5f5fffe0e536b56f65f482d5673c541"> 1905</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#ac5f5fffe0e536b56f65f482d5673c541">AC_AutoTune_Heli::set_tune_sequence</a>()</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>{</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>    uint8_t seq_cnt = 0;</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span> </div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a86fcbf3bcd56e624aea8afdd26e37316">AUTOTUNE_SEQ_BITMASK_VFF</a>) {</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">RFF_UP</a>;</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>        seq_cnt++;</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>    }</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a96cc84e40aa26f7865d22dad94920164">AUTOTUNE_SEQ_BITMASK_RATE_D</a>) {</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>;</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>        seq_cnt++;</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">RD_UP</a>;</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>        seq_cnt++;</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">RP_UP</a>;</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>        seq_cnt++;</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>    }</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a9e10028cbcb7cd80dff633a2841b24f8">AUTOTUNE_SEQ_BITMASK_ANGLE_P</a>) {</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">SP_UP</a>;</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>        seq_cnt++;</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>    }</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a3fa2dfb42f3e3b9ac3e53ef88344e5c7">AUTOTUNE_SEQ_BITMASK_MAX_GAIN</a> &amp;&amp; !(<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a96cc84e40aa26f7865d22dad94920164">AUTOTUNE_SEQ_BITMASK_RATE_D</a>)) {</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">MAX_GAINS</a>;</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>        seq_cnt++;</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>    }</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">seq_bitmask</a> &amp; <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#a8c07b408f9ca6abe62ea89a871332321">AUTOTUNE_SEQ_BITMASK_TUNE_CHECK</a>) {</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>        <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">TUNE_CHECK</a>;</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>        seq_cnt++;</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>    }</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>    <a class="code hl_variable" href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">tune_seq</a>[seq_cnt] = <a class="code hl_enumvalue" href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a">TUNE_COMPLETE</a>;</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span> </div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>}</div>
</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span> </div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span><span class="comment">// get_testing_step_timeout_ms accessor</span></div>
<div class="foldopen" id="foldopen01938" data-start="{" data-end="}">
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#aae8c9ce7634d655193ed39695c237526"> 1938</a></span>uint32_t <a class="code hl_function" href="classAC__AutoTune__Heli.html#aae8c9ce7634d655193ed39695c237526">AC_AutoTune_Heli::get_testing_step_timeout_ms</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="AC__AutoTune__Heli_8cpp.html#ad8003e1f859e9ed253661357dfcb5902">AUTOTUNE_TESTING_STEP_TIMEOUT_MS</a>;</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>}</div>
</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span> </div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>    <span class="comment">// exceeded_freq_range - ensures tuning remains inside frequency range</span></div>
<div class="foldopen" id="foldopen01944" data-start="{" data-end="}">
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"><a class="line" href="classAC__AutoTune__Heli.html#a7e9b39f876c3352326e32ad7cbf39063"> 1944</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAC__AutoTune__Heli.html#a7e9b39f876c3352326e32ad7cbf39063">AC_AutoTune_Heli::exceeded_freq_range</a>(<span class="keywordtype">float</span> frequency)</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>{</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>    <span class="keywordflow">if</span> (frequency &lt; min_sweep_freq || frequency &gt; <a class="code hl_variable" href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">max_sweep_freq</a>) {</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>        ret = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>    }</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>}</div>
</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span> </div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span><span class="preprocessor">#endif  </span><span class="comment">// AC_AUTOTUNE_ENABLED</span></div>
<div class="ttc" id="aAC__AutoTune_8h_html_a09957b77f03c6f541b8c6e1d281d3e91"><div class="ttname"><a href="AC__AutoTune_8h.html#a09957b77f03c6f541b8c6e1d281d3e91">AUTOTUNE_MESSAGE_FAILED</a></div><div class="ttdeci">#define AUTOTUNE_MESSAGE_FAILED</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00041">AC_AutoTune.h:41</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_a23bf564ea3611994620075c8f3be3247"><div class="ttname"><a href="AC__AutoTune_8h.html#a23bf564ea3611994620075c8f3be3247">AUTOTUNE_SUCCESS_COUNT</a></div><div class="ttdeci">#define AUTOTUNE_SUCCESS_COUNT</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00035">AC_AutoTune.h:35</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_a48bfe2b4b02644d586535150fb8f2d3d"><div class="ttname"><a href="AC__AutoTune_8h.html#a48bfe2b4b02644d586535150fb8f2d3d">AUTOTUNE_ANNOUNCE_INTERVAL_MS</a></div><div class="ttdeci">#define AUTOTUNE_ANNOUNCE_INTERVAL_MS</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00045">AC_AutoTune.h:45</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_a5497ff920ceb814093df36b2b5fad79e"><div class="ttname"><a href="AC__AutoTune_8h.html#a5497ff920ceb814093df36b2b5fad79e">AUTOTUNE_AXIS_BITMASK_ROLL</a></div><div class="ttdeci">#define AUTOTUNE_AXIS_BITMASK_ROLL</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00030">AC_AutoTune.h:30</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_aabe00050c468b57664c128474d55278f"><div class="ttname"><a href="AC__AutoTune_8h.html#aabe00050c468b57664c128474d55278f">AUTOTUNE_AXIS_BITMASK_PITCH</a></div><div class="ttdeci">#define AUTOTUNE_AXIS_BITMASK_PITCH</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00031">AC_AutoTune.h:31</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_aebd28483149e9ca433dbb79f254bdf58"><div class="ttname"><a href="AC__AutoTune_8h.html#aebd28483149e9ca433dbb79f254bdf58">AUTOTUNE_AXIS_BITMASK_YAW</a></div><div class="ttdeci">#define AUTOTUNE_AXIS_BITMASK_YAW</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00032">AC_AutoTune.h:32</a></div></div>
<div class="ttc" id="aAC__AutoTune_8h_html_af31f96eca02ad4daf09274cb61472d7a"><div class="ttname"><a href="AC__AutoTune_8h.html#af31f96eca02ad4daf09274cb61472d7a">AUTOTUNE_MESSAGE_SAVED_GAINS</a></div><div class="ttdeci">#define AUTOTUNE_MESSAGE_SAVED_GAINS</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00042">AC_AutoTune.h:42</a></div></div>
<div class="ttc" id="aAC__AutoTune__FreqResp_8h_html_a8566a41a5eba54860c1d1e69299481cf"><div class="ttname"><a href="AC__AutoTune__FreqResp_8h.html#a8566a41a5eba54860c1d1e69299481cf">AUTOTUNE_DWELL_CYCLES</a></div><div class="ttdeci">#define AUTOTUNE_DWELL_CYCLES</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00009">AC_AutoTune_FreqResp.h:9</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a0916971038b21abfd6eebaed66232059"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a0916971038b21abfd6eebaed66232059">AUTOTUNE_HELI_TARGET_RATE_RLLPIT_CDS</a></div><div class="ttdeci">#define AUTOTUNE_HELI_TARGET_RATE_RLLPIT_CDS</div><div class="ttdef"><b>Definition</b> <a href="#l00051">AC_AutoTune_Heli.cpp:51</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a1aaab6d17517f6f667ee54a8dcceec99"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a1aaab6d17517f6f667ee54a8dcceec99">AUTOTUNE_RD_BACKOFF</a></div><div class="ttdeci">#define AUTOTUNE_RD_BACKOFF</div><div class="ttdef"><b>Definition</b> <a href="#l00044">AC_AutoTune_Heli.cpp:44</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a1dd8193779c326451b93b0cd5595005c"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a1dd8193779c326451b93b0cd5595005c">AUTOTUNE_FFI_RATIO_FOR_TESTING</a></div><div class="ttdeci">#define AUTOTUNE_FFI_RATIO_FOR_TESTING</div><div class="ttdef"><b>Definition</b> <a href="#l00052">AC_AutoTune_Heli.cpp:52</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a2d4c86ab0a84c81b0d4fee3d20e3a9bc"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a2d4c86ab0a84c81b0d4fee3d20e3a9bc">AUTOTUNE_RP_MIN</a></div><div class="ttdeci">#define AUTOTUNE_RP_MIN</div><div class="ttdef"><b>Definition</b> <a href="#l00038">AC_AutoTune_Heli.cpp:38</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a3c8b7cb1b70254e1853833d00e276394"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a3c8b7cb1b70254e1853833d00e276394">AUTOTUNE_SP_MIN</a></div><div class="ttdeci">#define AUTOTUNE_SP_MIN</div><div class="ttdef"><b>Definition</b> <a href="#l00041">AC_AutoTune_Heli.cpp:41</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a3d98ea203baafde6ade13041bd58a9f2"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a3d98ea203baafde6ade13041bd58a9f2">AUTOTUNE_PI_RATIO_FOR_TESTING</a></div><div class="ttdeci">#define AUTOTUNE_PI_RATIO_FOR_TESTING</div><div class="ttdef"><b>Definition</b> <a href="#l00034">AC_AutoTune_Heli.cpp:34</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a3fa2dfb42f3e3b9ac3e53ef88344e5c7"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a3fa2dfb42f3e3b9ac3e53ef88344e5c7">AUTOTUNE_SEQ_BITMASK_MAX_GAIN</a></div><div class="ttdeci">#define AUTOTUNE_SEQ_BITMASK_MAX_GAIN</div><div class="ttdef"><b>Definition</b> <a href="#l00060">AC_AutoTune_Heli.cpp:60</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a42e52a68df1c0540bdb883985177b6ab"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a42e52a68df1c0540bdb883985177b6ab">AUTOTUNE_RD_MAX</a></div><div class="ttdeci">#define AUTOTUNE_RD_MAX</div><div class="ttdef"><b>Definition</b> <a href="#l00037">AC_AutoTune_Heli.cpp:37</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a459b1cd2cf706a54a67775a7430b6f3b"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a459b1cd2cf706a54a67775a7430b6f3b">AUTOTUNE_YAW_PI_RATIO_FINAL</a></div><div class="ttdeci">#define AUTOTUNE_YAW_PI_RATIO_FINAL</div><div class="ttdef"><b>Definition</b> <a href="#l00036">AC_AutoTune_Heli.cpp:36</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a699e8b2672dc11c1473faf90b824dffe"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a699e8b2672dc11c1473faf90b824dffe">AUTOTUNE_RFF_MIN</a></div><div class="ttdeci">#define AUTOTUNE_RFF_MIN</div><div class="ttdef"><b>Definition</b> <a href="#l00043">AC_AutoTune_Heli.cpp:43</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a6d2f73bed50ddfb5decefc2d19457012"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a6d2f73bed50ddfb5decefc2d19457012">AUTOTUNE_HELI_TARGET_ANGLE_RLLPIT_CD</a></div><div class="ttdeci">#define AUTOTUNE_HELI_TARGET_ANGLE_RLLPIT_CD</div><div class="ttdef"><b>Definition</b> <a href="#l00050">AC_AutoTune_Heli.cpp:50</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a86fcbf3bcd56e624aea8afdd26e37316"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a86fcbf3bcd56e624aea8afdd26e37316">AUTOTUNE_SEQ_BITMASK_VFF</a></div><div class="ttdeci">#define AUTOTUNE_SEQ_BITMASK_VFF</div><div class="ttdef"><b>Definition</b> <a href="#l00057">AC_AutoTune_Heli.cpp:57</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a8a024030a7c5194b96fe9db6439505b0"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a8a024030a7c5194b96fe9db6439505b0">AUTOTUNE_RP_MAX</a></div><div class="ttdeci">#define AUTOTUNE_RP_MAX</div><div class="ttdef"><b>Definition</b> <a href="#l00039">AC_AutoTune_Heli.cpp:39</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a8c07b408f9ca6abe62ea89a871332321"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a8c07b408f9ca6abe62ea89a871332321">AUTOTUNE_SEQ_BITMASK_TUNE_CHECK</a></div><div class="ttdeci">#define AUTOTUNE_SEQ_BITMASK_TUNE_CHECK</div><div class="ttdef"><b>Definition</b> <a href="#l00061">AC_AutoTune_Heli.cpp:61</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a96cc84e40aa26f7865d22dad94920164"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a96cc84e40aa26f7865d22dad94920164">AUTOTUNE_SEQ_BITMASK_RATE_D</a></div><div class="ttdeci">#define AUTOTUNE_SEQ_BITMASK_RATE_D</div><div class="ttdef"><b>Definition</b> <a href="#l00058">AC_AutoTune_Heli.cpp:58</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_a9e10028cbcb7cd80dff633a2841b24f8"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#a9e10028cbcb7cd80dff633a2841b24f8">AUTOTUNE_SEQ_BITMASK_ANGLE_P</a></div><div class="ttdeci">#define AUTOTUNE_SEQ_BITMASK_ANGLE_P</div><div class="ttdef"><b>Definition</b> <a href="#l00059">AC_AutoTune_Heli.cpp:59</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_aa4559356c8b3ab98ca85717d99af17e8"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#aa4559356c8b3ab98ca85717d99af17e8">AUTOTUNE_SP_BACKOFF</a></div><div class="ttdeci">#define AUTOTUNE_SP_BACKOFF</div><div class="ttdef"><b>Definition</b> <a href="#l00046">AC_AutoTune_Heli.cpp:46</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_aaabbaebe134f2a50b24aa7548fb527a5"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#aaabbaebe134f2a50b24aa7548fb527a5">AUTOTUNE_RP_BACKOFF</a></div><div class="ttdeci">#define AUTOTUNE_RP_BACKOFF</div><div class="ttdef"><b>Definition</b> <a href="#l00045">AC_AutoTune_Heli.cpp:45</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_ab945759a3a4243849d884df545dc4619"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#ab945759a3a4243849d884df545dc4619">AUTOTUNE_SP_MAX</a></div><div class="ttdeci">#define AUTOTUNE_SP_MAX</div><div class="ttdef"><b>Definition</b> <a href="#l00040">AC_AutoTune_Heli.cpp:40</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_ad315cde5210450414b41c1c0cd585066"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#ad315cde5210450414b41c1c0cd585066">AUTOTUNE_FFI_RATIO_FINAL</a></div><div class="ttdeci">#define AUTOTUNE_FFI_RATIO_FINAL</div><div class="ttdef"><b>Definition</b> <a href="#l00053">AC_AutoTune_Heli.cpp:53</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_ad5fac72e41bb2f30d97ea1a8fa9f12e1"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#ad5fac72e41bb2f30d97ea1a8fa9f12e1">AUTOTUNE_RFF_MAX</a></div><div class="ttdeci">#define AUTOTUNE_RFF_MAX</div><div class="ttdef"><b>Definition</b> <a href="#l00042">AC_AutoTune_Heli.cpp:42</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8cpp_html_ad8003e1f859e9ed253661357dfcb5902"><div class="ttname"><a href="AC__AutoTune__Heli_8cpp.html#ad8003e1f859e9ed253661357dfcb5902">AUTOTUNE_TESTING_STEP_TIMEOUT_MS</a></div><div class="ttdeci">#define AUTOTUNE_TESTING_STEP_TIMEOUT_MS</div><div class="ttdef"><b>Definition</b> <a href="#l00029">AC_AutoTune_Heli.cpp:29</a></div></div>
<div class="ttc" id="aAC__AutoTune__Heli_8h_html"><div class="ttname"><a href="AC__AutoTune__Heli_8h.html">AC_AutoTune_Heli.h</a></div></div>
<div class="ttc" id="aAC__AutoTune__config_8h_html"><div class="ttname"><a href="AC__AutoTune__config_8h.html">AC_AutoTune_config.h</a></div></div>
<div class="ttc" id="aAP__Logger_8h_html"><div class="ttname"><a href="AP__Logger_8h.html">AP_Logger.h</a></div></div>
<div class="ttc" id="aAP__Logger_8h_html_aa94f7ca8b3d2ed656f04cc3baef50c1a"><div class="ttname"><a href="AP__Logger_8h.html#aa94f7ca8b3d2ed656f04cc3baef50c1a">LOGGER_WRITE_EVENT</a></div><div class="ttdeci">#define LOGGER_WRITE_EVENT(evt)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8h_source.html#l00609">AP_Logger.h:609</a></div></div>
<div class="ttc" id="aAP__Logger_8h_html_abfb7fdeeabd95c90488508e20c5ea981a42946be177aeab3531580f3ca2434c71"><div class="ttname"><a href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981a42946be177aeab3531580f3ca2434c71">LogEvent::AUTOTUNE_INITIALISED</a></div><div class="ttdeci">@ AUTOTUNE_INITIALISED</div></div>
<div class="ttc" id="aAP__Logger_8h_html_abfb7fdeeabd95c90488508e20c5ea981ab5b53ea9f4907f052c78719268b5120a"><div class="ttname"><a href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ab5b53ea9f4907f052c78719268b5120a">LogEvent::AUTOTUNE_SAVEDGAINS</a></div><div class="ttdeci">@ AUTOTUNE_SAVEDGAINS</div></div>
<div class="ttc" id="aAP__Logger_8h_html_abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28"><div class="ttname"><a href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981ad3ced85c716ca965a78659b786844e28">LogEvent::AUTOTUNE_REACHED_LIMIT</a></div><div class="ttdeci">@ AUTOTUNE_REACHED_LIMIT</div></div>
<div class="ttc" id="aAP__Logger_8h_html_abfb7fdeeabd95c90488508e20c5ea981afd96b5c7a2b26dbcfd668d72018cf2fd"><div class="ttname"><a href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981afd96b5c7a2b26dbcfd668d72018cf2fd">LogEvent::AUTOTUNE_FAILED</a></div><div class="ttdeci">@ AUTOTUNE_FAILED</div></div>
<div class="ttc" id="aAP__Math_8cpp_html_a49de5d20e28222d3d8ac555a0a0a017d"><div class="ttname"><a href="AP__Math_8cpp.html#a49de5d20e28222d3d8ac555a0a0a017d">wrap_180_cd</a></div><div class="ttdeci">T wrap_180_cd(const T angle)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00157">AP_Math.cpp:157</a></div></div>
<div class="ttc" id="aAP__Math_8cpp_html_a74db690fa0d764d7e0900a9c97f629b2"><div class="ttname"><a href="AP__Math_8cpp.html#a74db690fa0d764d7e0900a9c97f629b2">is_equal</a></div><div class="ttdeci">std::enable_if&lt; std::is_integral&lt; typenamestd::common_type&lt; Arithmetic1, Arithmetic2 &gt;::type &gt;::value, bool &gt;::type is_equal(const Arithmetic1 v_1, const Arithmetic2 v_2)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00014">AP_Math.cpp:14</a></div></div>
<div class="ttc" id="aAP__Math_8cpp_html_ac89eb1832d8e4d67fcf1ac07e3c25184"><div class="ttname"><a href="AP__Math_8cpp.html#ac89eb1832d8e4d67fcf1ac07e3c25184">safe_sqrt</a></div><div class="ttdeci">float safe_sqrt(const T v)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00071">AP_Math.cpp:71</a></div></div>
<div class="ttc" id="aAP__Math_8cpp_html_ae2d4d03c107c3e6a127fb167e3908aa2"><div class="ttname"><a href="AP__Math_8cpp.html#ae2d4d03c107c3e6a127fb167e3908aa2">linear_interpolate</a></div><div class="ttdeci">float linear_interpolate(float low_output, float high_output, float var_value, float var_low, float var_high)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00098">AP_Math.cpp:98</a></div></div>
<div class="ttc" id="aAP__Math_8cpp_html_af836ccbc389735a6f129d85126eab30a"><div class="ttname"><a href="AP__Math_8cpp.html#af836ccbc389735a6f129d85126eab30a">wrap_360_cd</a></div><div class="ttdeci">float wrap_360_cd(const float angle)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00210">AP_Math.cpp:210</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a2a12cce483e9b870da70d30406d82c60"><div class="ttname"><a href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a></div><div class="ttdeci">bool is_zero(const T fVal1)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00053">AP_Math.h:53</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a4e3ae698e8f99cec214348ad233e3c41"><div class="ttname"><a href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a></div><div class="ttdeci">bool is_positive(const T fVal1)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00063">AP_Math.h:63</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a5256308fd38a7098b8f95607aa56888f"><div class="ttname"><a href="AP__Math_8h.html#a5256308fd38a7098b8f95607aa56888f">constrain_float</a></div><div class="ttdeci">#define constrain_float(amt, low, high)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00174">AP_Math.h:174</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00163">AP_Param.h:163</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00145">AP_Param.h:145</a></div></div>
<div class="ttc" id="aGCS_8h_html"><div class="ttname"><a href="GCS_8h.html">GCS.h</a></div><div class="ttdoc">Interface definition for the various Ground Control System.</div></div>
<div class="ttc" id="aGCS_8h_html_ab53f292b698f9a6a3f029dfdbd5a43de"><div class="ttname"><a href="GCS_8h.html#ab53f292b698f9a6a3f029dfdbd5a43de">gcs</a></div><div class="ttdeci">GCS &amp; gcs()</div><div class="ttdef"><b>Definition</b> <a href="GCS__Common_8cpp_source.html#l06846">GCS_Common.cpp:6846</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a054a91d8ef862a20a9c1fced2def685b"><div class="ttname"><a href="classAC__AttitudeControl.html#a054a91d8ef862a20a9c1fced2def685b">AC_AttitudeControl::get_rate_roll_pid</a></div><div class="ttdeci">virtual AC_PID &amp; get_rate_roll_pid()=0</div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a0b0a032fc5cf7e19a570e680df54a6d8"><div class="ttname"><a href="classAC__AttitudeControl.html#a0b0a032fc5cf7e19a570e680df54a6d8">AC_AttitudeControl::rate_bf_pitch_target</a></div><div class="ttdeci">void rate_bf_pitch_target(float rate_cds)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00233">AC_AttitudeControl.h:233</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a1da892418310d6779dad6a65f66203cc"><div class="ttname"><a href="classAC__AttitudeControl.html#a1da892418310d6779dad6a65f66203cc">AC_AttitudeControl::bf_feedforward_save</a></div><div class="ttdeci">void bf_feedforward_save(bool enable_or_disable)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00284">AC_AttitudeControl.h:284</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a2ca277e7c4a5ac2980814673aae2d037"><div class="ttname"><a href="classAC__AttitudeControl.html#a2ca277e7c4a5ac2980814673aae2d037">AC_AttitudeControl::input_rate_bf_roll_pitch_yaw</a></div><div class="ttdeci">virtual void input_rate_bf_roll_pitch_yaw(float roll_rate_bf_cds, float pitch_rate_bf_cds, float yaw_rate_bf_cds)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8cpp_source.html#l00421">AC_AttitudeControl.cpp:421</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a31d06b169a8fc6c7ebf17b644e3c8597"><div class="ttname"><a href="classAC__AttitudeControl.html#a31d06b169a8fc6c7ebf17b644e3c8597">AC_AttitudeControl::rate_bf_targets</a></div><div class="ttdeci">Vector3f rate_bf_targets() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00275">AC_AttitudeControl.h:275</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a3b474a8d875b7fbdba044567f08ac972"><div class="ttname"><a href="classAC__AttitudeControl.html#a3b474a8d875b7fbdba044567f08ac972">AC_AttitudeControl::rate_bf_roll_target</a></div><div class="ttdeci">void rate_bf_roll_target(float rate_cds)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00230">AC_AttitudeControl.h:230</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a4aae58ad7f851d2cf936d68809eaeba8"><div class="ttname"><a href="classAC__AttitudeControl.html#a4aae58ad7f851d2cf936d68809eaeba8">AC_AttitudeControl::reset_yaw_target_and_rate</a></div><div class="ttdeci">void reset_yaw_target_and_rate(bool reset_rate=true)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8cpp_source.html#l00947">AC_AttitudeControl.cpp:947</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a4b0e45d449268c319b63534dccebe134"><div class="ttname"><a href="classAC__AttitudeControl.html#a4b0e45d449268c319b63534dccebe134">AC_AttitudeControl::get_bf_feedforward</a></div><div class="ttdeci">bool get_bf_feedforward()</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00287">AC_AttitudeControl.h:287</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a4e87dfa269d0c59e5ac25045476263bf"><div class="ttname"><a href="classAC__AttitudeControl.html#a4e87dfa269d0c59e5ac25045476263bf">AC_AttitudeControl::use_sqrt_controller</a></div><div class="ttdeci">void use_sqrt_controller(bool use_sqrt_cont)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00211">AC_AttitudeControl.h:211</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a72c6b498bd3873052810de9a218913a6"><div class="ttname"><a href="classAC__AttitudeControl.html#a72c6b498bd3873052810de9a218913a6">AC_AttitudeControl::get_input_tc</a></div><div class="ttdeci">float get_input_tc() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00134">AC_AttitudeControl.h:134</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a767288d62f3dfb4c384c8b380b734856"><div class="ttname"><a href="classAC__AttitudeControl.html#a767288d62f3dfb4c384c8b380b734856">AC_AttitudeControl::save_accel_roll_max_cdss</a></div><div class="ttdeci">void save_accel_roll_max_cdss(float accel_roll_max)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00099">AC_AttitudeControl.h:99</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a7e72972f6ade41178a7bf8591d4423ed"><div class="ttname"><a href="classAC__AttitudeControl.html#a7e72972f6ade41178a7bf8591d4423ed">AC_AttitudeControl::get_angle_pitch_p</a></div><div class="ttdeci">AC_P &amp; get_angle_pitch_p()</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00082">AC_AttitudeControl.h:82</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_a9d7ac4baee54cfede81b09ab06fc8060"><div class="ttname"><a href="classAC__AttitudeControl.html#a9d7ac4baee54cfede81b09ab06fc8060">AC_AttitudeControl::set_accel_roll_max_cdss</a></div><div class="ttdeci">void set_accel_roll_max_cdss(float accel_roll_max)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00096">AC_AttitudeControl.h:96</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_aa111691a6822ceea4c70c434ee6d38e7"><div class="ttname"><a href="classAC__AttitudeControl.html#aa111691a6822ceea4c70c434ee6d38e7">AC_AttitudeControl::input_euler_angle_roll_pitch_yaw</a></div><div class="ttdeci">virtual void input_euler_angle_roll_pitch_yaw(float euler_roll_angle_cd, float euler_pitch_angle_cd, float euler_yaw_angle_cd, bool slew_yaw)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8cpp_source.html#l00320">AC_AttitudeControl.cpp:320</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_aad7a6a93245781a107fec17a850f6902"><div class="ttname"><a href="classAC__AttitudeControl.html#aad7a6a93245781a107fec17a850f6902">AC_AttitudeControl::save_accel_pitch_max_cdss</a></div><div class="ttdeci">void save_accel_pitch_max_cdss(float accel_pitch_max)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00109">AC_AttitudeControl.h:109</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ab62747dc70b886a2e3affdee4e8bda09"><div class="ttname"><a href="classAC__AttitudeControl.html#ab62747dc70b886a2e3affdee4e8bda09">AC_AttitudeControl::set_accel_yaw_max_cdss</a></div><div class="ttdeci">void set_accel_yaw_max_cdss(float accel_yaw_max)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00116">AC_AttitudeControl.h:116</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_abd68c885291f6295086d634f69c013b0"><div class="ttname"><a href="classAC__AttitudeControl.html#abd68c885291f6295086d634f69c013b0">AC_AttitudeControl::rate_bf_yaw_target</a></div><div class="ttdeci">void rate_bf_yaw_target(float rate_cds)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00236">AC_AttitudeControl.h:236</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ac0e561f6f97fdbe8092e2f02cb40bb90"><div class="ttname"><a href="classAC__AttitudeControl.html#ac0e561f6f97fdbe8092e2f02cb40bb90">AC_AttitudeControl::bf_feedforward</a></div><div class="ttdeci">void bf_feedforward(bool enable_or_disable)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00281">AC_AttitudeControl.h:281</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ad48f67abaf5974e51aa783f4e80fd10c"><div class="ttname"><a href="classAC__AttitudeControl.html#ad48f67abaf5974e51aa783f4e80fd10c">AC_AttitudeControl::set_accel_pitch_max_cdss</a></div><div class="ttdeci">void set_accel_pitch_max_cdss(float accel_pitch_max)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00106">AC_AttitudeControl.h:106</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_adef3aadae796b01e71e77139426fcce9"><div class="ttname"><a href="classAC__AttitudeControl.html#adef3aadae796b01e71e77139426fcce9">AC_AttitudeControl::get_angle_roll_p</a></div><div class="ttdeci">AC_P &amp; get_angle_roll_p()</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00081">AC_AttitudeControl.h:81</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ae352616dda789b6496b714a993564637"><div class="ttname"><a href="classAC__AttitudeControl.html#ae352616dda789b6496b714a993564637">AC_AttitudeControl::reset_target_and_rate</a></div><div class="ttdeci">void reset_target_and_rate(bool reset_rate=true)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8cpp_source.html#l00933">AC_AttitudeControl.cpp:933</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ae4cea1c7fcffb5a7dbdf2508fea73380"><div class="ttname"><a href="classAC__AttitudeControl.html#ae4cea1c7fcffb5a7dbdf2508fea73380">AC_AttitudeControl::get_accel_yaw_max_cdss</a></div><div class="ttdeci">float get_accel_yaw_max_cdss() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00112">AC_AttitudeControl.h:112</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ae6c2a863159c129651c40640fa46edfe"><div class="ttname"><a href="classAC__AttitudeControl.html#ae6c2a863159c129651c40640fa46edfe">AC_AttitudeControl::get_angle_yaw_p</a></div><div class="ttdeci">AC_P &amp; get_angle_yaw_p()</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00083">AC_AttitudeControl.h:83</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_ae97a67a22eb0150b1fb097c58d36b961"><div class="ttname"><a href="classAC__AttitudeControl.html#ae97a67a22eb0150b1fb097c58d36b961">AC_AttitudeControl::get_att_target_euler_cd</a></div><div class="ttdeci">Vector3f get_att_target_euler_cd() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00217">AC_AttitudeControl.h:217</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_aecb340d46636b76dff086c5ae7af113c"><div class="ttname"><a href="classAC__AttitudeControl.html#aecb340d46636b76dff086c5ae7af113c">AC_AttitudeControl::get_rate_pitch_pid</a></div><div class="ttdeci">virtual AC_PID &amp; get_rate_pitch_pid()=0</div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_aed596797461545fe38edc44669ae60e8"><div class="ttname"><a href="classAC__AttitudeControl.html#aed596797461545fe38edc44669ae60e8">AC_AttitudeControl::get_accel_roll_max_cdss</a></div><div class="ttdeci">float get_accel_roll_max_cdss() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00092">AC_AttitudeControl.h:92</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_af0e7aef643e29d1f1af2a9cd1945d426"><div class="ttname"><a href="classAC__AttitudeControl.html#af0e7aef643e29d1f1af2a9cd1945d426">AC_AttitudeControl::input_euler_angle_roll_pitch_euler_rate_yaw</a></div><div class="ttdeci">virtual void input_euler_angle_roll_pitch_euler_rate_yaw(float euler_roll_angle_cd, float euler_pitch_angle_cd, float euler_yaw_rate_cds)</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8cpp_source.html#l00269">AC_AttitudeControl.cpp:269</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_af4caeece5ed0e6d1038ecfacb0043fd3"><div class="ttname"><a href="classAC__AttitudeControl.html#af4caeece5ed0e6d1038ecfacb0043fd3">AC_AttitudeControl::get_accel_pitch_max_cdss</a></div><div class="ttdeci">float get_accel_pitch_max_cdss() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AttitudeControl_8h_source.html#l00102">AC_AttitudeControl.h:102</a></div></div>
<div class="ttc" id="aclassAC__AttitudeControl_html_afca955109401c92d59b067062cb4430b"><div class="ttname"><a href="classAC__AttitudeControl.html#afca955109401c92d59b067062cb4430b">AC_AttitudeControl::get_rate_yaw_pid</a></div><div class="ttdeci">virtual AC_PID &amp; get_rate_yaw_pid()=0</div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a0d1acba5aebd47580bb3e959c962b751a5305d515dc96c98fb352f7fb7264dd15"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751a5305d515dc96c98fb352f7fb7264dd15">AC_AutoTune_FreqResp::RATE</a></div><div class="ttdeci">@ RATE</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00026">AC_AutoTune_FreqResp.h:26</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a0d1acba5aebd47580bb3e959c962b751aedaeabcf681c6e1f4c5932e46825d3b1"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a0d1acba5aebd47580bb3e959c962b751aedaeabcf681c6e1f4c5932e46825d3b1">AC_AutoTune_FreqResp::ANGLE</a></div><div class="ttdeci">@ ANGLE</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00027">AC_AutoTune_FreqResp.h:27</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a37b9c88a3f81ad7ab6ae5c399c50c40a"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a37b9c88a3f81ad7ab6ae5c399c50c40a">AC_AutoTune_FreqResp::reset_cycle_complete</a></div><div class="ttdeci">void reset_cycle_complete()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00041">AC_AutoTune_FreqResp.h:41</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a526c10cbf56910b8c0c7d9e06317d0ef"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a526c10cbf56910b8c0c7d9e06317d0ef">AC_AutoTune_FreqResp::get_accel_max</a></div><div class="ttdeci">float get_accel_max()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00047">AC_AutoTune_FreqResp.h:47</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a605b46fdcd6bdeb9d9042b832f5cb037"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a605b46fdcd6bdeb9d9042b832f5cb037">AC_AutoTune_FreqResp::init</a></div><div class="ttdeci">void init(InputType input_type, ResponseType response_type)</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8cpp_source.html#l00009">AC_AutoTune_FreqResp.cpp:9</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a662f5477c0ba1c84d27f4fe55d94d307a10f69dacf1a3214bb2ad66eebda4458c"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a10f69dacf1a3214bb2ad66eebda4458c">AC_AutoTune_FreqResp::SWEEP</a></div><div class="ttdeci">@ SWEEP</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00021">AC_AutoTune_FreqResp.h:21</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a662f5477c0ba1c84d27f4fe55d94d307a245199b7189ce03119b6d1bde5921419"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a662f5477c0ba1c84d27f4fe55d94d307a245199b7189ce03119b6d1bde5921419">AC_AutoTune_FreqResp::DWELL</a></div><div class="ttdeci">@ DWELL</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00020">AC_AutoTune_FreqResp.h:20</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a665ca37dd506117c3d91c393f11faef5"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a665ca37dd506117c3d91c393f11faef5">AC_AutoTune_FreqResp::get_phase</a></div><div class="ttdeci">float get_phase()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00046">AC_AutoTune_FreqResp.h:46</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_a68603a35134d6216679858e3a2c05748"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#a68603a35134d6216679858e3a2c05748">AC_AutoTune_FreqResp::update</a></div><div class="ttdeci">void update(float command, float tgt_resp, float meas_resp, float tgt_freq)</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8cpp_source.html#l00038">AC_AutoTune_FreqResp.cpp:38</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_ab8d1752a1b8b19898145dc3b68abf94c"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#ab8d1752a1b8b19898145dc3b68abf94c">AC_AutoTune_FreqResp::is_cycle_complete</a></div><div class="ttdeci">bool is_cycle_complete()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00038">AC_AutoTune_FreqResp.h:38</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_ac892e279bc5219214db8a3db7061a9e1"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#ac892e279bc5219214db8a3db7061a9e1">AC_AutoTune_FreqResp::get_freq</a></div><div class="ttdeci">float get_freq()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00044">AC_AutoTune_FreqResp.h:44</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__FreqResp_html_afd5dde1c801ede267a682c1af0ab72e6"><div class="ttname"><a href="classAC__AutoTune__FreqResp.html#afd5dde1c801ede267a682c1af0ab72e6">AC_AutoTune_FreqResp::get_gain</a></div><div class="ttdeci">float get_gain()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__FreqResp_8h_source.html#l00045">AC_AutoTune_FreqResp.h:45</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html"><div class="ttname"><a href="classAC__AutoTune__Heli.html">AC_AutoTune_Heli</a></div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00031">AC_AutoTune_Heli.h:32</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a03d240cbe0c90b562b1a2ae0f87a1c83"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a03d240cbe0c90b562b1a2ae0f87a1c83">AC_AutoTune_Heli::filt_tgt_rate_reading</a></div><div class="ttdeci">LowPassFilterFloat filt_tgt_rate_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00267">AC_AutoTune_Heli.h:267</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a03fd4c5ca9e069d3b32ea046ad146611"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a03fd4c5ca9e069d3b32ea046ad146611">AC_AutoTune_Heli::updating_max_gains_all</a></div><div class="ttdeci">void updating_max_gains_all(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01285">AC_AutoTune_Heli.cpp:1285</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a07306d20c585139fdcb82e8472800a20"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a07306d20c585139fdcb82e8472800a20">AC_AutoTune_Heli::trim_meas_rate</a></div><div class="ttdeci">float trim_meas_rate</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00253">AC_AutoTune_Heli.h:253</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a09f00689b08fa53dd8eab10d5ca7a4e9"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a09f00689b08fa53dd8eab10d5ca7a4e9">AC_AutoTune_Heli::AC_AutoTune_Heli</a></div><div class="ttdeci">AC_AutoTune_Heli()</div><div class="ttdef"><b>Definition</b> <a href="#l00111">AC_AutoTune_Heli.cpp:111</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a0b4a5ef0f8e568e311198ec52770d1a9"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a0b4a5ef0f8e568e311198ec52770d1a9">AC_AutoTune_Heli::dwell_test_run</a></div><div class="ttdeci">void dwell_test_run(uint8_t freq_resp_input, float start_frq, float stop_frq, float &amp;dwell_gain, float &amp;dwell_phase, DwellType dwell_type)</div><div class="ttdef"><b>Definition</b> <a href="#l00950">AC_AutoTune_Heli.cpp:950</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a0fb2e627a1c2c4f470b6b95289fe2d2a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a0fb2e627a1c2c4f470b6b95289fe2d2a">AC_AutoTune_Heli::trim_command</a></div><div class="ttdeci">float trim_command</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00271">AC_AutoTune_Heli.h:271</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a0ff6782729ee915e99e2b3c3f3de258e"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a0ff6782729ee915e99e2b3c3f3de258e">AC_AutoTune_Heli::reset_maxgains_update_gain_variables</a></div><div class="ttdeci">void reset_maxgains_update_gain_variables()</div><div class="ttdef"><b>Definition</b> <a href="#l01884">AC_AutoTune_Heli.cpp:1884</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a12bc04b1d34f5e542b56fdc7533b7e57"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a12bc04b1d34f5e542b56fdc7533b7e57">AC_AutoTune_Heli::start_angles</a></div><div class="ttdeci">Vector3f start_angles</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00249">AC_AutoTune_Heli.h:249</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a13997db00069868aa0e409e7799b60e8"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a13997db00069868aa0e409e7799b60e8">AC_AutoTune_Heli::updating_angle_p_up_all</a></div><div class="ttdeci">void updating_angle_p_up_all(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01266">AC_AutoTune_Heli.cpp:1266</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a166399159373f7f885562efc88d89bbf"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a166399159373f7f885562efc88d89bbf">AC_AutoTune_Heli::filt_command_reading</a></div><div class="ttdeci">LowPassFilterFloat filt_command_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00265">AC_AutoTune_Heli.h:265</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a17e7e2f554e944c6ddf018c0ddbf1d05"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a17e7e2f554e944c6ddf018c0ddbf1d05">AC_AutoTune_Heli::dwell_start_time_ms</a></div><div class="ttdeci">float dwell_start_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00238">AC_AutoTune_Heli.h:238</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a1ebf93793397d70df71b631f2aeb92a5"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a1ebf93793397d70df71b631f2aeb92a5">AC_AutoTune_Heli::rp_prev_good_frq_cnt</a></div><div class="ttdeci">uint8_t rp_prev_good_frq_cnt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00221">AC_AutoTune_Heli.h:221</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a24c218fc3981df6c9ec22d67ad8af044"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a24c218fc3981df6c9ec22d67ad8af044">AC_AutoTune_Heli::do_post_test_gcs_announcements</a></div><div class="ttdeci">void do_post_test_gcs_announcements() override</div><div class="ttdef"><b>Definition</b> <a href="#l00323">AC_AutoTune_Heli.cpp:323</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a31dbce97518af5ccff61c551f04a136a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a31dbce97518af5ccff61c551f04a136a">AC_AutoTune_Heli::target_rate_filt</a></div><div class="ttdeci">LowPassFilterFloat target_rate_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00276">AC_AutoTune_Heli.h:276</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a34179f328be78eefae7e4037ddf46947"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a34179f328be78eefae7e4037ddf46947">AC_AutoTune_Heli::rd_prev_good_frq_cnt</a></div><div class="ttdeci">uint8_t rd_prev_good_frq_cnt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00225">AC_AutoTune_Heli.h:225</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a367a87f708658774044f77a7987a25af"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a367a87f708658774044f77a7987a25af">AC_AutoTune_Heli::filt_pit_roll_cd</a></div><div class="ttdeci">LowPassFilterVector2f filt_pit_roll_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00262">AC_AutoTune_Heli.h:262</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a3a9474e2033b2af4961355cf32a9280a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a3a9474e2033b2af4961355cf32a9280a">AC_AutoTune_Heli::angle_request_cd</a></div><div class="ttdeci">LowPassFilterFloat angle_request_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00259">AC_AutoTune_Heli.h:259</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a3ba294c5dd5856c7802f2546541ebda1"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a3ba294c5dd5856c7802f2546541ebda1">AC_AutoTune_Heli::phase_out_time</a></div><div class="ttdeci">uint32_t phase_out_time</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00251">AC_AutoTune_Heli.h:251</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a3e1970bbf9d38685cd73fce245362812"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a3e1970bbf9d38685cd73fce245362812">AC_AutoTune_Heli::rate_ff_test_init</a></div><div class="ttdeci">void rate_ff_test_init()</div><div class="ttdef"><b>Definition</b> <a href="#l00694">AC_AutoTune_Heli.cpp:694</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4277b5d67bc4cb8e7d8d421984849c0d"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4277b5d67bc4cb8e7d8d421984849c0d">AC_AutoTune_Heli::updating_rate_p_up</a></div><div class="ttdeci">void updating_rate_p_up(float &amp;tune_p, float *freq, float *gain, float *phase, uint8_t &amp;frq_cnt, max_gain_data &amp;max_gain_p)</div><div class="ttdef"><b>Definition</b> <a href="#l01406">AC_AutoTune_Heli.cpp:1406</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a44b3391933543eacfcdad7abcf922157"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a44b3391933543eacfcdad7abcf922157">AC_AutoTune_Heli::load_intra_test_gains</a></div><div class="ttdeci">void load_intra_test_gains() override</div><div class="ttdef"><b>Definition</b> <a href="#l00487">AC_AutoTune_Heli.cpp:487</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a45b5c903a96b471ad45dd972b8bed4b1"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a45b5c903a96b471ad45dd972b8bed4b1">AC_AutoTune_Heli::filt_target_rate</a></div><div class="ttdeci">float filt_target_rate</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00234">AC_AutoTune_Heli.h:234</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4833595f5105f24a4c59a969bc34f39b"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4833595f5105f24a4c59a969bc34f39b">AC_AutoTune_Heli::sweep_time_ms</a></div><div class="ttdeci">const float sweep_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00289">AC_AutoTune_Heli.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4bfbb1905ef40efc766d51713e5792ff"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4bfbb1905ef40efc766d51713e5792ff">AC_AutoTune_Heli::max_resp_gain</a></div><div class="ttdeci">AP_Float max_resp_gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00297">AC_AutoTune_Heli.h:297</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4fa5225d8f4bf529dd0be39a239cfdf8"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8">AC_AutoTune_Heli::DwellType</a></div><div class="ttdeci">DwellType</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00153">AC_AutoTune_Heli.h:153</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8a3e218befbb32a6021da949706ff5c2b0">AC_AutoTune_Heli::RATE</a></div><div class="ttdeci">@ RATE</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00154">AC_AutoTune_Heli.h:154</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8ab3ed8b9c4c34573b5ae256265e9c2517">AC_AutoTune_Heli::DRB</a></div><div class="ttdeci">@ DRB</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00156">AC_AutoTune_Heli.h:156</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a4fa5225d8f4bf529dd0be39a239cfdf8afb37a88b8565cb3555252f256a16767f"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a4fa5225d8f4bf529dd0be39a239cfdf8afb37a88b8565cb3555252f256a16767f">AC_AutoTune_Heli::ANGLE</a></div><div class="ttdeci">@ ANGLE</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00155">AC_AutoTune_Heli.h:155</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a523d503e13a1e032d2bf063aef736093"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a523d503e13a1e032d2bf063aef736093">AC_AutoTune_Heli::set_gains_post_tune</a></div><div class="ttdeci">void set_gains_post_tune(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01309">AC_AutoTune_Heli.cpp:1309</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a53e8234f8524721f85da0112878543d3"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a53e8234f8524721f85da0112878543d3">AC_AutoTune_Heli::trim_heading</a></div><div class="ttdeci">float trim_heading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00257">AC_AutoTune_Heli.h:257</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a569f1d90be03dcc250a94b0d9a23545d"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a569f1d90be03dcc250a94b0d9a23545d">AC_AutoTune_Heli::sweep</a></div><div class="ttdeci">sweep_data sweep</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00286">AC_AutoTune_Heli.h:286</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a581fd3200d08720e87bb6fb6fe7ee301"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a581fd3200d08720e87bb6fb6fe7ee301">AC_AutoTune_Heli::test_run</a></div><div class="ttdeci">void test_run(AxisType test_axis, const float dir_sign) override</div><div class="ttdef"><b>Definition</b> <a href="#l00234">AC_AutoTune_Heli.cpp:234</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a59e4416f54d0a080f1c13b02ec50dd25"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a59e4416f54d0a080f1c13b02ec50dd25">AC_AutoTune_Heli::test_phase</a></div><div class="ttdeci">float test_phase[20]</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00237">AC_AutoTune_Heli.h:237</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a5e8232f165ceafd37564643f8296518a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a5e8232f165ceafd37564643f8296518a">AC_AutoTune_Heli::max_sweep_freq</a></div><div class="ttdeci">AP_Float max_sweep_freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00296">AC_AutoTune_Heli.h:296</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a5f0e443c19b4a31608a0b14af12e7c1b"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a5f0e443c19b4a31608a0b14af12e7c1b">AC_AutoTune_Heli::first_dir_complete</a></div><div class="ttdeci">bool first_dir_complete</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00199">AC_AutoTune_Heli.h:199</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a62d343838ecb85e1400e6d6770e6f6c9"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a62d343838ecb85e1400e6d6770e6f6c9">AC_AutoTune_Heli::reset_update_gain_variables</a></div><div class="ttdeci">void reset_update_gain_variables() override</div><div class="ttdef"><b>Definition</b> <a href="#l01860">AC_AutoTune_Heli.cpp:1860</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a65df61266b1e07bfcee687db07fbbf92"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a65df61266b1e07bfcee687db07fbbf92">AC_AutoTune_Heli::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00063">AC_AutoTune_Heli.h:63</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a67f9abab43ff7ebda72f334a46cc5ef9"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a67f9abab43ff7ebda72f334a46cc5ef9">AC_AutoTune_Heli::updating_rate_d_up_all</a></div><div class="ttdeci">void updating_rate_d_up_all(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01228">AC_AutoTune_Heli.cpp:1228</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a68f21852a16d47a53995e8fa25f9d98b"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a68f21852a16d47a53995e8fa25f9d98b">AC_AutoTune_Heli::found_max_p</a></div><div class="ttdeci">bool found_max_p</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00205">AC_AutoTune_Heli.h:205</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a6e01d4c0893059b59d07cd812ba78fa4"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a6e01d4c0893059b59d07cd812ba78fa4">AC_AutoTune_Heli::max_rate_p</a></div><div class="ttdeci">max_gain_data max_rate_p</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00148">AC_AutoTune_Heli.h:148</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a6e55c7c00c27d6a697e8fbd65904e205"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a6e55c7c00c27d6a697e8fbd65904e205">AC_AutoTune_Heli::test_freq</a></div><div class="ttdeci">float test_freq[20]</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00236">AC_AutoTune_Heli.h:236</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a760cc913abd3315fbd4fc42bee107c56"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a760cc913abd3315fbd4fc42bee107c56">AC_AutoTune_Heli::chirp_input</a></div><div class="ttdeci">Chirp chirp_input</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00303">AC_AutoTune_Heli.h:303</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a7e9b39f876c3352326e32ad7cbf39063"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a7e9b39f876c3352326e32ad7cbf39063">AC_AutoTune_Heli::exceeded_freq_range</a></div><div class="ttdeci">bool exceeded_freq_range(float frequency)</div><div class="ttdef"><b>Definition</b> <a href="#l01944">AC_AutoTune_Heli.cpp:1944</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a7f893082b0d019ca085e6a1c4fa8c1fe"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a7f893082b0d019ca085e6a1c4fa8c1fe">AC_AutoTune_Heli::test_tgt_rate_filt</a></div><div class="ttdeci">float test_tgt_rate_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00233">AC_AutoTune_Heli.h:233</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a81731ba9f596199d2693c5edda3a75bb"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a81731ba9f596199d2693c5edda3a75bb">AC_AutoTune_Heli::settle_time</a></div><div class="ttdeci">uint32_t settle_time</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00250">AC_AutoTune_Heli.h:250</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a83ba37c1cc37d6a8d6858b89d707f4fa"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a83ba37c1cc37d6a8d6858b89d707f4fa">AC_AutoTune_Heli::found_max_d</a></div><div class="ttdeci">bool found_max_d</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00207">AC_AutoTune_Heli.h:207</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a87c3fa7ae8c28c81f61318741b2cebf2"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a87c3fa7ae8c28c81f61318741b2cebf2">AC_AutoTune_Heli::freqresp</a></div><div class="ttdeci">AC_AutoTune_FreqResp freqresp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00301">AC_AutoTune_Heli.h:301</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a896f9586792bdc0e368a2168e5b5b30a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a896f9586792bdc0e368a2168e5b5b30a">AC_AutoTune_Heli::report_final_gains</a></div><div class="ttdeci">void report_final_gains(AxisType test_axis) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00669">AC_AutoTune_Heli.cpp:669</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a91327bf1b46a22d7e04e23e9d205549e"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a91327bf1b46a22d7e04e23e9d205549e">AC_AutoTune_Heli::curr_test</a></div><div class="ttdeci">sweep_info curr_test</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00247">AC_AutoTune_Heli.h:247</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9733f5a3ee7c254d16b9883d7a4d4d76"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9733f5a3ee7c254d16b9883d7a4d4d76">AC_AutoTune_Heli::reset_vehicle_test_variables</a></div><div class="ttdeci">void reset_vehicle_test_variables() override</div><div class="ttdef"><b>Definition</b> <a href="#l01849">AC_AutoTune_Heli.cpp:1849</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9a8d1a1fc00366d6964f01951767accd"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9a8d1a1fc00366d6964f01951767accd">AC_AutoTune_Heli::save_tuning_gains</a></div><div class="ttdeci">void save_tuning_gains() override</div><div class="ttdef"><b>Definition</b> <a href="#l00595">AC_AutoTune_Heli.cpp:595</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9b25734c4f9ab33da6f10fa258b792ed"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9b25734c4f9ab33da6f10fa258b792ed">AC_AutoTune_Heli::filt_att_fdbk_from_velxy_cd</a></div><div class="ttdeci">LowPassFilterVector2f filt_att_fdbk_from_velxy_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00264">AC_AutoTune_Heli.h:264</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9c135efcd591da91b69b32cbdc37ed00"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9c135efcd591da91b69b32cbdc37ed00">AC_AutoTune_Heli::load_tuned_gains</a></div><div class="ttdeci">void load_tuned_gains() override</div><div class="ttdef"><b>Definition</b> <a href="#l00465">AC_AutoTune_Heli.cpp:465</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9c2606fa93c53ecb89b4aa4c26c8545a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9c2606fa93c53ecb89b4aa4c26c8545a">AC_AutoTune_Heli::do_gcs_announcements</a></div><div class="ttdeci">void do_gcs_announcements() override</div><div class="ttdef"><b>Definition</b> <a href="#l00291">AC_AutoTune_Heli.cpp:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9e4829910362301dae7313389c2f8e40"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9e4829910362301dae7313389c2f8e40">AC_AutoTune_Heli::trim_yaw_heading_reading</a></div><div class="ttdeci">float trim_yaw_heading_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00273">AC_AutoTune_Heli.h:273</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_a9f2738649bef4d4f186a5976c85a02f8"><div class="ttname"><a href="classAC__AutoTune__Heli.html#a9f2738649bef4d4f186a5976c85a02f8">AC_AutoTune_Heli::report_axis_gains</a></div><div class="ttdeci">void report_axis_gains(const char *axis_string, float rate_P, float rate_I, float rate_D, float rate_ff, float angle_P, float max_accel) const</div><div class="ttdef"><b>Definition</b> <a href="#l00686">AC_AutoTune_Heli.cpp:686</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aa330dc948b12cc0fc815d00e707454ba"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aa330dc948b12cc0fc815d00e707454ba">AC_AutoTune_Heli::dwell_test_init</a></div><div class="ttdeci">void dwell_test_init(float start_frq, float stop_frq, float filt_freq, DwellType dwell_type)</div><div class="ttdef"><b>Definition</b> <a href="#l00890">AC_AutoTune_Heli.cpp:890</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aa4f00efc813dcc08a7acc889441b5ba2"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aa4f00efc813dcc08a7acc889441b5ba2">AC_AutoTune_Heli::updating_max_gains</a></div><div class="ttdeci">void updating_max_gains(float *freq, float *gain, float *phase, uint8_t &amp;frq_cnt, max_gain_data &amp;max_gain_p, max_gain_data &amp;max_gain_d, float &amp;tune_p, float &amp;tune_d)</div><div class="ttdef"><b>Definition</b> <a href="#l01622">AC_AutoTune_Heli.cpp:1622</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aa68cfb13c1b93811e6e59119fded6c90"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aa68cfb13c1b93811e6e59119fded6c90">AC_AutoTune_Heli::filt_gyro_reading</a></div><div class="ttdeci">LowPassFilterFloat filt_gyro_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00266">AC_AutoTune_Heli.h:266</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aae8c9ce7634d655193ed39695c237526"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aae8c9ce7634d655193ed39695c237526">AC_AutoTune_Heli::get_testing_step_timeout_ms</a></div><div class="ttdeci">uint32_t get_testing_step_timeout_ms() const override</div><div class="ttdef"><b>Definition</b> <a href="#l01938">AC_AutoTune_Heli.cpp:1938</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ab2b658dcbc94930f7a0782ae3fd5143d"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ab2b658dcbc94930f7a0782ae3fd5143d">AC_AutoTune_Heli::test_rate_filt</a></div><div class="ttdeci">float test_rate_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00231">AC_AutoTune_Heli.h:231</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ab3da60dce12d4fee034c3f29ae5095fb"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ab3da60dce12d4fee034c3f29ae5095fb">AC_AutoTune_Heli::test_command_filt</a></div><div class="ttdeci">float test_command_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00230">AC_AutoTune_Heli.h:230</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ab9a2e58f767ac0346fd3c7fcb6becdc6"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ab9a2e58f767ac0346fd3c7fcb6becdc6">AC_AutoTune_Heli::phase_max</a></div><div class="ttdeci">float phase_max</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00213">AC_AutoTune_Heli.h:213</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ac315b67e53592aecab53d4d728733a5c"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ac315b67e53592aecab53d4d728733a5c">AC_AutoTune_Heli::max_rate_d</a></div><div class="ttdeci">max_gain_data max_rate_d</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00150">AC_AutoTune_Heli.h:150</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ac4e59ecc5bb7fd291df5b8482b50e790"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ac4e59ecc5bb7fd291df5b8482b50e790">AC_AutoTune_Heli::updating_rate_p_up_all</a></div><div class="ttdeci">void updating_rate_p_up_all(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01211">AC_AutoTune_Heli.cpp:1211</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ac5f5fffe0e536b56f65f482d5673c541"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ac5f5fffe0e536b56f65f482d5673c541">AC_AutoTune_Heli::set_tune_sequence</a></div><div class="ttdeci">void set_tune_sequence() override</div><div class="ttdef"><b>Definition</b> <a href="#l01905">AC_AutoTune_Heli.cpp:1905</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aca584a7982e7bbf4c2eedf99f8157def"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aca584a7982e7bbf4c2eedf99f8157def">AC_AutoTune_Heli::trim_command_reading</a></div><div class="ttdeci">float trim_command_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00256">AC_AutoTune_Heli.h:256</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_acb64ba8b3acef9d9c21a0d5d65ea6873"><div class="ttname"><a href="classAC__AutoTune__Heli.html#acb64ba8b3acef9d9c21a0d5d65ea6873">AC_AutoTune_Heli::command_filt</a></div><div class="ttdeci">LowPassFilterFloat command_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00275">AC_AutoTune_Heli.h:275</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_acc0fba65e97d6ed65f99fc05286065f9"><div class="ttname"><a href="classAC__AutoTune__Heli.html#acc0fba65e97d6ed65f99fc05286065f9">AC_AutoTune_Heli::rate_request_cds</a></div><div class="ttdeci">LowPassFilterFloat rate_request_cds</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00258">AC_AutoTune_Heli.h:258</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ace7463c5fac4d440a80d330766686d7b"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ace7463c5fac4d440a80d330766686d7b">AC_AutoTune_Heli::find_middle</a></div><div class="ttdeci">bool find_middle</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00209">AC_AutoTune_Heli.h:209</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad008a2b701b9e843bf782a42aafef441"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad008a2b701b9e843bf782a42aafef441">AC_AutoTune_Heli::freq_cnt_max</a></div><div class="ttdeci">uint8_t freq_cnt_max</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00239">AC_AutoTune_Heli.h:239</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad1937bd0fefb79633ece02d9f227bbd8"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad1937bd0fefb79633ece02d9f227bbd8">AC_AutoTune_Heli::first_dir_rff</a></div><div class="ttdeci">float first_dir_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00201">AC_AutoTune_Heli.h:201</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad1a558eaab01d80c4e72377694696966"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad1a558eaab01d80c4e72377694696966">AC_AutoTune_Heli::updating_rate_d_up</a></div><div class="ttdeci">void updating_rate_d_up(float &amp;tune_d, float *freq, float *gain, float *phase, uint8_t &amp;frq_cnt, max_gain_data &amp;max_gain_d)</div><div class="ttdef"><b>Definition</b> <a href="#l01458">AC_AutoTune_Heli.cpp:1458</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad327db4a0ef1dfa5b7b2d29622d50921"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad327db4a0ef1dfa5b7b2d29622d50921">AC_AutoTune_Heli::updating_rate_ff_up</a></div><div class="ttdeci">void updating_rate_ff_up(float &amp;tune_ff, float rate_target, float meas_rate, float meas_command)</div><div class="ttdef"><b>Definition</b> <a href="#l01363">AC_AutoTune_Heli.cpp:1363</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad6258ef563283b567ef4fe11fa4204e2"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad6258ef563283b567ef4fe11fa4204e2">AC_AutoTune_Heli::trim_yaw_tgt_reading</a></div><div class="ttdeci">float trim_yaw_tgt_reading</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00272">AC_AutoTune_Heli.h:272</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ad84003c3e324eb94e02b478b0c26c931"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ad84003c3e324eb94e02b478b0c26c931">AC_AutoTune_Heli::load_orig_gains</a></div><div class="ttdeci">void load_orig_gains() override</div><div class="ttdef"><b>Definition</b> <a href="#l00450">AC_AutoTune_Heli.cpp:450</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ada556736f4a241a2c5eb963172c69df6"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ada556736f4a241a2c5eb963172c69df6">AC_AutoTune_Heli::min_sweep_freq</a></div><div class="ttdeci">AP_Float min_sweep_freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00295">AC_AutoTune_Heli.h:295</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ae42e6d198721a81bde8b8e2ec4f2c790"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ae42e6d198721a81bde8b8e2ec4f2c790">AC_AutoTune_Heli::reset_sweep_variables</a></div><div class="ttdeci">void reset_sweep_variables()</div><div class="ttdef"><b>Definition</b> <a href="#l01895">AC_AutoTune_Heli.cpp:1895</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ae4f0684ddb2081516f8bd34aea2f742f"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ae4f0684ddb2081516f8bd34aea2f742f">AC_AutoTune_Heli::rate_ff_test_run</a></div><div class="ttdeci">void rate_ff_test_run(float max_angle_cds, float target_rate_cds, float dir_sign)</div><div class="ttdef"><b>Definition</b> <a href="#l00715">AC_AutoTune_Heli.cpp:715</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ae899df8b741061462117377d14ca2b5f"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ae899df8b741061462117377d14ca2b5f">AC_AutoTune_Heli::seq_bitmask</a></div><div class="ttdeci">AP_Int8 seq_bitmask</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00294">AC_AutoTune_Heli.h:294</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_ae8a16c31cfe575c9e7528b57430911df"><div class="ttname"><a href="classAC__AutoTune__Heli.html#ae8a16c31cfe575c9e7528b57430911df">AC_AutoTune_Heli::test_gain</a></div><div class="ttdeci">float test_gain[20]</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00235">AC_AutoTune_Heli.h:235</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aea94968e29187b913750b53fc4d0383d"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aea94968e29187b913750b53fc4d0383d">AC_AutoTune_Heli::filt_heading_error_cd</a></div><div class="ttdeci">LowPassFilterFloat filt_heading_error_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00263">AC_AutoTune_Heli.h:263</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aeca6f1a1af2da29008c56faddd9d647a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aeca6f1a1af2da29008c56faddd9d647a">AC_AutoTune_Heli::vel_hold_gain</a></div><div class="ttdeci">AP_Float vel_hold_gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00298">AC_AutoTune_Heli.h:298</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aecda73b0ee09339ec38bbdd0c25bc967"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aecda73b0ee09339ec38bbdd0c25bc967">AC_AutoTune_Heli::rd_prev_gain</a></div><div class="ttdeci">float rd_prev_gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00227">AC_AutoTune_Heli.h:227</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aed31e91d609992a7bc57c7deafe38586"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aed31e91d609992a7bc57c7deafe38586">AC_AutoTune_Heli::trim_pff_out</a></div><div class="ttdeci">float trim_pff_out</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00252">AC_AutoTune_Heli.h:252</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aed51cbff4095a356bc6940f9de92b385"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aed51cbff4095a356bc6940f9de92b385">AC_AutoTune_Heli::updating_angle_p_up</a></div><div class="ttdeci">void updating_angle_p_up(float &amp;tune_p, float *freq, float *gain, float *phase, uint8_t &amp;frq_cnt)</div><div class="ttdef"><b>Definition</b> <a href="#l01525">AC_AutoTune_Heli.cpp:1525</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aedbf8216f99bf2f47aa93726a4da1c7f"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aedbf8216f99bf2f47aa93726a4da1c7f">AC_AutoTune_Heli::updating_rate_ff_up_all</a></div><div class="ttdeci">void updating_rate_ff_up_all(AxisType test_axis) override</div><div class="ttdef"><b>Definition</b> <a href="#l01245">AC_AutoTune_Heli.cpp:1245</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_aef97f4a54680b2d22341ed06fa8d9b25"><div class="ttname"><a href="classAC__AutoTune__Heli.html#aef97f4a54680b2d22341ed06fa8d9b25">AC_AutoTune_Heli::ff_test_phase</a></div><div class="ttdeci">uint8_t ff_test_phase</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00229">AC_AutoTune_Heli.h:229</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_af113e87fc2057fc8d4434eb9620c0c98"><div class="ttname"><a href="classAC__AutoTune__Heli.html#af113e87fc2057fc8d4434eb9620c0c98">AC_AutoTune_Heli::command_out</a></div><div class="ttdeci">float command_out</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00232">AC_AutoTune_Heli.h:232</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_af6c010324c9ac265b7ab2728f03f954c"><div class="ttname"><a href="classAC__AutoTune__Heli.html#af6c010324c9ac265b7ab2728f03f954c">AC_AutoTune_Heli::test_init</a></div><div class="ttdeci">void test_init() override</div><div class="ttdef"><b>Definition</b> <a href="#l00118">AC_AutoTune_Heli.cpp:118</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_af6c811e7b1020a14e2d21cff2ed1f327"><div class="ttname"><a href="classAC__AutoTune__Heli.html#af6c811e7b1020a14e2d21cff2ed1f327">AC_AutoTune_Heli::trim_attitude_cd</a></div><div class="ttdeci">Vector3f trim_attitude_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00270">AC_AutoTune_Heli.h:270</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_af9f5092665c9ac67eac8b8ab0416ea66"><div class="ttname"><a href="classAC__AutoTune__Heli.html#af9f5092665c9ac67eac8b8ab0416ea66">AC_AutoTune_Heli::sp_prev_gain</a></div><div class="ttdeci">float sp_prev_gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00215">AC_AutoTune_Heli.h:215</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_afaac46d8c9f2da88472d56bfae3fb8df"><div class="ttname"><a href="classAC__AutoTune__Heli.html#afaac46d8c9f2da88472d56bfae3fb8df">AC_AutoTune_Heli::load_gain_set</a></div><div class="ttdeci">void load_gain_set(AxisType s_axis, float rate_p, float rate_i, float rate_d, float rate_ff, float angle_p, float max_accel, float rate_fltt, float rate_flte, float smax)</div><div class="ttdef"><b>Definition</b> <a href="#l00555">AC_AutoTune_Heli.cpp:555</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_afb94eb4172fc6e04816afd2ad11e2181"><div class="ttname"><a href="classAC__AutoTune__Heli.html#afb94eb4172fc6e04816afd2ad11e2181">AC_AutoTune_Heli::find_peak</a></div><div class="ttdeci">bool find_peak</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00217">AC_AutoTune_Heli.h:217</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_afc7e02c4e2098f2452baa507b780e71f"><div class="ttname"><a href="classAC__AutoTune__Heli.html#afc7e02c4e2098f2452baa507b780e71f">AC_AutoTune_Heli::load_test_gains</a></div><div class="ttdeci">void load_test_gains() override</div><div class="ttdef"><b>Definition</b> <a href="#l00505">AC_AutoTune_Heli.cpp:505</a></div></div>
<div class="ttc" id="aclassAC__AutoTune__Heli_html_afec312e9f685069bdc8742105dfcdf5a"><div class="ttname"><a href="classAC__AutoTune__Heli.html#afec312e9f685069bdc8742105dfcdf5a">AC_AutoTune_Heli::backup_gains_and_initialise</a></div><div class="ttdeci">void backup_gains_and_initialise() override</div><div class="ttdef"><b>Definition</b> <a href="#l00389">AC_AutoTune_Heli.cpp:389</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a00b3258a64dd355dc9fe45580ca1d390"><div class="ttname"><a href="classAC__AutoTune.html#a00b3258a64dd355dc9fe45580ca1d390">AC_AutoTune::orig_yaw_rff</a></div><div class="ttdeci">float orig_yaw_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a02f30299e7d8f62e0637e37b8cb70eaf"><div class="ttname"><a href="classAC__AutoTune.html#a02f30299e7d8f62e0637e37b8cb70eaf">AC_AutoTune::orig_roll_rd</a></div><div class="ttdeci">float orig_roll_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a056a45355b20fe8d605dc38f5c1e1d4b"><div class="ttname"><a href="classAC__AutoTune.html#a056a45355b20fe8d605dc38f5c1e1d4b">AC_AutoTune::backup_gains_and_initialise</a></div><div class="ttdeci">virtual void backup_gains_and_initialise()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00557">AC_AutoTune.cpp:557</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a05b6bacf7ac1ce165661fcb83139fa23a5fed84a5d9b3c0b9430f821ca2b886e9"><div class="ttname"><a href="classAC__AutoTune.html#a05b6bacf7ac1ce165661fcb83139fa23a5fed84a5d9b3c0b9430f821ca2b886e9">AC_AutoTune::GAIN_ORIGINAL</a></div><div class="ttdeci">@ GAIN_ORIGINAL</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00239">AC_AutoTune.h:239</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a05e648cce8e887e4db2d22667a1698c4"><div class="ttname"><a href="classAC__AutoTune.html#a05e648cce8e887e4db2d22667a1698c4">AC_AutoTune::tune_roll_accel</a></div><div class="ttdeci">float tune_roll_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00295">AC_AutoTune.h:295</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a062600f2656714254bc77897fcfe73fe"><div class="ttname"><a href="classAC__AutoTune.html#a062600f2656714254bc77897fcfe73fe">AC_AutoTune::tune_roll_rd</a></div><div class="ttdeci">float tune_roll_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00295">AC_AutoTune.h:295</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a0737b8584daa445b43f46710f71d579e"><div class="ttname"><a href="classAC__AutoTune.html#a0737b8584daa445b43f46710f71d579e">AC_AutoTune::tune_pitch_accel</a></div><div class="ttdeci">float tune_pitch_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00296">AC_AutoTune.h:296</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a08cf46046687e39c100b975d07025938"><div class="ttname"><a href="classAC__AutoTune.html#a08cf46046687e39c100b975d07025938">AC_AutoTune::roll_enabled</a></div><div class="ttdeci">bool roll_enabled() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00638">AC_AutoTune.cpp:638</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a0b236d7e42ff3ebf413e4d8246e567c9"><div class="ttname"><a href="classAC__AutoTune.html#a0b236d7e42ff3ebf413e4d8246e567c9">AC_AutoTune::desired_yaw_cd</a></div><div class="ttdeci">float desired_yaw_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00284">AC_AutoTune.h:284</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a0b9e432c872de3ed7930a57e78a102c7a3358e7c4bed15fda66b05d88d0eb0fde"><div class="ttname"><a href="classAC__AutoTune.html#a0b9e432c872de3ed7930a57e78a102c7a3358e7c4bed15fda66b05d88d0eb0fde">AC_AutoTune::FAILED</a></div><div class="ttdeci">@ FAILED</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00251">AC_AutoTune.h:251</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a0bcb319290bf88eb91b608642294f88a"><div class="ttname"><a href="classAC__AutoTune.html#a0bcb319290bf88eb91b608642294f88a">AC_AutoTune::tune_yaw_accel</a></div><div class="ttdeci">float tune_yaw_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00297">AC_AutoTune.h:297</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a0c544a4d38385a925779dd72c5a646f0"><div class="ttname"><a href="classAC__AutoTune.html#a0c544a4d38385a925779dd72c5a646f0">AC_AutoTune::orig_pitch_ri</a></div><div class="ttdeci">float orig_pitch_ri</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1081e97e5362430ac5432a3043f1e3f0"><div class="ttname"><a href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0">AC_AutoTune::AxisType</a></div><div class="ttdeci">AxisType</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00074">AC_AutoTune.h:74</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e"><div class="ttname"><a href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a31d69b9297d58986941a57b36eaf147e">AC_AutoTune::ROLL</a></div><div class="ttdeci">@ ROLL</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00075">AC_AutoTune.h:75</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890"><div class="ttname"><a href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a5d06db5db1f608d966e420a4d4d39890">AC_AutoTune::YAW_D</a></div><div class="ttdeci">@ YAW_D</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00078">AC_AutoTune.h:78</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d"><div class="ttname"><a href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a64fb5d570d8ad27f1647d67a2005904d">AC_AutoTune::PITCH</a></div><div class="ttdeci">@ PITCH</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00076">AC_AutoTune.h:76</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a"><div class="ttname"><a href="classAC__AutoTune.html#a1081e97e5362430ac5432a3043f1e3f0a7d37fb6199ec01148d2d6d468c13185a">AC_AutoTune::YAW</a></div><div class="ttdeci">@ YAW</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00077">AC_AutoTune.h:77</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a14738713542de9991c6c8c3cde0d0889"><div class="ttname"><a href="classAC__AutoTune.html#a14738713542de9991c6c8c3cde0d0889">AC_AutoTune::freq_cnt</a></div><div class="ttdeci">uint8_t freq_cnt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00306">AC_AutoTune.h:306</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1557521a2e46b1cbd759726caa7b7009"><div class="ttname"><a href="classAC__AutoTune.html#a1557521a2e46b1cbd759726caa7b7009">AC_AutoTune::orig_pitch_fltt</a></div><div class="ttdeci">float orig_pitch_fltt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a15aa365104f28821773ed31496c09c2e"><div class="ttname"><a href="classAC__AutoTune.html#a15aa365104f28821773ed31496c09c2e">AC_AutoTune::tune_yaw_sp</a></div><div class="ttdeci">float tune_yaw_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00297">AC_AutoTune.h:297</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0"><div class="ttname"><a href="classAC__AutoTune.html#a1ba6da3f2afa6a9fb78dfd6f2d2ff8a0">AC_AutoTune::orig_pitch_sp</a></div><div class="ttdeci">float orig_pitch_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1c95bf9bc9e06ae04c56f5e6953a0758"><div class="ttname"><a href="classAC__AutoTune.html#a1c95bf9bc9e06ae04c56f5e6953a0758">AC_AutoTune::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00067">AC_AutoTune.h:67</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a1e387aaf6c97daf0dde4c2fdead2eb76"><div class="ttname"><a href="classAC__AutoTune.html#a1e387aaf6c97daf0dde4c2fdead2eb76">AC_AutoTune::orig_yaw_ri</a></div><div class="ttdeci">float orig_yaw_ri</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a24dd9bb4e4da8006c603f1a3971e0b97"><div class="ttname"><a href="classAC__AutoTune.html#a24dd9bb4e4da8006c603f1a3971e0b97">AC_AutoTune::mode</a></div><div class="ttdeci">TuneMode mode</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00253">AC_AutoTune.h:253</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a28831c9aa3aa548bf93880161ab390bc"><div class="ttname"><a href="classAC__AutoTune.html#a28831c9aa3aa548bf93880161ab390bc">AC_AutoTune::positive_direction</a></div><div class="ttdeci">bool positive_direction</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00263">AC_AutoTune.h:263</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a2a000632a2a1b3b3fee03efc3ac21295"><div class="ttname"><a href="classAC__AutoTune.html#a2a000632a2a1b3b3fee03efc3ac21295">AC_AutoTune::orig_bf_feedforward</a></div><div class="ttdeci">bool orig_bf_feedforward</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00292">AC_AutoTune.h:292</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a2c2c3421935a12bc9d5bc8bfc1f2f261"><div class="ttname"><a href="classAC__AutoTune.html#a2c2c3421935a12bc9d5bc8bfc1f2f261">AC_AutoTune::orig_roll_rff</a></div><div class="ttdeci">float orig_roll_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a2dee86f41193c3d5d90d5e8b1d86386a"><div class="ttname"><a href="classAC__AutoTune.html#a2dee86f41193c3d5d90d5e8b1d86386a">AC_AutoTune::orig_roll_ri</a></div><div class="ttdeci">float orig_roll_ri</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a35966594ff085d04a3955d9762370079"><div class="ttname"><a href="classAC__AutoTune.html#a35966594ff085d04a3955d9762370079">AC_AutoTune::orig_roll_smax</a></div><div class="ttdeci">float orig_roll_smax</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3b35dac244c7497b58f0fc70094639dd"><div class="ttname"><a href="classAC__AutoTune.html#a3b35dac244c7497b58f0fc70094639dd">AC_AutoTune::start_angle</a></div><div class="ttdeci">float start_angle</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00279">AC_AutoTune.h:279</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3b6d61487f2dbf5ba77189d4a662748d"><div class="ttname"><a href="classAC__AutoTune.html#a3b6d61487f2dbf5ba77189d4a662748d">AC_AutoTune::orig_roll_sp</a></div><div class="ttdeci">float orig_roll_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3ce4b23756e8e5e8ddb32dd7af1a85df"><div class="ttname"><a href="classAC__AutoTune.html#a3ce4b23756e8e5e8ddb32dd7af1a85df">AC_AutoTune::start_freq</a></div><div class="ttdeci">float start_freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00307">AC_AutoTune.h:307</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3ce7b2e92e303a0836101699344c9e54"><div class="ttname"><a href="classAC__AutoTune.html#a3ce7b2e92e303a0836101699344c9e54">AC_AutoTune::type_string</a></div><div class="ttdeci">const char * type_string() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00144">AC_AutoTune.cpp:144</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3ed419400f13c688e118de7bfce5f6b0"><div class="ttname"><a href="classAC__AutoTune.html#a3ed419400f13c688e118de7bfce5f6b0">AC_AutoTune::ff_up_first_iter</a></div><div class="ttdeci">bool ff_up_first_iter</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00309">AC_AutoTune.h:309</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a3f2ee5ab1ed7e4ec1bc36892e0b459ce"><div class="ttname"><a href="classAC__AutoTune.html#a3f2ee5ab1ed7e4ec1bc36892e0b459ce">AC_AutoTune::counter</a></div><div class="ttdeci">int8_t counter</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00275">AC_AutoTune.h:275</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a406859d360908383867d56eb6575ed3b"><div class="ttname"><a href="classAC__AutoTune.html#a406859d360908383867d56eb6575ed3b">AC_AutoTune::ahrs_view</a></div><div class="ttdeci">AP_AHRS_View * ahrs_view</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00258">AC_AutoTune.h:258</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a44a0645b7d5372007007ff044d8dcaaf"><div class="ttname"><a href="classAC__AutoTune.html#a44a0645b7d5372007007ff044d8dcaaf">AC_AutoTune::announce_time</a></div><div class="ttdeci">uint32_t announce_time</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00300">AC_AutoTune.h:300</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a4b8f0d6e5605047cf71fc2babdfdaf33"><div class="ttname"><a href="classAC__AutoTune.html#a4b8f0d6e5605047cf71fc2babdfdaf33">AC_AutoTune::orig_yaw_accel</a></div><div class="ttdeci">float orig_yaw_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a5224955b4891ae2fd9cfc280e66883ed"><div class="ttname"><a href="classAC__AutoTune.html#a5224955b4891ae2fd9cfc280e66883ed">AC_AutoTune::orig_yaw_rLPF</a></div><div class="ttdeci">float orig_yaw_rLPF</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a57bdd4161989d4e5f64dc86e7f850936"><div class="ttname"><a href="classAC__AutoTune.html#a57bdd4161989d4e5f64dc86e7f850936">AC_AutoTune::tune_yaw_rLPF</a></div><div class="ttdeci">float tune_yaw_rLPF</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00297">AC_AutoTune.h:297</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a5b1172ea5cb09ca35c9c854d029d2bc8"><div class="ttname"><a href="classAC__AutoTune.html#a5b1172ea5cb09ca35c9c854d029d2bc8">AC_AutoTune::orig_yaw_fltt</a></div><div class="ttdeci">float orig_yaw_fltt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a5f420edf418e64f2bbda7c10da733e47"><div class="ttname"><a href="classAC__AutoTune.html#a5f420edf418e64f2bbda7c10da733e47">AC_AutoTune::rotation_rate_filt</a></div><div class="ttdeci">LowPassFilterFloat rotation_rate_filt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00286">AC_AutoTune.h:286</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a61fa5bd0494ca424df2664ef30c9cf16"><div class="ttname"><a href="classAC__AutoTune.html#a61fa5bd0494ca424df2664ef30c9cf16">AC_AutoTune::tune_roll_rff</a></div><div class="ttdeci">float tune_roll_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00298">AC_AutoTune.h:298</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a631c9816282509b55f3ae75677d00b79"><div class="ttname"><a href="classAC__AutoTune.html#a631c9816282509b55f3ae75677d00b79">AC_AutoTune::orig_pitch_rff</a></div><div class="ttdeci">float orig_pitch_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a6f6ee02fab054ca8a61e6f914867dde5"><div class="ttname"><a href="classAC__AutoTune.html#a6f6ee02fab054ca8a61e6f914867dde5">AC_AutoTune::tune_pitch_rd</a></div><div class="ttdeci">float tune_pitch_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00296">AC_AutoTune.h:296</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a7056af4898e455068ebb36b7d80f23f8"><div class="ttname"><a href="classAC__AutoTune.html#a7056af4898e455068ebb36b7d80f23f8">AC_AutoTune::tune_pitch_sp</a></div><div class="ttdeci">float tune_pitch_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00296">AC_AutoTune.h:296</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a7326fe6d611760cb8e75cdbd1b964e02"><div class="ttname"><a href="classAC__AutoTune.html#a7326fe6d611760cb8e75cdbd1b964e02">AC_AutoTune::stop_freq</a></div><div class="ttdeci">float stop_freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00308">AC_AutoTune.h:308</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a77d0d0e18e781d5e287d36ad8729ff8f"><div class="ttname"><a href="classAC__AutoTune.html#a77d0d0e18e781d5e287d36ad8729ff8f">AC_AutoTune::tune_yaw_rd</a></div><div class="ttdeci">float tune_yaw_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00298">AC_AutoTune.h:298</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a7bc17c0ed3a538954cbde0e885ec3141"><div class="ttname"><a href="classAC__AutoTune.html#a7bc17c0ed3a538954cbde0e885ec3141">AC_AutoTune::tune_roll_sp</a></div><div class="ttdeci">float tune_roll_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00295">AC_AutoTune.h:295</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a8233161a26fbf34db4312447efffa2cb"><div class="ttname"><a href="classAC__AutoTune.html#a8233161a26fbf34db4312447efffa2cb">AC_AutoTune::tune_yaw_rff</a></div><div class="ttdeci">float tune_yaw_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00298">AC_AutoTune.h:298</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a842444b915a14e50b55b4adbe00bd7cc"><div class="ttname"><a href="classAC__AutoTune.html#a842444b915a14e50b55b4adbe00bd7cc">AC_AutoTune::tune_yaw_rp</a></div><div class="ttdeci">float tune_yaw_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00297">AC_AutoTune.h:297</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a87c7c8399fd1458fb91cfea8a92b00a6"><div class="ttname"><a href="classAC__AutoTune.html#a87c7c8399fd1458fb91cfea8a92b00a6">AC_AutoTune::step_start_time_ms</a></div><div class="ttdeci">uint32_t step_start_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00273">AC_AutoTune.h:273</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a8bb0aa278e42e63304e1118c3b57d086"><div class="ttname"><a href="classAC__AutoTune.html#a8bb0aa278e42e63304e1118c3b57d086">AC_AutoTune::orig_pitch_accel</a></div><div class="ttdeci">float orig_pitch_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a8c261771392c82af1ca876ae6740deae"><div class="ttname"><a href="classAC__AutoTune.html#a8c261771392c82af1ca876ae6740deae">AC_AutoTune::tune_seq</a></div><div class="ttdeci">TuneType tune_seq[6]</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00219">AC_AutoTune.h:219</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a8f41a74af8681d65f681864ba4cc4ac8"><div class="ttname"><a href="classAC__AutoTune.html#a8f41a74af8681d65f681864ba4cc4ac8">AC_AutoTune::update_gcs</a></div><div class="ttdeci">void update_gcs(uint8_t message_id) const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00609">AC_AutoTune.cpp:609</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a952165567146c3e2035a814bdf2ec2dd"><div class="ttname"><a href="classAC__AutoTune.html#a952165567146c3e2035a814bdf2ec2dd">AC_AutoTune::motors</a></div><div class="ttdeci">AP_Motors * motors</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00260">AC_AutoTune.h:260</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a95bce5092914f6b2c88920aa25a329a2"><div class="ttname"><a href="classAC__AutoTune.html#a95bce5092914f6b2c88920aa25a329a2">AC_AutoTune::axis</a></div><div class="ttdeci">AxisType axis</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00262">AC_AutoTune.h:262</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a9680b00ac8177acf9dbe677112e7579d"><div class="ttname"><a href="classAC__AutoTune.html#a9680b00ac8177acf9dbe677112e7579d">AC_AutoTune::orig_roll_rp</a></div><div class="ttdeci">float orig_roll_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a994866d5a325bd2d2774c08e4d060347"><div class="ttname"><a href="classAC__AutoTune.html#a994866d5a325bd2d2774c08e4d060347">AC_AutoTune::axes_completed</a></div><div class="ttdeci">uint8_t axes_completed</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00268">AC_AutoTune.h:268</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a9b11a57e55ea5141b3f31809854676a6"><div class="ttname"><a href="classAC__AutoTune.html#a9b11a57e55ea5141b3f31809854676a6">AC_AutoTune::orig_yaw_rp</a></div><div class="ttdeci">float orig_yaw_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a9b17d44460e65cb949a055d6d28f3851"><div class="ttname"><a href="classAC__AutoTune.html#a9b17d44460e65cb949a055d6d28f3851">AC_AutoTune::orig_roll_fltt</a></div><div class="ttdeci">float orig_roll_fltt</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_a9dbe8768b1aa99113270e7fc2943a401"><div class="ttname"><a href="classAC__AutoTune.html#a9dbe8768b1aa99113270e7fc2943a401">AC_AutoTune::orig_pitch_smax</a></div><div class="ttdeci">float orig_pitch_smax</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aa1a6681ba5d15288419f8bc76b5874b3"><div class="ttname"><a href="classAC__AutoTune.html#aa1a6681ba5d15288419f8bc76b5874b3">AC_AutoTune::send_step_string</a></div><div class="ttdeci">void send_step_string()</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00124">AC_AutoTune.cpp:124</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aa1cd052c5cb238ddbbcc15aed6db652b"><div class="ttname"><a href="classAC__AutoTune.html#aa1cd052c5cb238ddbbcc15aed6db652b">AC_AutoTune::rotation_rate</a></div><div class="ttdeci">float rotation_rate</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00302">AC_AutoTune.h:302</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507"><div class="ttname"><a href="classAC__AutoTune.html#aa5c32c60057ac736a2116e7f8684b9dbae2612f5bc01ee62e78aa978ed85b6507">AC_AutoTune::UPDATE_GAINS</a></div><div class="ttdeci">@ UPDATE_GAINS</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00205">AC_AutoTune.h:204</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aa7f1eda48ae6e8ce3b894c384e2e7f3a"><div class="ttname"><a href="classAC__AutoTune.html#aa7f1eda48ae6e8ce3b894c384e2e7f3a">AC_AutoTune::get_poshold_attitude</a></div><div class="ttdeci">void get_poshold_attitude(float &amp;roll_cd, float &amp;pitch_cd, float &amp;yaw_cd)</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00680">AC_AutoTune.cpp:680</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aa8e14ea72d0fbf721a21654a83e9599f"><div class="ttname"><a href="classAC__AutoTune.html#aa8e14ea72d0fbf721a21654a83e9599f">AC_AutoTune::orig_yaw_rd</a></div><div class="ttdeci">float orig_yaw_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aac31382d3f54b7e834a35d3e0ea21a53"><div class="ttname"><a href="classAC__AutoTune.html#aac31382d3f54b7e834a35d3e0ea21a53">AC_AutoTune::orig_yaw_smax</a></div><div class="ttdeci">float orig_yaw_smax</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da1fd7bc95eb9f6650180368671ba6443a">AC_AutoTune::RP_UP</a></div><div class="ttdeci">@ RP_UP</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00211">AC_AutoTune.h:211</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411da6313fbbeb7a22078aa739527cb4bc838">AC_AutoTune::MAX_GAINS</a></div><div class="ttdeci">@ MAX_GAINS</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00215">AC_AutoTune.h:215</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab47d4f63982f7c38e21427823359023d">AC_AutoTune::SP_UP</a></div><div class="ttdeci">@ SP_UP</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00213">AC_AutoTune.h:213</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dab776b5695f742ef61b3998cf0fb13f4a">AC_AutoTune::TUNE_COMPLETE</a></div><div class="ttdeci">@ TUNE_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00218">AC_AutoTune.h:217</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dac8a1434828e1c1a15ff4a14890044477">AC_AutoTune::TUNE_CHECK</a></div><div class="ttdeci">@ TUNE_CHECK</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00216">AC_AutoTune.h:216</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dacb9e31f5aba964d224aaea303464b8fc">AC_AutoTune::RD_UP</a></div><div class="ttdeci">@ RD_UP</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00209">AC_AutoTune.h:209</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d"><div class="ttname"><a href="classAC__AutoTune.html#aaf4f1b50e186e300a000096291b7411dad8d996622d44cfa408d980d0a494676d">AC_AutoTune::RFF_UP</a></div><div class="ttdeci">@ RFF_UP</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00212">AC_AutoTune.h:212</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ab408486b00a60d5a6e6b952287c14a29"><div class="ttname"><a href="classAC__AutoTune.html#ab408486b00a60d5a6e6b952287c14a29">AC_AutoTune::axis_string</a></div><div class="ttdeci">const char * axis_string() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00172">AC_AutoTune.cpp:172</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ab695c7b326120716296658d1cdd5aa25"><div class="ttname"><a href="classAC__AutoTune.html#ab695c7b326120716296658d1cdd5aa25">AC_AutoTune::test_accel_max</a></div><div class="ttdeci">float test_accel_max</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00281">AC_AutoTune.h:281</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ab718371cbc44318f02d751a77fc80f94"><div class="ttname"><a href="classAC__AutoTune.html#ab718371cbc44318f02d751a77fc80f94">AC_AutoTune::yaw_enabled</a></div><div class="ttdeci">bool yaw_enabled() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00648">AC_AutoTune.cpp:648</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_abd3d037cb7c3b1886b6be864678babb8"><div class="ttname"><a href="classAC__AutoTune.html#abd3d037cb7c3b1886b6be864678babb8">AC_AutoTune::roll_cd</a></div><div class="ttdeci">float roll_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00303">AC_AutoTune.h:303</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_abe7597ab34dde279a85791ad4bddd1d8"><div class="ttname"><a href="classAC__AutoTune.html#abe7597ab34dde279a85791ad4bddd1d8">AC_AutoTune::pitch_cd</a></div><div class="ttdeci">float pitch_cd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00303">AC_AutoTune.h:303</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ac18f6f470a433dda4a961094aaf4c41f"><div class="ttname"><a href="classAC__AutoTune.html#ac18f6f470a433dda4a961094aaf4c41f">AC_AutoTune::orig_roll_accel</a></div><div class="ttdeci">float orig_roll_accel</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00289">AC_AutoTune.h:289</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ac6a5fd689affed239769db223c55ac2e"><div class="ttname"><a href="classAC__AutoTune.html#ac6a5fd689affed239769db223c55ac2e">AC_AutoTune::attitude_control</a></div><div class="ttdeci">AC_AttitudeControl * attitude_control</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00256">AC_AutoTune.h:256</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ad48110a5e9d484f0e88385a037e1bdf6"><div class="ttname"><a href="classAC__AutoTune.html#ad48110a5e9d484f0e88385a037e1bdf6">AC_AutoTune::orig_pitch_rp</a></div><div class="ttdeci">float orig_pitch_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ad4ad5bae7bd4f3f9aa7bd89fe131cd16"><div class="ttname"><a href="classAC__AutoTune.html#ad4ad5bae7bd4f3f9aa7bd89fe131cd16">AC_AutoTune::load_gains</a></div><div class="ttdeci">void load_gains(enum GainType gain_type)</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00590">AC_AutoTune.cpp:590</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ada98c5400d27e91f84476d328ef8536c"><div class="ttname"><a href="classAC__AutoTune.html#ada98c5400d27e91f84476d328ef8536c">AC_AutoTune::step</a></div><div class="ttdeci">StepType step</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00264">AC_AutoTune.h:264</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_adc211cea45fcba3d85cb88bfac224d25"><div class="ttname"><a href="classAC__AutoTune.html#adc211cea45fcba3d85cb88bfac224d25">AC_AutoTune::orig_yaw_sp</a></div><div class="ttdeci">float orig_yaw_sp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00291">AC_AutoTune.h:291</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ae0dfe44d3697ccbfc5e64c2e2032e040"><div class="ttname"><a href="classAC__AutoTune.html#ae0dfe44d3697ccbfc5e64c2e2032e040">AC_AutoTune::orig_pitch_rd</a></div><div class="ttdeci">float orig_pitch_rd</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00290">AC_AutoTune.h:290</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_ae4dfb85b61c456f1672228541b303b32"><div class="ttname"><a href="classAC__AutoTune.html#ae4dfb85b61c456f1672228541b303b32">AC_AutoTune::tune_pitch_rff</a></div><div class="ttdeci">float tune_pitch_rff</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00298">AC_AutoTune.h:298</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aeaaab37f266d952bc351de8366735449"><div class="ttname"><a href="classAC__AutoTune.html#aeaaab37f266d952bc351de8366735449">AC_AutoTune::step_time_limit_ms</a></div><div class="ttdeci">uint32_t step_time_limit_ms</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00274">AC_AutoTune.h:274</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aeceafc59aecb2c0e50765b136c3c2fd9"><div class="ttname"><a href="classAC__AutoTune.html#aeceafc59aecb2c0e50765b136c3c2fd9">AC_AutoTune::pitch_enabled</a></div><div class="ttdeci">bool pitch_enabled() const</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8cpp_source.html#l00643">AC_AutoTune.cpp:643</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aed413ce50ed93ea3017c0005e917e318"><div class="ttname"><a href="classAC__AutoTune.html#aed413ce50ed93ea3017c0005e917e318">AC_AutoTune::tune_pitch_rp</a></div><div class="ttdeci">float tune_pitch_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00296">AC_AutoTune.h:296</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_aeefb711cf2ec55cecbee0f0f05565c2d"><div class="ttname"><a href="classAC__AutoTune.html#aeefb711cf2ec55cecbee0f0f05565c2d">AC_AutoTune::tune_type</a></div><div class="ttdeci">TuneType tune_type</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00265">AC_AutoTune.h:265</a></div></div>
<div class="ttc" id="aclassAC__AutoTune_html_af3cf812a6ff791c518335748d740006e"><div class="ttname"><a href="classAC__AutoTune.html#af3cf812a6ff791c518335748d740006e">AC_AutoTune::tune_roll_rp</a></div><div class="ttdeci">float tune_roll_rp</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune_8h_source.html#l00295">AC_AutoTune.h:295</a></div></div>
<div class="ttc" id="aclassAC__PID_html_a307aaed51e687c98cd7f5fc676303eb8"><div class="ttname"><a href="classAC__PID.html#a307aaed51e687c98cd7f5fc676303eb8">AC_PID::kP</a></div><div class="ttdeci">const AP_Float &amp; kP() const</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00099">AC_PID.h:99</a></div></div>
<div class="ttc" id="aclassAC__PID_html_a79324d6af91b6fbe7d4203585d254bf3"><div class="ttname"><a href="classAC__PID.html#a79324d6af91b6fbe7d4203585d254bf3">AC_PID::get_p</a></div><div class="ttdeci">float get_p() const</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8cpp_source.html#l00329">AC_PID.cpp:329</a></div></div>
<div class="ttc" id="aclassAC__PID_html_a7b0d5e0bdffdaac1937cdcd651703035"><div class="ttname"><a href="classAC__PID.html#a7b0d5e0bdffdaac1937cdcd651703035">AC_PID::slew_limit</a></div><div class="ttdeci">AP_Float &amp; slew_limit()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00109">AC_PID.h:109</a></div></div>
<div class="ttc" id="aclassAC__PID_html_a8cb8a136be5506f38d92fd39c0936451"><div class="ttname"><a href="classAC__PID.html#a8cb8a136be5506f38d92fd39c0936451">AC_PID::ff</a></div><div class="ttdeci">AP_Float &amp; ff()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00105">AC_PID.h:105</a></div></div>
<div class="ttc" id="aclassAC__PID_html_aac6ff2f362aa6ab5c41343019342dc6f"><div class="ttname"><a href="classAC__PID.html#aac6ff2f362aa6ab5c41343019342dc6f">AC_PID::filt_E_hz</a></div><div class="ttdeci">AP_Float &amp; filt_E_hz()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00107">AC_PID.h:107</a></div></div>
<div class="ttc" id="aclassAC__PID_html_abb7ce07d4ca159d065184f793abf8edb"><div class="ttname"><a href="classAC__PID.html#abb7ce07d4ca159d065184f793abf8edb">AC_PID::kD</a></div><div class="ttdeci">AP_Float &amp; kD()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00102">AC_PID.h:102</a></div></div>
<div class="ttc" id="aclassAC__PID_html_ac0065460e0b0ed3600b60494f6c2a44b"><div class="ttname"><a href="classAC__PID.html#ac0065460e0b0ed3600b60494f6c2a44b">AC_PID::save_gains</a></div><div class="ttdeci">void save_gains()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8cpp_source.html#l00368">AC_PID.cpp:368</a></div></div>
<div class="ttc" id="aclassAC__PID_html_ad4c7d433c035e9488908a6e50c3576ae"><div class="ttname"><a href="classAC__PID.html#ad4c7d433c035e9488908a6e50c3576ae">AC_PID::kI</a></div><div class="ttdeci">AP_Float &amp; kI()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00101">AC_PID.h:101</a></div></div>
<div class="ttc" id="aclassAC__PID_html_ad78d03d125980bae0d247e9db48b7460"><div class="ttname"><a href="classAC__PID.html#ad78d03d125980bae0d247e9db48b7460">AC_PID::get_ff</a></div><div class="ttdeci">float get_ff() const</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8cpp_source.html#l00344">AC_PID.cpp:344</a></div></div>
<div class="ttc" id="aclassAC__PID_html_ae228ddd019e84a38ee580b1304d22783"><div class="ttname"><a href="classAC__PID.html#ae228ddd019e84a38ee580b1304d22783">AC_PID::filt_T_hz</a></div><div class="ttdeci">AP_Float &amp; filt_T_hz()</div><div class="ttdef"><b>Definition</b> <a href="AC__PID_8h_source.html#l00106">AC_PID.h:106</a></div></div>
<div class="ttc" id="aclassAC__P_html_a42d133adda51940f14079d1dfff7bafe"><div class="ttname"><a href="classAC__P.html#a42d133adda51940f14079d1dfff7bafe">AC_P::kP</a></div><div class="ttdeci">AP_Float &amp; kP()</div><div class="ttdef"><b>Definition</b> <a href="AC__P_8h_source.html#l00060">AC_P.h:60</a></div></div>
<div class="ttc" id="aclassAC__P_html_ac4b7fac705bba7deb0a0640cc9182003"><div class="ttname"><a href="classAC__P.html#ac4b7fac705bba7deb0a0640cc9182003">AC_P::save_gains</a></div><div class="ttdeci">void save_gains()</div><div class="ttdef"><b>Definition</b> <a href="AC__P_8cpp_source.html#l00025">AC_P.cpp:25</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a3f98bb641a87a41f52f532747ca7c9b5"><div class="ttname"><a href="classAP__AHRS__View.html#a3f98bb641a87a41f52f532747ca7c9b5">AP_AHRS_View::cos_yaw</a></div><div class="ttdeci">float cos_yaw</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00215">AP_AHRS_View.h:215</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a47c7e4e898ef2d9a238cca1d1112b4bd"><div class="ttname"><a href="classAP__AHRS__View.html#a47c7e4e898ef2d9a238cca1d1112b4bd">AP_AHRS_View::pitch_sensor</a></div><div class="ttdeci">int32_t pitch_sensor</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00185">AP_AHRS_View.h:185</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a5a9c4b692e49d388c53786e5e07f8511"><div class="ttname"><a href="classAP__AHRS__View.html#a5a9c4b692e49d388c53786e5e07f8511">AP_AHRS_View::roll_sensor</a></div><div class="ttdeci">int32_t roll_sensor</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00184">AP_AHRS_View.h:184</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a5cba0e970b7df616645025113e75ee41"><div class="ttname"><a href="classAP__AHRS__View.html#a5cba0e970b7df616645025113e75ee41">AP_AHRS_View::sin_yaw</a></div><div class="ttdeci">float sin_yaw</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00218">AP_AHRS_View.h:218</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a5e1e8d8f5e79b55e06043392cb6aa2de"><div class="ttname"><a href="classAP__AHRS__View.html#a5e1e8d8f5e79b55e06043392cb6aa2de">AP_AHRS_View::yaw_sensor</a></div><div class="ttdeci">int32_t yaw_sensor</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00186">AP_AHRS_View.h:186</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a71fba0fa37fe88f841b8f76379974809"><div class="ttname"><a href="classAP__AHRS__View.html#a71fba0fa37fe88f841b8f76379974809">AP_AHRS_View::get_velocity_NED</a></div><div class="ttdeci">bool get_velocity_NED(Vector3f &amp;vec) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00112">AP_AHRS_View.h:112</a></div></div>
<div class="ttc" id="aclassAP__AHRS__View_html_a8733f799a129c0bd015c4f72bc8a1ee8"><div class="ttname"><a href="classAP__AHRS__View.html#a8733f799a129c0bd015c4f72bc8a1ee8">AP_AHRS_View::get_gyro</a></div><div class="ttdeci">const Vector3f &amp; get_gyro(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__AHRS__View_8h_source.html#l00043">AP_AHRS_View.h:43</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_a320182e24dfaf50d436cf065c97169bb"><div class="ttname"><a href="classAP__Logger.html#a320182e24dfaf50d436cf065c97169bb">AP_Logger::Write</a></div><div class="ttdeci">void Write(const char *name, const char *labels, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l00974">AP_Logger.cpp:974</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_abab7cb26825a8dfb1e5e92cf7fcf4152"><div class="ttname"><a href="classAP__Logger.html#abab7cb26825a8dfb1e5e92cf7fcf4152">AP_Logger::WriteStreaming</a></div><div class="ttdeci">void WriteStreaming(const char *name, const char *labels, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l00992">AP_Logger.cpp:992</a></div></div>
<div class="ttc" id="aclassAP__Motors_html_a761e52f1a7a67a6d22cb581d6c08de08"><div class="ttname"><a href="classAP__Motors.html#a761e52f1a7a67a6d22cb581d6c08de08">AP_Motors::get_pitch</a></div><div class="ttdeci">float get_pitch() const</div><div class="ttdef"><b>Definition</b> <a href="AP__Motors__Class_8h_source.html#l00153">AP_Motors_Class.h:153</a></div></div>
<div class="ttc" id="aclassAP__Motors_html_a9386115b33c9fdb54505d66439963ab4"><div class="ttname"><a href="classAP__Motors.html#a9386115b33c9fdb54505d66439963ab4">AP_Motors::get_yaw</a></div><div class="ttdeci">float get_yaw() const</div><div class="ttdef"><b>Definition</b> <a href="AP__Motors__Class_8h_source.html#l00155">AP_Motors_Class.h:155</a></div></div>
<div class="ttc" id="aclassAP__Motors_html_a9d6fff42778f7a4337b549c76cedfd75"><div class="ttname"><a href="classAP__Motors.html#a9d6fff42778f7a4337b549c76cedfd75">AP_Motors::get_roll</a></div><div class="ttdeci">float get_roll() const</div><div class="ttdef"><b>Definition</b> <a href="AP__Motors__Class_8h_source.html#l00151">AP_Motors_Class.h:151</a></div></div>
<div class="ttc" id="aclassAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00010">main.cpp:10</a></div></div>
<div class="ttc" id="aclassAP__Scheduler_html_a82db30c491d6a4eb2a2c34750d7a1de5"><div class="ttname"><a href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">AP_Scheduler::get_loop_period_s</a></div><div class="ttdeci">float get_loop_period_s()</div><div class="ttdef"><b>Definition</b> <a href="AP__Scheduler_8h_source.html#l00155">AP_Scheduler.h:155</a></div></div>
<div class="ttc" id="aclassChirp_html_a02930ebd08b6a1563f337708cc2107cd"><div class="ttname"><a href="classChirp.html#a02930ebd08b6a1563f337708cc2107cd">Chirp::get_frequency_rads</a></div><div class="ttdeci">float get_frequency_rads()</div><div class="ttdef"><b>Definition</b> <a href="chirp_8h_source.html#l00017">chirp.h:17</a></div></div>
<div class="ttc" id="aclassChirp_html_a51eaed939817e2783633ba83a194a422"><div class="ttname"><a href="classChirp.html#a51eaed939817e2783633ba83a194a422">Chirp::update</a></div><div class="ttdeci">float update(float time, float waveform_magnitude)</div><div class="ttdef"><b>Definition</b> <a href="chirp_8cpp_source.html#l00054">chirp.cpp:54</a></div></div>
<div class="ttc" id="aclassChirp_html_af3fe76d250680ab3c5c89fdc604e2f16"><div class="ttname"><a href="classChirp.html#af3fe76d250680ab3c5c89fdc604e2f16">Chirp::init</a></div><div class="ttdeci">void init(float time_record, float frequency_start_hz, float frequency_stop_hz, float time_fade_in, float time_fade_out, float time_const_freq)</div><div class="ttdef"><b>Definition</b> <a href="chirp_8cpp_source.html#l00037">chirp.cpp:37</a></div></div>
<div class="ttc" id="aclassGCS_html_a2f099d18721b0874af08fde3f6aae6b6"><div class="ttname"><a href="classGCS.html#a2f099d18721b0874af08fde3f6aae6b6">GCS::send_text</a></div><div class="ttdeci">void send_text(MAV_SEVERITY severity, const char *fmt,...) FMT_PRINTF(3</div><div class="ttdef"><b>Definition</b> <a href="GCS_8cpp_source.html#l00080">GCS.cpp:80</a></div></div>
<div class="ttc" id="aclassLowPassFilter_html_a1cc5016de137b01080fa0a6fa7fe53cd"><div class="ttname"><a href="classLowPassFilter.html#a1cc5016de137b01080fa0a6fa7fe53cd">LowPassFilter::set_cutoff_frequency</a></div><div class="ttdeci">void set_cutoff_frequency(float cutoff_freq)</div><div class="ttdef"><b>Definition</b> <a href="LowPassFilter_8cpp_source.html#l00101">LowPassFilter.cpp:101</a></div></div>
<div class="ttc" id="aclassLowPassFilter_html_a34bc75aa770bc6cc0facee3b43a05bec"><div class="ttname"><a href="classLowPassFilter.html#a34bc75aa770bc6cc0facee3b43a05bec">LowPassFilter::get</a></div><div class="ttdeci">const T &amp; get() const</div><div class="ttdef"><b>Definition</b> <a href="LowPassFilter_8cpp_source.html#l00128">LowPassFilter.cpp:128</a></div></div>
<div class="ttc" id="aclassLowPassFilter_html_aa390849d2e18ff3287f92b89d8657841"><div class="ttname"><a href="classLowPassFilter.html#aa390849d2e18ff3287f92b89d8657841">LowPassFilter::apply</a></div><div class="ttdeci">T apply(T sample, float dt)</div><div class="ttdef"><b>Definition</b> <a href="LowPassFilter_8cpp_source.html#l00118">LowPassFilter.cpp:118</a></div></div>
<div class="ttc" id="aclassLowPassFilter_html_adad51ea3b156f167fff0fb586a912cb5"><div class="ttname"><a href="classLowPassFilter.html#adad51ea3b156f167fff0fb586a912cb5">LowPassFilter::reset</a></div><div class="ttdeci">void reset(T value)</div><div class="ttdef"><b>Definition</b> <a href="LowPassFilter_8cpp_source.html#l00133">LowPassFilter.cpp:133</a></div></div>
<div class="ttc" id="aclassVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="aclassVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00076">vector3.h:76</a></div></div>
<div class="ttc" id="aclassVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00076">vector3.h:76</a></div></div>
<div class="ttc" id="aclassVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00076">vector3.h:76</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4aa2c43b09c1300c334821f5507d6f71"><div class="ttname"><a href="definitions_8h.html#a4aa2c43b09c1300c334821f5507d6f71">M_2PI</a></div><div class="ttdeci">#define M_2PI</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00019">definitions.h:19</a></div></div>
<div class="ttc" id="adefinitions_8h_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00010">definitions.h:10</a></div></div>
<div class="ttc" id="amonocypher_8cpp_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8cpp_source.html#l00072">monocypher.cpp:72</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00377">system.cpp:377</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a7aa0ce7625c9680e30ff4a99940907a5"><div class="ttname"><a href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a></div><div class="ttdeci">uint64_t micros64()</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00387">system.cpp:387</a></div></div>
<div class="ttc" id="anamespaceAP_html_aa35bfac1ea2da16f110e8e72db7b3b20"><div class="ttname"><a href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a></div><div class="ttdeci">AP_Logger &amp; logger()</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l01740">AP_Logger.cpp:1740</a></div></div>
<div class="ttc" id="anamespaceAP_html_acdeafe5406efd2650ba54d24d3aecb7c"><div class="ttname"><a href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a></div><div class="ttdeci">AP_Scheduler &amp; scheduler()</div><div class="ttdef"><b>Definition</b> <a href="AP__Scheduler_8cpp_source.html#l00536">AP_Scheduler.cpp:536</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1max__gain__data_html"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1max__gain__data.html">AC_AutoTune_Heli::max_gain_data</a></div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00140">AC_AutoTune_Heli.h:140</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1max__gain__data_html_a2bccab984d51c08324af0e746777ffb7"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1max__gain__data.html#a2bccab984d51c08324af0e746777ffb7">AC_AutoTune_Heli::max_gain_data::freq</a></div><div class="ttdeci">float freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00141">AC_AutoTune_Heli.h:141</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1max__gain__data_html_a61d9b776b5ae056952876b353fbe0948"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1max__gain__data.html#a61d9b776b5ae056952876b353fbe0948">AC_AutoTune_Heli::max_gain_data::gain</a></div><div class="ttdeci">float gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00143">AC_AutoTune_Heli.h:143</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1max__gain__data_html_a8ba7d1071debf84aa62c22a2025b30d5"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1max__gain__data.html#a8ba7d1071debf84aa62c22a2025b30d5">AC_AutoTune_Heli::max_gain_data::phase</a></div><div class="ttdeci">float phase</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00142">AC_AutoTune_Heli.h:142</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1max__gain__data_html_aa08e3395a3465bb4d7cbd750bbdc8706"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1max__gain__data.html#aa08e3395a3465bb4d7cbd750bbdc8706">AC_AutoTune_Heli::max_gain_data::max_allowed</a></div><div class="ttdeci">float max_allowed</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00144">AC_AutoTune_Heli.h:144</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__data_html_a5262b184ca2313b8da3602fbe928fbee"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__data.html#a5262b184ca2313b8da3602fbe928fbee">AC_AutoTune_Heli::sweep_data::ph180</a></div><div class="ttdeci">sweep_info ph180</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00281">AC_AutoTune_Heli.h:281</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__data_html_a531df29170bff692a4dbb2fffd1e72d2"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__data.html#a531df29170bff692a4dbb2fffd1e72d2">AC_AutoTune_Heli::sweep_data::ph270</a></div><div class="ttdeci">sweep_info ph270</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00282">AC_AutoTune_Heli.h:282</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__data_html_a7643351a6ef86e4251d7054e9bac3cd9"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__data.html#a7643351a6ef86e4251d7054e9bac3cd9">AC_AutoTune_Heli::sweep_data::maxgain</a></div><div class="ttdeci">sweep_info maxgain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00280">AC_AutoTune_Heli.h:280</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__data_html_aff263592de6bdb2970108ec65aaee568"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__data.html#aff263592de6bdb2970108ec65aaee568">AC_AutoTune_Heli::sweep_data::progress</a></div><div class="ttdeci">uint8_t progress</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00284">AC_AutoTune_Heli.h:284</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__info_html_a156dc2c69827a76b2aa7b9a2f493a12c"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__info.html#a156dc2c69827a76b2aa7b9a2f493a12c">AC_AutoTune_Heli::sweep_info::phase</a></div><div class="ttdeci">float phase</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00245">AC_AutoTune_Heli.h:245</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__info_html_a643bf699d19fdb54983810130b7a74a9"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__info.html#a643bf699d19fdb54983810130b7a74a9">AC_AutoTune_Heli::sweep_info::freq</a></div><div class="ttdeci">float freq</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00243">AC_AutoTune_Heli.h:243</a></div></div>
<div class="ttc" id="astructAC__AutoTune__Heli_1_1sweep__info_html_ada2807bc147e5354d0d840746bf91d97"><div class="ttname"><a href="structAC__AutoTune__Heli_1_1sweep__info.html#ada2807bc147e5354d0d840746bf91d97">AC_AutoTune_Heli::sweep_info::gain</a></div><div class="ttdeci">float gain</div><div class="ttdef"><b>Definition</b> <a href="AC__AutoTune__Heli_8h_source.html#l00244">AC_AutoTune_Heli.h:244</a></div></div>
<div class="ttc" id="astructAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00199">AP_Param.h:199</a></div></div>
<div class="ttc" id="astructVector2_html"><div class="ttname"><a href="structVector2.html">Vector2&lt; float &gt;</a></div></div>
<div class="ttc" id="astructVector2_html_a6cfed8355591aa269f4dba43bd806ef9"><div class="ttname"><a href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">Vector2::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00044">vector2.h:44</a></div></div>
<div class="ttc" id="astructVector2_html_a78fa1f2ed5e261c7fbeb8f3536a1ee34"><div class="ttname"><a href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">Vector2::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00044">vector2.h:44</a></div></div>
<div class="ttc" id="avector2_8h_html_a9f3739462b0605dcb64299fa289b6afe"><div class="ttname"><a href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a></div><div class="ttdeci">Vector2&lt; float &gt; Vector2f</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00297">vector2.h:297</a></div></div>
<div class="ttc" id="avector3_8h_html_af345ad77ba5e240c7ab72b4b2077e754"><div class="ttname"><a href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a></div><div class="ttdeci">Vector3&lt; float &gt; Vector3f</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00412">vector3.h:412</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 22 2024 16:14:13 for APM:Libraries by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
