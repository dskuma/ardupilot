<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_GPS/AP_GPS.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_dc27bcd5d3e114c391ea7ea0e777b78e.html">AP_GPS</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AP_GPS.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="AP__GPS_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">   This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"></span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> */</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__config_8h.html">AP_GPS_config.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#if AP_GPS_ENABLED</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS_8h.html">AP_GPS.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Common_8h.html">AP_Common/AP_Common.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Math_8h.html">AP_Math/AP_Math.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Notify_8h.html">AP_Notify/AP_Notify.h</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="GCS_8h.html">GCS_MAVLink/GCS.h</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="AP__BoardConfig_8h.html">AP_BoardConfig/AP_BoardConfig.h</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="AP__RTC_8h.html">AP_RTC/AP_RTC.h</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;climits&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="code" href="AP__SerialManager_8h.html">AP_SerialManager/AP_SerialManager.h</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__NOVA_8h.html">AP_GPS_NOVA.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__ERB_8h.html">AP_GPS_ERB.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__GSOF_8h.html">AP_GPS_GSOF.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__NMEA_8h.html">AP_GPS_NMEA.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__SBF_8h.html">AP_GPS_SBF.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__SBP_8h.html">AP_GPS_SBP.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__SBP2_8h.html">AP_GPS_SBP2.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__SIRF_8h.html">AP_GPS_SIRF.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__UBLOX_8h.html">AP_GPS_UBLOX.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__MAV_8h.html">AP_GPS_MAV.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__MSP_8h.html">AP_GPS_MSP.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__ExternalAHRS_8h.html">AP_GPS_ExternalAHRS.h</a>&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="GPS__Backend_8h.html">GPS_Backend.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#if HAL_SIM_GPS_ENABLED</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__SITL_8h.html">AP_GPS_SITL.h</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#if HAL_ENABLE_DRONECAN_DRIVERS</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &lt;<a class="code" href="AP__CANManager_8h.html">AP_CANManager/AP_CANManager.h</a>&gt;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &lt;<a class="code" href="AP__DroneCAN_8h.html">AP_DroneCAN/AP_DroneCAN.h</a>&gt;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__DroneCAN_8h.html">AP_GPS_DroneCAN.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &lt;<a class="code" href="AP__AHRS_8h.html">AP_AHRS/AP_AHRS.h</a>&gt;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &lt;<a class="code" href="AP__Logger_8h.html">AP_Logger/AP_Logger.h</a>&gt;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="AP__GPS__FixType_8h.html">AP_GPS_FixType.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#if AP_GPS_RTCM_DECODE_ENABLED</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &quot;<a class="code" href="RTCM3__Parser_8h.html">RTCM3_Parser.h</a>&quot;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#af476b309d3827917a4217a393c7bb6ed">   62</a></span><span class="preprocessor">#define GPS_RTK_INJECT_TO_ALL 127</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#ifndef GPS_MAX_RATE_MS</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">   64</a></span><span class="preprocessor">#define GPS_MAX_RATE_MS 200 </span><span class="comment">// maximum value of rate_ms (i.e. slowest update rate) is 5hz or 200ms</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#a2f6d184a58b49c746340c1139bd6e0ea">   66</a></span><span class="preprocessor">#define GPS_BAUD_TIME_MS 1200</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#aed01677f1b1efe774fa22e838b84f5db">   67</a></span><span class="preprocessor">#define GPS_TIMEOUT_MS 4000u</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment">// defines used to specify the mask position for use of different accuracy metrics in the blending algorithm</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#af2a2b9d86200a37152ed36817f914ac7">   70</a></span><span class="preprocessor">#define BLEND_MASK_USE_HPOS_ACC     1</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#a5c474882dc169c97221822426d3d48ed">   71</a></span><span class="preprocessor">#define BLEND_MASK_USE_VPOS_ACC     2</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#af3476ae7cb8c401b7d55ab98b86ed292">   72</a></span><span class="preprocessor">#define BLEND_MASK_USE_SPD_ACC      4</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#a2f89c2cb9e2d16e7cebb42b9e313b05e">   73</a></span><span class="preprocessor">#define BLEND_COUNTER_FAILURE_INCREMENT 10</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="preprocessor">#ifndef HAL_GPS_COM_PORT_DEFAULT</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="AP__GPS_8cpp.html#a978c948cab76954876c053044ed16ab8">   76</a></span><span class="preprocessor">#define HAL_GPS_COM_PORT_DEFAULT 1</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_class" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a> &amp;<a class="code hl_variable" href="AP__GPS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment">// baudrates to try to detect GPSes with</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="keyword">const</span> uint32_t <a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">AP_GPS::_baudrates</a>[] = {9600U, 115200U, 4800U, 19200U, 38400U, 57600U, 230400U, 460800U};</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">// initialisation blobs to send to the GPS to try to get it into the</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="comment">// right mode.</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="classAP__GPS.html#a1b88be4642982ed39abefd25e9f38003">AP_GPS::_initialisation_blob</a>[] =</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="preprocessor">#if AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <a class="code hl_define" href="AP__GPS__UBLOX_8h.html#a6dcaff1e4e8070d32d636550027b847e">UBLOX_SET_BINARY_230400</a></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="preprocessor">#if AP_GPS_SIRF_ENABLED</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <a class="code hl_define" href="AP__GPS__SIRF_8h.html#a688aa025e0239993674de15fccc32285">SIRF_SET_BINARY</a></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="preprocessor">#if AP_GPS_NMEA_UNICORE_ENABLED</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <a class="code hl_define" href="AP__GPS__NMEA_8h.html#ac689e8f0a43a8356808dd84cf6e49405">NMEA_UNICORE_SETUP</a></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="stringliteral">&quot;&quot;</span>   <span class="comment">// to compile we need *some_initialiser if all backends compiled out</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    ;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="preprocessor">#if HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">// ensure that our GPS_Status enumeration is 1:1 with the mavlink</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">// numbers of the same fix type.  This allows us to do a simple cast</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment">// from one to the other when sending GPS mavlink messages, rather</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="comment">// than having some sort of mapping function from our internal</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="comment">// enumeration into the mavlink enumeration.  Doing things this way</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">// has two advantages - in the future we could add that mapping</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment">// function and change our enumeration, and the other is that it</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="comment">// allows us to build the GPS library without having the mavlink</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="comment">// headers built (for example, in AP_Periph we shouldn&#39;t need mavlink</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="comment">// headers).</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">AP_GPS::GPS_Status::NO_GPS</a> == (uint32_t)GPS_FIX_TYPE_NO_GPS, <span class="stringliteral">&quot;NO_GPS incorrect&quot;</span>);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">AP_GPS::GPS_Status::NO_FIX</a> == (uint32_t)GPS_FIX_TYPE_NO_FIX, <span class="stringliteral">&quot;NO_FIX incorrect&quot;</span>);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_Status::GPS_OK_FIX_2D</a> == (uint32_t)GPS_FIX_TYPE_2D_FIX, <span class="stringliteral">&quot;FIX_2D incorrect&quot;</span>);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">AP_GPS::GPS_Status::GPS_OK_FIX_3D</a> == (uint32_t)GPS_FIX_TYPE_3D_FIX, <span class="stringliteral">&quot;FIX_3D incorrect&quot;</span>);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca70ff28e0bee1ab6c0b129b76b9fa7fc0">AP_GPS::GPS_Status::GPS_OK_FIX_3D_DGPS</a> == (uint32_t)GPS_FIX_TYPE_DGPS, <span class="stringliteral">&quot;FIX_DGPS incorrect&quot;</span>);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcace8880546698f0209a3862137c76fd99">AP_GPS::GPS_Status::GPS_OK_FIX_3D_RTK_FLOAT</a> == (uint32_t)GPS_FIX_TYPE_RTK_FLOAT, <span class="stringliteral">&quot;FIX_RTK_FLOAT incorrect&quot;</span>);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcad9d2de41647dead30787d7b4f0c81539">AP_GPS::GPS_Status::GPS_OK_FIX_3D_RTK_FIXED</a> == (uint32_t)GPS_FIX_TYPE_RTK_FIXED, <span class="stringliteral">&quot;FIX_RTK_FIXED incorrect&quot;</span>);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="comment">// ensure that our own enum-class status is equivalent to the</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="comment">// ArduPilot-scoped AP_GPS_FixType enumeration:</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">AP_GPS::GPS_Status::NO_GPS</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea84a1c7916079717125c4cd668a592b2f">AP_GPS_FixType::NO_GPS</a>, <span class="stringliteral">&quot;NO_GPS incorrect&quot;</span>);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">AP_GPS::GPS_Status::NO_FIX</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eab50339a10e1de285ac99d4c3990b8693">AP_GPS_FixType::NONE</a>, <span class="stringliteral">&quot;NO_FIX incorrect&quot;</span>);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_Status::GPS_OK_FIX_2D</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea8b433e3f63d83e78dfbfe6da3ff61b3e">AP_GPS_FixType::FIX_2D</a>, <span class="stringliteral">&quot;FIX_2D incorrect&quot;</span>);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">AP_GPS::GPS_Status::GPS_OK_FIX_3D</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea5eddc8631075de75c679f84846de5d51">AP_GPS_FixType::FIX_3D</a>, <span class="stringliteral">&quot;FIX_3D incorrect&quot;</span>);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca70ff28e0bee1ab6c0b129b76b9fa7fc0">AP_GPS::GPS_Status::GPS_OK_FIX_3D_DGPS</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea30c7710c25275d763c683f6225669d61">AP_GPS_FixType::DGPS</a>, <span class="stringliteral">&quot;FIX_DGPS incorrect&quot;</span>);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcace8880546698f0209a3862137c76fd99">AP_GPS::GPS_Status::GPS_OK_FIX_3D_RTK_FLOAT</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eaa6cd12e20d6e5f57b84e8e4987d747de">AP_GPS_FixType::RTK_FLOAT</a>, <span class="stringliteral">&quot;FIX_RTK_FLOAT incorrect&quot;</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="keyword">static_assert</span>((uint32_t)<a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcad9d2de41647dead30787d7b4f0c81539">AP_GPS::GPS_Status::GPS_OK_FIX_3D_RTK_FIXED</a> == (uint8_t)<a class="code hl_enumvalue" href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eadfe0799953f0252fef00578e7e4c0122">AP_GPS_FixType::RTK_FIXED</a>, <span class="stringliteral">&quot;FIX_RTK_FIXED incorrect&quot;</span>);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><a class="code hl_class" href="classAP__GPS.html">AP_GPS</a> *<a class="code hl_variable" href="classAP__GPS.html#ab7d394dafbbd1d9c7d046aa195d49063">AP_GPS::_singleton</a>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="comment">// table of user settable parameters</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="keyword">const</span> <a class="code hl_struct" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code hl_variable" href="classAP__GPS.html#a58a05f48dce64267c71558d39b7917e9">AP_GPS::var_info</a>[] = {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="comment">// @Param: _TYPE</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="comment">// @DisplayName: 1st GPS type</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment">// @Description: GPS type of 1st GPS</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="comment">// @Values: 0:None,1:AUTO,2:uBlox,5:NMEA,6:SiRF,7:HIL,8:SwiftNav,9:DroneCAN,10:SBF,11:GSOF,13:ERB,14:MAV,15:NOVA,16:HemisphereNMEA,17:uBlox-MovingBaseline-Base,18:uBlox-MovingBaseline-Rover,19:MSP,20:AllyStar,21:ExternalAHRS,22:DroneCAN-MovingBaseline-Base,23:DroneCAN-MovingBaseline-Rover,24:UnicoreNMEA,25:UnicoreMovingBaselineNMEA,26:SBF-DualAntenna</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_TYPE&quot;</span>,    0, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _type[0], <a class="code hl_define" href="AP__HAL__Boards_8h.html#a3c0c1b7e4574fd0e968689e687c28dc3">HAL_GPS_TYPE_DEFAULT</a>),</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="comment">// @Param: _TYPE2</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="comment">// @CopyFieldsFrom: GPS_TYPE</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="comment">// @DisplayName: 2nd GPS type</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment">// @Description: GPS type of 2nd GPS</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_TYPE2&quot;</span>,   1, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _type[1], 0),</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="comment">// @Param: _NAVFILTER</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="comment">// @DisplayName: Navigation filter setting</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="comment">// @Description: Navigation filter engine setting</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="comment">// @Values: 0:Portable,2:Stationary,3:Pedestrian,4:Automotive,5:Sea,6:Airborne1G,7:Airborne2G,8:Airborne4G</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_NAVFILTER&quot;</span>, 2, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _navfilter, GPS_ENGINE_AIRBORNE_4G),</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="comment">// @Param: _AUTO_SWITCH</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="comment">// @DisplayName: Automatic Switchover Setting</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="comment">// @Description: Automatic switchover to GPS reporting best lock, 1:UseBest selects the GPS with highest status, if both are equal the GPS with highest satellite count is used 4:Use primary if 3D fix or better, will revert to &#39;UseBest&#39; behaviour if 3D fix is lost on primary</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="comment">// @Values: 0:Use primary, 1:UseBest, 2:Blend, 4:Use primary if 3D fix or better</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_AUTO_SWITCH&quot;</span>, 3, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _auto_switch, (int8_t)GPSAutoSwitch::USE_BEST),</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="comment">// 4 was _MIN_GPS, removed Feb 2024</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="comment">// @Param: _SBAS_MODE</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="comment">// @DisplayName: SBAS Mode</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="comment">// @Description: This sets the SBAS (satellite based augmentation system) mode if available on this GPS. If set to 2 then the SBAS mode is not changed in the GPS. Otherwise the GPS will be reconfigured to enable/disable SBAS. Disabling SBAS may be worthwhile in some parts of the world where an SBAS signal is available but the baseline is too long to be useful.</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="comment">// @Values: 0:Disabled,1:Enabled,2:NoChange</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_SBAS_MODE&quot;</span>, 5, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _sbas_mode, 2),</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="comment">// @Param: _MIN_ELEV</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <span class="comment">// @DisplayName: Minimum elevation</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="comment">// @Description: This sets the minimum elevation of satellites above the horizon for them to be used for navigation. Setting this to -100 leaves the minimum elevation set to the GPS modules default.</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="comment">// @Range: -100 90</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="comment">// @Units: deg</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_MIN_ELEV&quot;</span>, 6, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _min_elevation, -100),</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="comment">// @Param: _INJECT_TO</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="comment">// @DisplayName: Destination for GPS_INJECT_DATA MAVLink packets</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// @Description: The GGS can send raw serial packets to inject data to multiple GPSes.</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// @Values: 0:send to first GPS,1:send to 2nd GPS,127:send to all</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_INJECT_TO&quot;</span>,   7, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _inject_to, <a class="code hl_define" href="AP__GPS_8cpp.html#af476b309d3827917a4217a393c7bb6ed">GPS_RTK_INJECT_TO_ALL</a>),</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="preprocessor">#if AP_GPS_SBP2_ENABLED || AP_GPS_SBP_ENABLED</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="comment">// @Param: _SBP_LOGMASK</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="comment">// @DisplayName: Swift Binary Protocol Logging Mask</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="comment">// @Description: Masked with the SBP msg_type field to determine whether SBR1/SBR2 data is logged</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="comment">// @Values: 0:None (0x0000),-1:All (0xFFFF),-256:External only (0xFF00)</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_SBP_LOGMASK&quot;</span>, 8, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _sbp_logmask, -256),</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBP2_ENABLED || AP_GPS_SBP_ENABLED</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="comment">// @Param: _RAW_DATA</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="comment">// @DisplayName: Raw data logging</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">// @Description: Handles logging raw data; on uBlox chips that support raw data this will log RXM messages into logger; on Septentrio this will log on the equipment&#39;s SD card and when set to 2, the autopilot will try to stop logging after disarming and restart after arming</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="comment">// @Values: 0:Ignore,1:Always log,2:Stop logging when disarmed (SBF only),5:Only log every five samples (uBlox only)</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_RAW_DATA&quot;</span>, 9, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _raw_data, 0),</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="comment">// @Param: _GNSS_MODE</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="comment">// @DisplayName: GNSS system configuration</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="comment">// @Description: Bitmask for what GNSS system to use on the first GPS (all unchecked or zero to leave GPS as configured)</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="comment">// @Bitmask: 0:GPS,1:SBAS,2:Galileo,3:Beidou,4:IMES,5:QZSS,6:GLONASS</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_GNSS_MODE&quot;</span>, 10, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _gnss_mode[0], 0),</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="comment">// @Param: _SAVE_CFG</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="comment">// @DisplayName: Save GPS configuration</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    <span class="comment">// @Description: Determines whether the configuration for this GPS should be written to non-volatile memory on the GPS. Currently working for UBlox 6 series and above.</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="comment">// @Values: 0:Do not save config,1:Save config,2:Save only when needed</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_SAVE_CFG&quot;</span>, 11, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _save_config, 2),</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <span class="comment">// @Param: _GNSS_MODE2</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">// @DisplayName: GNSS system configuration</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="comment">// @Description: Bitmask for what GNSS system to use on the second GPS (all unchecked or zero to leave GPS as configured)</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="comment">// @Bitmask: 0:GPS,1:SBAS,2:Galileo,3:Beidou,4:IMES,5:QZSS,6:GLONASS</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_GNSS_MODE2&quot;</span>, 12, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _gnss_mode[1], 0),</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="comment">// @Param: _AUTO_CONFIG</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="comment">// @DisplayName: Automatic GPS configuration</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// @Description: Controls if the autopilot should automatically configure the GPS based on the parameters and default settings</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="comment">// @Values: 0:Disables automatic configuration,1:Enable automatic configuration for Serial GPSes only,2:Enable automatic configuration for DroneCAN as well</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_AUTO_CONFIG&quot;</span>, 13, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _auto_config, 1),</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="comment">// @Param: _RATE_MS</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="comment">// @DisplayName: GPS update rate in milliseconds</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="comment">// @Description: Controls how often the GPS should provide a position update. Lowering below 5Hz(default) is not allowed. Raising the rate above 5Hz usually provides little benefit and for some GPS (eg Ublox M9N) can severely impact performance.</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">// @Units: ms</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// @Values: 100:10Hz,125:8Hz,200:5Hz</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// @Range: 50 200</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_RATE_MS&quot;</span>, 14, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _rate_ms[0], 200),</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="comment">// @Param: _RATE_MS2</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="comment">// @DisplayName: GPS 2 update rate in milliseconds</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="comment">// @Description: Controls how often the GPS should provide a position update. Lowering below 5Hz(default) is not allowed. Raising the rate above 5Hz usually provides little benefit and for some GPS (eg Ublox M9N) can severely impact performance.</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <span class="comment">// @Units: ms</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="comment">// @Values: 100:10Hz,125:8Hz,200:5Hz</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="comment">// @Range: 50 200</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_RATE_MS2&quot;</span>, 15, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _rate_ms[1], 200),</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="comment">// @Param: _POS1_X</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="comment">// @DisplayName: Antenna X position offset</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="comment">// @Description: X position of the first GPS antenna in body frame. Positive X is forward of the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="comment">// @Param: _POS1_Y</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="comment">// @DisplayName: Antenna Y position offset</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="comment">// @Description: Y position of the first GPS antenna in body frame. Positive Y is to the right of the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="comment">// @Param: _POS1_Z</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="comment">// @DisplayName: Antenna Z position offset</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="comment">// @Description: Z position of the first GPS antenna in body frame. Positive Z is down from the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_POS1&quot;</span>, 16, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _antenna_offset[0], 0.0f),</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="comment">// @Param: _POS2_X</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="comment">// @DisplayName: Antenna X position offset</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="comment">// @Description: X position of the second GPS antenna in body frame. Positive X is forward of the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="comment">// @Param: _POS2_Y</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="comment">// @DisplayName: Antenna Y position offset</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <span class="comment">// @Description: Y position of the second GPS antenna in body frame. Positive Y is to the right of the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    <span class="comment">// @Param: _POS2_Z</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="comment">// @DisplayName: Antenna Z position offset</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="comment">// @Description: Z position of the second GPS antenna in body frame. Positive Z is down from the origin. Use antenna phase centroid location if provided by the manufacturer.</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="comment">// @Units: m</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    <span class="comment">// @Range: -5 5</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_POS2&quot;</span>, 17, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _antenna_offset[1], 0.0f),</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="comment">// @Param: _DELAY_MS</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="comment">// @DisplayName: GPS delay in milliseconds</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <span class="comment">// @Description: Controls the amount of GPS  measurement delay that the autopilot compensates for. Set to zero to use the default delay for the detected GPS type.</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="comment">// @Units: ms</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="comment">// @Range: 0 250</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_DELAY_MS&quot;</span>, 18, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _delay_ms[0], 0),</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="comment">// @Param: _DELAY_MS2</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <span class="comment">// @DisplayName: GPS 2 delay in milliseconds</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="comment">// @Description: Controls the amount of GPS  measurement delay that the autopilot compensates for. Set to zero to use the default delay for the detected GPS type.</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="comment">// @Units: ms</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="comment">// @Range: 0 250</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_DELAY_MS2&quot;</span>, 19, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _delay_ms[1], 0),</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="comment">// @Param: _BLEND_MASK</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="comment">// @DisplayName: Multi GPS Blending Mask</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="comment">// @Description: Determines which of the accuracy measures Horizontal position, Vertical Position and Speed are used to calculate the weighting on each GPS receiver when soft switching has been selected by setting GPS_AUTO_SWITCH to 2(Blend)</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="comment">// @Bitmask: 0:Horiz Pos,1:Vert Pos,2:Speed</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_BLEND_MASK&quot;</span>, 20, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _blend_mask, 5),</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="comment">// @Param: _BLEND_TC</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="comment">// @DisplayName: Blending time constant</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="comment">// @Description: Controls the slowest time constant applied to the calculation of GPS position and height offsets used to adjust different GPS receivers for steady state position differences.</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="comment">// @Units: s</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="comment">// @Range: 5.0 30.0</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="comment">// Had key 21, no longer used</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="comment">// @Param: _DRV_OPTIONS</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <span class="comment">// @DisplayName: driver options</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <span class="comment">// @Description: Additional backend specific options</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <span class="comment">// @Bitmask: 0:Use UART2 for moving baseline on ublox,1:Use base station for GPS yaw on SBF,2:Use baudrate 115200,3:Use dedicated CAN port b/w GPSes for moving baseline,4:Use ellipsoid height instead of AMSL, 5:Override GPS satellite health of L5 band from L1 health, 6:Enable RTCM full parse even for a single channel, 7:Disable automatic full RTCM parsing when RTCM seen on more than one channel</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_DRV_OPTIONS&quot;</span>, 22, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _driver_options, 0),</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="preprocessor">#if AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="comment">// @Param: _COM_PORT</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <span class="comment">// @DisplayName: GPS physical COM port</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="comment">// @Description: The physical COM port on the connected device, currently only applies to SBF and GSOF GPS</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="comment">// @Range: 0 10</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="comment">// @Values: 0:COM1(RS232) on GSOF, 1:COM2(TTL) on GSOF</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_COM_PORT&quot;</span>, 23, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _com_port[0], <a class="code hl_define" href="AP__GPS_8cpp.html#a978c948cab76954876c053044ed16ab8">HAL_GPS_COM_PORT_DEFAULT</a>),</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="comment">// @Param: _COM_PORT2</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="comment">// @DisplayName: GPS physical COM port</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="comment">// @Description: The physical COM port on the connected device, currently only applies to SBF and GSOF GPS</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="comment">// @Range: 0 10</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">// @RebootRequired: True</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_COM_PORT2&quot;</span>, 24, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _com_port[1], <a class="code hl_define" href="AP__GPS_8cpp.html#a978c948cab76954876c053044ed16ab8">HAL_GPS_COM_PORT_DEFAULT</a>),</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="preprocessor">#if GPS_MOVING_BASELINE</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// @Group: _MB1_</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="comment">// @Path: MovingBase.cpp</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <a class="code hl_define" href="AP__Param_8h.html#a16c360358c5d6a08d34f60921fd916a9">AP_SUBGROUPINFO</a>(mb_params[0], <span class="stringliteral">&quot;_MB1_&quot;</span>, 25, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, <a class="code hl_class" href="classMovingBase.html">MovingBase</a>),</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <span class="comment">// @Group: _MB2_</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">// @Path: MovingBase.cpp</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <a class="code hl_define" href="AP__Param_8h.html#a16c360358c5d6a08d34f60921fd916a9">AP_SUBGROUPINFO</a>(mb_params[1], <span class="stringliteral">&quot;_MB2_&quot;</span>, 26, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, <a class="code hl_class" href="classMovingBase.html">MovingBase</a>),</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="preprocessor">#endif </span><span class="comment">// GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="preprocessor">#endif </span><span class="comment">// GPS_MOVING_BASELINE</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="comment">// @Param: _PRIMARY</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="comment">// @DisplayName: Primary GPS</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="comment">// @Description: This GPS will be used when GPS_AUTO_SWITCH is 0 and used preferentially with GPS_AUTO_SWITCH = 4.</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="comment">// @Values: 0:FirstGPS, 1:SecondGPS</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_PRIMARY&quot;</span>, 27, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _primary, 0),</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span><span class="preprocessor">#if HAL_ENABLE_DRONECAN_DRIVERS</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="comment">// @Param: _CAN_NODEID1</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="comment">// @DisplayName: GPS Node ID 1</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="comment">// @Description: GPS Node id for first-discovered GPS.</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="comment">// @ReadOnly: True</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_CAN_NODEID1&quot;</span>, 28, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _node_id[0], 0),</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="comment">// @Param: _CAN_NODEID2</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="comment">// @DisplayName: GPS Node ID 2</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    <span class="comment">// @Description: GPS Node id for second-discovered GPS.</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <span class="comment">// @ReadOnly: True</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_CAN_NODEID2&quot;</span>, 29, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _node_id[1], 0),</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="preprocessor">#endif </span><span class="comment">// GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="comment">// @Param: 1_CAN_OVRIDE</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="comment">// @DisplayName: First DroneCAN GPS NODE ID</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <span class="comment">// @Description: GPS Node id for first GPS. If 0 the gps will be automatically selected on a first-come-first-GPS basis.</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;1_CAN_OVRIDE&quot;</span>, 30, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _override_node_id[0], 0),</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="comment">// @Param: 2_CAN_OVRIDE</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    <span class="comment">// @DisplayName: Second DroneCAN GPS NODE ID</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="comment">// @Description: GPS Node id for second GPS. If 0 the gps will be automatically selected on a second-come-second-GPS basis.</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <a class="code hl_define" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_CAN_OVRIDE&quot;</span>, 31, <a class="code hl_class" href="classAP__GPS.html">AP_GPS</a>, _override_node_id[1], 0),</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="preprocessor">#endif </span><span class="comment">// GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span><span class="preprocessor">#endif </span><span class="comment">// HAL_ENABLE_DRONECAN_DRIVERS</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <a class="code hl_define" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>};</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span><span class="comment">// constructor</span></div>
<div class="foldopen" id="foldopen00434" data-start="{" data-end="}">
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno"><a class="line" href="classAP__GPS.html#aa64e78056c0899273bae42ac4874b7e0">  434</a></span><a class="code hl_function" href="classAP__GPS.html#aa64e78056c0899273bae42ac4874b7e0">AP_GPS::AP_GPS</a>()</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>{</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keyword">static_assert</span>((<span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#a1b88be4642982ed39abefd25e9f38003">_initialisation_blob</a>) * (CHAR_BIT + 2)) &lt; (4800 * <a class="code hl_define" href="AP__GPS_8cpp.html#a2f6d184a58b49c746340c1139bd6e0ea">GPS_BAUD_TIME_MS</a> * 1e-3),</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                    <span class="stringliteral">&quot;GPS initilisation blob is too large to be completely sent before the baud rate changes&quot;</span>);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <a class="code hl_function" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, var_info);</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ab7d394dafbbd1d9c7d046aa195d49063">_singleton</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        <a class="code hl_function" href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a>(<span class="stringliteral">&quot;AP_GPS must be singleton&quot;</span>);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    }</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <a class="code hl_variable" href="classAP__GPS.html#ab7d394dafbbd1d9c7d046aa195d49063">_singleton</a> = <span class="keyword">this</span>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>}</div>
</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span> </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span><span class="comment">// return true if a specific type of GPS uses a UART</span></div>
<div class="foldopen" id="foldopen00448" data-start="{" data-end="}">
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno"><a class="line" href="classAP__GPS.html#abe62aaf611872626904a46572c6bbda3">  448</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#abe62aaf611872626904a46572c6bbda3">AP_GPS::needs_uart</a>(<a class="code hl_enumeration" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6">GPS_Type</a> <a class="code hl_struct" href="structtype.html">type</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="keywordflow">switch</span> (<a class="code hl_struct" href="structtype.html">type</a>) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>:</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a09943533b34b8f6a3981a11329270230">GPS_TYPE_HIL</a>:</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1">GPS_TYPE_UAVCAN</a>:</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a>:</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>:</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac02030cdc32f8c77fa5d3109f22ff324">GPS_TYPE_MAV</a>:</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9a591d38b406c75aa871f4632279b6ad">GPS_TYPE_MSP</a>:</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f">GPS_TYPE_EXTERNAL_AHRS</a>:</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>}</div>
</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="foldopen" id="foldopen00467" data-start="{" data-end="}">
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a2ce34a6bc4566e0ada53f4b6c94d4b85">  467</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a2ce34a6bc4566e0ada53f4b6c94d4b85">AP_GPS::init</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAP__SerialManager.html">AP_SerialManager</a>&amp; <a class="code hl_variable" href="AHRS__Test_8cpp.html#a90ddf96040cbf0429052dafd4fa64c12">serial_manager</a>)</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>{</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    <span class="comment">// Set new primary param based on old auto_switch use second option</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">_auto_switch</a>.get() == 3) &amp;&amp; !<a class="code hl_variable" href="classAP__GPS.html#a6eb39317fffbbb7f860cf2c54858aab9">_primary</a>.configured()) {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        <a class="code hl_variable" href="classAP__GPS.html#a6eb39317fffbbb7f860cf2c54858aab9">_primary</a>.set_and_save(1);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        <a class="code hl_variable" href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">_auto_switch</a>.set_and_save(0);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    }</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="comment">// search for serial ports with gps protocol</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    uint8_t uart_idx = 0;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#abe62aaf611872626904a46572c6bbda3">needs_uart</a>((<a class="code hl_enumeration" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6">GPS_Type</a>)<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i].get())) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[i] = <a class="code hl_variable" href="AHRS__Test_8cpp.html#a90ddf96040cbf0429052dafd4fa64c12">serial_manager</a>.<a class="code hl_function" href="classAP__SerialManager.html#a58cb32ebb77d9fc18e4756d0270d1970">find_serial</a>(<a class="code hl_enumvalue" href="classAP__SerialManager.html#af95280ba50704a8adece62755cb348e7a22d7bc8b55699d3423ceb94263ad982d">AP_SerialManager::SerialProtocol_GPS</a>, uart_idx);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            uart_idx++;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        }</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = 0;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="comment">// prep the state instance fields</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__GPS_8h.html#a3a734b4d4de7ca88c6563a5a476e3e87">GPS_MAX_INSTANCES</a>; i++) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a95606c520bd395452a6e171828a4988d">instance</a> = i;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    }</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="comment">// sanity check update rate</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">_rate_ms</a>[i] &lt;= 0 || <a class="code hl_variable" href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">_rate_ms</a>[i] &gt; <a class="code hl_define" href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">GPS_MAX_RATE_MS</a>) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            <a class="code hl_variable" href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">_rate_ms</a>[i].set(<a class="code hl_define" href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">GPS_MAX_RATE_MS</a>);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>}</div>
</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="comment">// return number of active GPS sensors. Note that if the first GPS</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="comment">// is not present but the 2nd is then we return 2. Note that a blended</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment">// GPS solution is treated as an additional sensor.</span></div>
<div class="foldopen" id="foldopen00501" data-start="{" data-end="}">
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a3d0a0e530c963bb5b7ffaf4eb74faef2">  501</a></span>uint8_t <a class="code hl_function" href="classAP__GPS.html#a3d0a0e530c963bb5b7ffaf4eb74faef2">AP_GPS::num_sensors</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a>) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>+1;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>}</div>
</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="foldopen" id="foldopen00511" data-start="{" data-end="}">
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">  511</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">AP_GPS::speed_accuracy</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;sacc)<span class="keyword"> const</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].have_speed_accuracy) {</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        sacc = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0845d4035e6cb36a9e1e31f4a68531f2">speed_accuracy</a>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    }</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>}</div>
</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="foldopen" id="foldopen00520" data-start="{" data-end="}">
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno"><a class="line" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">  520</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">AP_GPS::horizontal_accuracy</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;hacc)<span class="keyword"> const</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].have_horizontal_accuracy) {</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        hacc = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ad0ebe176090d273b59cad3e6d86fd416">horizontal_accuracy</a>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    }</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>}</div>
</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="foldopen" id="foldopen00529" data-start="{" data-end="}">
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno"><a class="line" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">  529</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">AP_GPS::vertical_accuracy</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;vacc)<span class="keyword"> const</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].have_vertical_accuracy) {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        vacc = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#af5066cda264f04cf812a5ffdb8248e46">vertical_accuracy</a>;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    }</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>}</div>
</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="foldopen" id="foldopen00538" data-start="{" data-end="}">
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ad2a61d6ab33c3f615359d230e8dcdbf5">  538</a></span><a class="code hl_enumeration" href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3">AP_GPS::CovarianceType</a> <a class="code hl_function" href="classAP__GPS.html#ad2a61d6ab33c3f615359d230e8dcdbf5">AP_GPS::position_covariance</a>(<span class="keyword">const</span> uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <a class="code hl_class" href="classMatrix3.html">Matrix3f</a>&amp; cov)<span class="keyword"> const</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <a class="code hl_enumeration" href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3">AP_GPS::CovarianceType</a> cov_type = <a class="code hl_enumvalue" href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3a696b031073e74bf2cb98e5ef201d4aa3">AP_GPS::CovarianceType::UNKNOWN</a>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    cov.<a class="code hl_function" href="classMatrix3.html#ab87bcaae9950ee1d72ab7075f5a397af">zero</a>();</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    <span class="keywordtype">float</span> hacc, vacc;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, hacc) &amp;&amp; <a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, vacc))</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        cov_type = <a class="code hl_enumvalue" href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3aa63a4f0acef4f8fe6bf4fda391a2fb98">AP_GPS::CovarianceType::DIAGONAL_KNOWN</a>;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keyword">const</span> <span class="keyword">auto</span> hacc_variance = hacc * hacc;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        cov[0][0] = hacc_variance;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        cov[1][1] = hacc_variance;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        cov[2][2] = vacc * vacc;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    <span class="comment">// There may be a receiver that implements hdop+vdop but not accuracy</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <span class="comment">// If so, there could be a condition here to attempt to calculate it</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keywordflow">return</span> cov_type;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>}</div>
</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="foldopen" id="foldopen00561" data-start="{" data-end="}">
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">  561</a></span>uint64_t <a class="code hl_function" href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">AP_GPS::istate_time_to_epoch_ms</a>(uint16_t gps_week, uint32_t gps_ms)</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>{</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    uint64_t fix_time_ms = <a class="code hl_define" href="AP__GPS_8h.html#ac159cf063a7c67cf309fa8939df8f727">UNIX_OFFSET_MSEC</a> + gps_week * <a class="code hl_define" href="definitions_8h.html#a7643e40a680579fe07946b46a153d8d0">AP_MSEC_PER_WEEK</a> + gps_ms;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="keywordflow">return</span> fix_time_ms;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>}</div>
</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="foldopen" id="foldopen00570" data-start="{" data-end="}">
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ad5311f0750e62e87bc2bb666024028f6">  570</a></span>uint64_t <a class="code hl_function" href="classAP__GPS.html#a13771e63e584a3bca073142b10316c05">AP_GPS::time_epoch_usec</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structAP__GPS_1_1GPS__State.html">GPS_State</a> &amp;istate = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <span class="keywordflow">if</span> ((istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a> == 0 &amp;&amp; istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7851b94e56941a453a5751cc59b420be">last_corrected_gps_time_us</a> == 0) || istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a> == 0) {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    }</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    uint64_t fix_time_ms;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="comment">// add in the time since the last fix message</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="keywordflow">if</span> (istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7851b94e56941a453a5751cc59b420be">last_corrected_gps_time_us</a> != 0) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        fix_time_ms = <a class="code hl_function" href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">istate_time_to_epoch_ms</a>(istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>, <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ab893b66bbadab6b590a0590e8a7cb878">get_last_itow_ms</a>());</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        <span class="keywordflow">return</span> (fix_time_ms*1000ULL) + (<a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>() - istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7851b94e56941a453a5751cc59b420be">last_corrected_gps_time_us</a>);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        fix_time_ms = <a class="code hl_function" href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">istate_time_to_epoch_ms</a>(istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>, istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">time_week_ms</a>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <span class="keywordflow">return</span> (fix_time_ms + (<a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>() - istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a>)) * 1000ULL;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    }</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>}</div>
</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="foldopen" id="foldopen00590" data-start="{" data-end="}">
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a138bc706890b5b799ddc3c48e653e78d">  590</a></span>uint64_t <a class="code hl_function" href="classAP__GPS.html#a0a502425e4595848f264607483c4e1a4">AP_GPS::last_message_epoch_usec</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structAP__GPS_1_1GPS__State.html">GPS_State</a> &amp;istate = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keywordflow">if</span> (istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a> == 0) {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    }</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">istate_time_to_epoch_ms</a>(istate.<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>, <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ab893b66bbadab6b590a0590e8a7cb878">get_last_itow_ms</a>()) * 1000ULL;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>}</div>
</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span><span class="comment">/*</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span><span class="comment">  send some more initialisation string bytes if there is room in the</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span><span class="comment">  UART transmit buffer</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00603" data-start="{" data-end="}">
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a90b25b2edbb127b22e597a56f2a01e42">  603</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">AP_GPS::send_blob_start</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *_blob, uint16_t size)</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>{</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].blob = _blob;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].remaining = size;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>}</div>
</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span><span class="comment">/*</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span><span class="comment">  initialise state for sending binary blob initialisation strings.  We</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span><span class="comment">  may choose different blobs not just based on type but also based on</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span><span class="comment">  parameters.</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00614" data-start="{" data-end="}">
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">  614</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">AP_GPS::send_blob_start</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>{</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="preprocessor">#if AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afb53d6f3afb17c9ce056c2ce4dbfad79">GPS_TYPE_UBLOX</a> &amp;&amp; <a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca445f9c1d140e715f5fe931c2648b621a">DriverOptions::UBX_Use115200</a>)) {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>[] = <a class="code hl_define" href="AP__GPS__UBLOX_8h.html#a4fd0964100b1185ec9b0b36adc4418cf">UBLOX_SET_BINARY_115200</a>;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">send_blob_start</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>));</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    }</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="preprocessor">#endif </span><span class="comment">// AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="preprocessor">#if GPS_MOVING_BASELINE &amp;&amp; AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a> ||</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>         <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) &amp;&amp;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        !<a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3cabc0aa22f695604e6ee5a23890ed541c0">DriverOptions::UBX_MBUseUart2</a>)) {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        <span class="comment">// we use 460800 when doing moving baseline as we need</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <span class="comment">// more bandwidth. We don&#39;t do this if using UART2, as</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        <span class="comment">// in that case the RTCMv3 data doesn&#39;t go over the</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        <span class="comment">// link to the flight controller</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>[] = <a class="code hl_define" href="AP__GPS__UBLOX_8h.html#a88b3bc83453a82dceca74f68efa8bdf0">UBLOX_SET_BINARY_460800</a>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>        <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">send_blob_start</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>));</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="comment">// the following devices don&#39;t have init blobs:</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    uint32_t blob_size = 0;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span><span class="preprocessor">#if AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a18e7fef3055b02873f12983bd9c8b350">GPS_TYPE_SBF</a>:</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a99a7d3598332932a553a6e03d0a86b24">GPS_TYPE_SBF_DUAL_ANTENNA</a>:</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span><span class="preprocessor">#if AP_GPS_GSOF_ENABLED</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a76a222d514c32a4bc7cb319b4572bb41">GPS_TYPE_GSOF</a>:</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_GSOF_ENABLED</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span><span class="preprocessor">#if AP_GPS_NOVA_ENABLED</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a77521927cbe6149568d69e29b685fbcf">GPS_TYPE_NOVA</a>:</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_NOVA_ENABLED</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="preprocessor">#if HAL_SIM_GPS_ENABLED</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    <span class="keywordflow">case</span> GPS_TYPE_SITL:</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="preprocessor">#endif  </span><span class="comment">// HAL_SIM_GPS_ENABLED</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        <span class="comment">// none of these GPSs have initialisation blobs</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        <span class="comment">// send combined initialisation blob, on the assumption that the</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <span class="comment">// GPS units will parse what they need and ignore the data they</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="comment">// don&#39;t understand:</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a> = <a class="code hl_variable" href="classAP__GPS.html#a1b88be4642982ed39abefd25e9f38003">_initialisation_blob</a>;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        blob_size = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#a1b88be4642982ed39abefd25e9f38003">_initialisation_blob</a>);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    }</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">send_blob_start</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>, blob_size);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>}</div>
</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="comment">/*</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">  send some more initialisation string bytes if there is room in the</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">  UART transmit buffer</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00673" data-start="{" data-end="}">
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ad4512e4952aa41566d6afb110e0fd6a1">  673</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#ad4512e4952aa41566d6afb110e0fd6a1">AP_GPS::send_blob_update</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>{</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    <span class="comment">// exit immediately if no uart for this instance</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    }</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span> </div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="classAP__GPS.html#a88ffa0ff28e2c65d11c8b1ced2c43760">remaining</a> == 0) {</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <span class="comment">// see if we can write some more of the initialisation blob</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <span class="keyword">const</span> uint16_t n = <a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;txspace(),</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                           <a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="classAP__GPS.html#a88ffa0ff28e2c65d11c8b1ced2c43760">remaining</a>);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> written = <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__HAL_1_1UARTDriver.html#af9f67918783d70fbbce1db64228af9da">write</a>((<span class="keyword">const</span> uint8_t*)<a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">blob</a>, n);</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].blob += written;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>    <a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].remaining -= written;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>}</div>
</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="comment">/*</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span><span class="comment">  run detection step for one GPS instance. If this finds a GPS then it</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span><span class="comment">  will fill in drivers[instance] and change state[instance].status</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span><span class="comment">  from NO_GPS to NO_FIX.</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00697" data-start="{" data-end="}">
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a4bdd5c70ed358b4147a58c7d09f040dd">  697</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a4bdd5c70ed358b4147a58c7d09f040dd">AP_GPS::detect_instance</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>{</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <span class="keyword">const</span> uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">NO_GPS</a>;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span> </div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    <a class="code hl_class" href="classAP__GPS__Backend.html">AP_GPS_Backend</a> *new_gps = <a class="code hl_function" href="classAP__GPS.html#aaf84a5f2a3629a01d2e00c8a07f91865">_detect_instance</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <span class="keywordflow">if</span> (new_gps == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    }</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">NO_FIX</a>;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = new_gps;</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = now;</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a> = <a class="code hl_define" href="AP__GPS_8cpp.html#aed01677f1b1efe774fa22e838b84f5db">GPS_TIMEOUT_MS</a>;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    new_gps-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a3b19a929f00d465fd3aca9c0ae1fcaa7">broadcast_gps_type</a>();</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>}</div>
</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span><span class="comment">/*</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span><span class="comment">  run detection step for one GPS instance. If this finds a GPS then it</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span><span class="comment">  will return it - otherwise nullptr</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00722" data-start="{" data-end="}">
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno"><a class="line" href="classAP__GPS.html#aaf84a5f2a3629a01d2e00c8a07f91865">  722</a></span><a class="code hl_class" href="classAP__GPS__Backend.html">AP_GPS_Backend</a> *<a class="code hl_function" href="classAP__GPS.html#aaf84a5f2a3629a01d2e00c8a07f91865">AP_GPS::_detect_instance</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>{</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structAP__GPS_1_1detect__state.html">detect_state</a> *dstate = &amp;<a class="code hl_struct" href="structAP__GPS_1_1detect__state.html">detect_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]) {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="comment">// user has to explicitly set the MAV type, do not use AUTO</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>    <span class="comment">// do not try to detect the MAV type, assume it&#39;s there</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac02030cdc32f8c77fa5d3109f22ff324">GPS_TYPE_MAV</a>:</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span><span class="preprocessor">#if AP_GPS_MAV_ENABLED</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">false</span>; <span class="comment">// specified, not detected</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a7bcfc49c7498cdd19ee51552d7edf506">AP_GPS_MAV</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_MAV_ENABLED</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    <span class="comment">// user has to explicitly set the UAVCAN type, do not use AUTO</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1">GPS_TYPE_UAVCAN</a>:</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a>:</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>:</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="preprocessor">#if AP_GPS_DRONECAN_ENABLED</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">false</span>; <span class="comment">// specified, not detected</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>        <span class="keywordflow">return</span> AP_GPS_DroneCAN::probe(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// We don&#39;t do anything here if UAVCAN is not supported</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="preprocessor">#if HAL_MSP_GPS_ENABLED</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9a591d38b406c75aa871f4632279b6ad">GPS_TYPE_MSP</a>:</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">false</span>; <span class="comment">// specified, not detected</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a465c5b4ba4f09c2d72440ac78d594d78">AP_GPS_MSP</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="preprocessor">#if HAL_EXTERNAL_AHRS_ENABLED</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f">GPS_TYPE_EXTERNAL_AHRS</a>:</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">false</span>; <span class="comment">// specified, not detected</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a12fd0a2da4293937493788aca7a55de6">AP_GPS_ExternalAHRS</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="preprocessor">#if AP_GPS_GSOF_ENABLED</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a76a222d514c32a4bc7cb319b4572bb41">GPS_TYPE_GSOF</a>:</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">false</span>; <span class="comment">// specified, not detected</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#ab56525924639ff734a805b7bce10f5eb">AP_GPS_GSOF</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_GSOF_ENABLED</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    }</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span> </div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        <span class="comment">// UART not available</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    }</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="comment">// all remaining drivers automatically cycle through baud rates to detect</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <span class="comment">// the correct baud rate, and should have the selected baud broadcast</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">auto_detected_baud</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="keyword">const</span> uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    <span class="keywordflow">if</span> (now - dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a3a88e9dbec6da9c65c26f0167b7151ff">last_baud_change_ms</a> &gt; <a class="code hl_define" href="AP__GPS_8cpp.html#a2f6d184a58b49c746340c1139bd6e0ea">GPS_BAUD_TIME_MS</a>) {</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>        <span class="comment">// try the next baud rate</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>        <span class="comment">// incrementing like this will skip the first element in array of bauds</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>        <span class="comment">// this is okay, and relied upon</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        <span class="keywordflow">if</span> (dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a5aa5ded13853ea117f411b58975927fb">probe_baud</a> == 0) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>            dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a5aa5ded13853ea117f411b58975927fb">probe_baud</a> = <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__HAL_1_1UARTDriver.html#a06338cb016977302e7e4ff64d7f57ea1">get_baud_rate</a>();</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>++;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            <span class="keywordflow">if</span> (dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a> == <a class="code hl_define" href="AP__Common_8h.html#a121caf32c5b5d704ef3453f0885a9ea5">ARRAY_SIZE</a>(<a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>)) {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>                dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a> = 0;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            }</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a5aa5ded13853ea117f411b58975927fb">probe_baud</a> = <a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>[dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>];</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        }</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        uint16_t rx_size=0, tx_size=0;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) {</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            tx_size = 2048;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        }</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) {</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            rx_size = 2048;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        }</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__HAL_1_1UARTDriver.html#a1ea1968a3238d1abb9d4880d1b679af4">begin</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a5aa5ded13853ea117f411b58975927fb">probe_baud</a>, rx_size, tx_size);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>        <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__HAL_1_1UARTDriver.html#ae831a0d75f4760267d444c522e1271a1">set_flow_control</a>(<a class="code hl_enumvalue" href="classAP__HAL_1_1UARTDriver.html#acd5e319d580fe14755931d37b5d4deafa67a3cf106c9c7c7d6e454a7a9610a7d8">AP_HAL::UARTDriver::FLOW_CONTROL_DISABLE</a>);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a3a88e9dbec6da9c65c26f0167b7151ff">last_baud_change_ms</a> = now;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a4570c56a31686eb4fd74eaee91a00052">_auto_config</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#abbd67f2b9539b783cc40c5eb18f57077a5232e4bd27c0b0d1c2d8c9f9a72cbc35">GPS_AUTO_CONFIG_ENABLE_SERIAL_ONLY</a>) {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            <a class="code hl_function" href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">send_blob_start</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a4570c56a31686eb4fd74eaee91a00052">_auto_config</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#abbd67f2b9539b783cc40c5eb18f57077a5232e4bd27c0b0d1c2d8c9f9a72cbc35">GPS_AUTO_CONFIG_ENABLE_SERIAL_ONLY</a>) {</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        <a class="code hl_function" href="classAP__GPS.html#ad4512e4952aa41566d6afb110e0fd6a1">send_blob_update</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    }</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]) {</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="preprocessor">#if AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <span class="comment">// by default the sbf/trimble gps outputs no data on its port, until configured.</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a18e7fef3055b02873f12983bd9c8b350">GPS_TYPE_SBF</a>:</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a99a7d3598332932a553a6e03d0a86b24">GPS_TYPE_SBF_DUAL_ANTENNA</a>:</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a7c57cd937a1702a32ea63dc30f271d5b">AP_GPS_SBF</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBF_ENABLED</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="preprocessor">#if AP_GPS_NOVA_ENABLED</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a77521927cbe6149568d69e29b685fbcf">GPS_TYPE_NOVA</a>:</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#acb11fb039b919cc571307c0c6c265d7a">AP_GPS_NOVA</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_NOVA_ENABLED</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span><span class="preprocessor">#if HAL_SIM_GPS_ENABLED</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    <span class="keywordflow">case</span> GPS_TYPE_SITL:</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> AP_GPS_SITL(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span><span class="preprocessor">#endif  </span><span class="comment">// HAL_SIM_GPS_ENABLED</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    }</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span> </div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">initblob_state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="classAP__GPS.html#a88ffa0ff28e2c65d11c8b1ced2c43760">remaining</a> != 0) {</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>        <span class="comment">// don&#39;t run detection engines if we haven&#39;t sent out the initblobs</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    }</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    uint16_t bytecount = <a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(8192U, <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;available());</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    <span class="keywordflow">while</span> (bytecount-- &gt; 0) {</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <span class="keyword">const</span> uint8_t data = <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__HAL_1_1UARTDriver.html#aad865126c7f40e0a3f66c37a4c708422">read</a>();</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>        (void)data;  <span class="comment">// if all backends are compiled out then &quot;data&quot; is unused</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span> </div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span><span class="preprocessor">#if AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a> ||</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>             <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afb53d6f3afb17c9ce056c2ce4dbfad79">GPS_TYPE_UBLOX</a>) &amp;&amp;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            ((!<a class="code hl_variable" href="classAP__GPS.html#a4570c56a31686eb4fd74eaee91a00052">_auto_config</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>[dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>] &gt;= 38400) ||</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>             (<a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>[dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>] &gt;= 115200 &amp;&amp; <a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca445f9c1d140e715f5fe931c2648b621a">DriverOptions::UBX_Use115200</a>)) ||</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>             <a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>[dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>] == 230400) &amp;&amp;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>            <a class="code hl_function" href="classAP__GPS__UBLOX.html#abd6e355abac6f9d1914591b92298395b">AP_GPS_UBLOX::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a1f091c7a044d04d64919d7aadedf1495">ublox_detect_state</a>, data)) {</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a46e5d33707cf47859f90bbbdc1bdbfc7">AP_GPS_UBLOX</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_enumvalue" href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872af8309024d71439c3287810437cb1957a">GPS_ROLE_NORMAL</a>);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        }</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span> </div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>        <span class="keyword">const</span> uint32_t ublox_mb_required_baud = <a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3cabc0aa22f695604e6ee5a23890ed541c0">DriverOptions::UBX_MBUseUart2</a>)?230400:460800;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a> ||</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>             <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) &amp;&amp;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>            <a class="code hl_variable" href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">_baudrates</a>[dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">current_baud</a>] == ublox_mb_required_baud &amp;&amp;</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>            <a class="code hl_function" href="classAP__GPS__UBLOX.html#abd6e355abac6f9d1914591b92298395b">AP_GPS_UBLOX::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a1f091c7a044d04d64919d7aadedf1495">ublox_detect_state</a>, data)) {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>            <a class="code hl_enumeration" href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872">GPS_Role</a> role;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) {</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>                role = <a class="code hl_enumvalue" href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872ae8c20be64a1ba0c14cc5502bd73a8398">GPS_ROLE_MB_BASE</a>;</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>                role = <a class="code hl_enumvalue" href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872a673a642e61b261538e20b21e3dc16bac">GPS_ROLE_MB_ROVER</a>;</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a46e5d33707cf47859f90bbbdc1bdbfc7">AP_GPS_UBLOX</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], role);</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        }</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span><span class="preprocessor">#endif  </span><span class="comment">// AP_GPS_UBLOX_ENABLED</span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span><span class="preprocessor">#if AP_GPS_SBP2_ENABLED</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a> || <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a755a5b90129ac93c5b947fd0430252aa">GPS_TYPE_SBP</a>) &amp;&amp;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>                 <a class="code hl_function" href="classAP__GPS__SBP2.html#aa7c133a66a1d1b717fced68f92dcec14">AP_GPS_SBP2::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#aff6604d92bd10a17ca5fad75f48780d6">sbp2_detect_state</a>, data)) {</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a345149947e2742dfde06a095e40e5a9c">AP_GPS_SBP2</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        }</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBP2_ENABLED</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span><span class="preprocessor">#if AP_GPS_SBP_ENABLED</span></div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a> || <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a755a5b90129ac93c5b947fd0430252aa">GPS_TYPE_SBP</a>) &amp;&amp;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>                 <a class="code hl_function" href="classAP__GPS__SBP.html#ae1ae391d424ba0cc24b0b8b70a263bcc">AP_GPS_SBP::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a2e80a2a45e99a54129c084a0db6ec6e6">sbp_detect_state</a>, data)) {</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#ab61a817d51c7c3a3f1ae0dc36982b437">AP_GPS_SBP</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>        }</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_SBP_ENABLED</span></div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span><span class="preprocessor">#if AP_GPS_SIRF_ENABLED</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a> || <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a1f0ab654d6f0fbe978f0f35438c04734">GPS_TYPE_SIRF</a>) &amp;&amp;</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>                 <a class="code hl_function" href="classAP__GPS__SIRF.html#a99c1e4f27c9077aaadead6cc6ad031a0">AP_GPS_SIRF::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a77c207fe0e20e8a532332e3feefe5e1a">sirf_detect_state</a>, data)) {</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a42591c1b4bded833142990e8757c9f24">AP_GPS_SIRF</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>        }</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span><span class="preprocessor">#if AP_GPS_ERB_ENABLED</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a> || <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9df7e102648dfe6247fc3390099c8e26">GPS_TYPE_ERB</a>) &amp;&amp;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                 <a class="code hl_function" href="classAP__GPS__ERB.html#a4ddd7b585ea06578c407d19d6d3964c5">AP_GPS_ERB::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#a886f135417cf30f4c95540af6e8c90ab">erb_detect_state</a>, data)) {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a43a8bf081e4d4415aa9bf6a273bcd0b6">AP_GPS_ERB</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span><span class="preprocessor">#endif </span><span class="comment">// AP_GPS_ERB_ENABLED</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span><span class="preprocessor">#if AP_GPS_NMEA_ENABLED</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ae7f79347a000fb1cf52a29057a14c77d">GPS_TYPE_NMEA</a> ||</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aa1216166deed216b7c367a3699b5aaf4">GPS_TYPE_HEMI</a> ||</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>#<span class="keywordflow">if</span> <a class="code hl_define" href="AP__GPS__config_8h.html#ab9a9b49ce4f235d8c34a4fb7366b9681">AP_GPS_NMEA_UNICORE_ENABLED</a></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a7de5228d3f6ae69c3d7df069fac0317d">GPS_TYPE_UNICORE_NMEA</a> ||</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a4dad9018fe431987a8ed18081bcc92a3">GPS_TYPE_UNICORE_MOVINGBASE_NMEA</a> ||</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>#endif</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a10288fb5254e0a5262cacc161cd70426">GPS_TYPE_ALLYSTAR</a>) &amp;&amp;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>                   <a class="code hl_function" href="classAP__GPS__NMEA.html#a14edc53eb3e6907cba8b59832c69fd33">AP_GPS_NMEA::_detect</a>(dstate-&gt;<a class="code hl_variable" href="structAP__GPS_1_1detect__state.html#ade0e499bceae920fe4d93ad1f9040776">nmea_detect_state</a>, data)) {</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_friend" href="classAP__GPS.html#a292dd764eb38dab205786a85e8ee7203">AP_GPS_NMEA</a>(*<span class="keyword">this</span>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_variable" href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">_port</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]);</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>        }</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span><span class="preprocessor">#endif </span><span class="comment">//AP_GPS_NMEA_ENABLED</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    }</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span> </div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>}</div>
</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span> </div>
<div class="foldopen" id="foldopen00903" data-start="{" data-end="}">
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a12625bc53d5bcca1e07ce2c8e7ac20d6">  903</a></span><a class="code hl_enumeration" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fc">AP_GPS::GPS_Status</a> <a class="code hl_function" href="classAP__GPS.html#a12625bc53d5bcca1e07ce2c8e7ac20d6">AP_GPS::highest_supported_status</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a8c5b16c4ac289e283effa184eb9df9c8">highest_supported_status</a>();</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    }</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">AP_GPS::GPS_OK_FIX_3D</a>;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>}</div>
</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span> </div>
<div class="foldopen" id="foldopen00911" data-start="{" data-end="}">
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a8d10f943cb245f20b1dc5f8e727f52eb">  911</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a8d10f943cb245f20b1dc5f8e727f52eb">AP_GPS::should_log</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    <a class="code hl_class" href="classAP__Logger.html">AP_Logger</a> *<a class="code hl_variable" href="ReplayGyroFFT_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a> = <a class="code hl_function" href="classAP__Logger.html#aa95af9746c4b60e8386f2eb9569404eb">AP_Logger::get_singleton</a>();</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ReplayGyroFFT_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    }</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ace74b654aa086c9acccf62b71a58d5e8">_log_gps_bit</a> == (uint32_t)-1) {</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    }</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ReplayGyroFFT_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a>-&gt;<a class="code hl_function" href="classAP__Logger.html#a8bed25359bc401b7d00def25bd8173b9">should_log</a>(<a class="code hl_variable" href="classAP__GPS.html#ace74b654aa086c9acccf62b71a58d5e8">_log_gps_bit</a>)) {</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>    }</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>}</div>
</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span><span class="comment">/*</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span><span class="comment">  update one GPS instance. This should be called at 10Hz or greater</span></div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00934" data-start="{" data-end="}">
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a83302e8b52e5d01ae67375b3542eb460">  934</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a83302e8b52e5d01ae67375b3542eb460">AP_GPS::update_instance</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>{</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a09943533b34b8f6a3981a11329270230">GPS_TYPE_HIL</a>) {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        <span class="comment">// in HIL, leave info alone</span></div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    }</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <span class="comment">// not enabled</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">NO_GPS</a>;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    }</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#af5f34786e914886cbfe9f47cfcf2220d">locked_ports</a> &amp; (1U&lt;&lt;<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)) {</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>        <span class="comment">// the port is locked by another driver</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    }</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span> </div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <span class="comment">// we don&#39;t yet know the GPS type of this one, or it has timed</span></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <span class="comment">// out and needs to be re-initialised</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <a class="code hl_function" href="classAP__GPS.html#a4bdd5c70ed358b4147a58c7d09f040dd">detect_instance</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>    }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a4570c56a31686eb4fd74eaee91a00052">_auto_config</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#abbd67f2b9539b783cc40c5eb18f57077a5232e4bd27c0b0d1c2d8c9f9a72cbc35">GPS_AUTO_CONFIG_ENABLE_SERIAL_ONLY</a>) {</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        <a class="code hl_function" href="classAP__GPS.html#ad4512e4952aa41566d6afb110e0fd6a1">send_blob_update</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    }</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <span class="comment">// we have an active driver for this instance</span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a> = <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a4da5fd4a69edd3a0a393e74cc0ca391a">read</a>();</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    uint32_t tnow = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span> </div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>    <span class="comment">// if we did not get a message, and the idle timer of 2 seconds</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    <span class="comment">// has expired, re-initialise the GPS. This will cause GPS</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="comment">// detection to run again</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    <span class="keywordtype">bool</span> data_should_be_logged = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a>) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <span class="keywordflow">if</span> (tnow - <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_function" href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">last_message_time_ms</a> &gt; <a class="code hl_define" href="AP__GPS_8cpp.html#aed01677f1b1efe774fa22e838b84f5db">GPS_TIMEOUT_MS</a>) {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            memset((<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]));</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a95606c520bd395452a6e171828a4988d">instance</a> = <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>            <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = tnow;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>            <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a> = <a class="code hl_define" href="AP__GPS_8cpp.html#aed01677f1b1efe774fa22e838b84f5db">GPS_TIMEOUT_MS</a>;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>            <span class="comment">// do not try to detect again if type is MAV or UAVCAN</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac02030cdc32f8c77fa5d3109f22ff324">GPS_TYPE_MAV</a> ||</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>                <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1">GPS_TYPE_UAVCAN</a> ||</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>                <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a> ||</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>                <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>) {</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>                <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">NO_FIX</a>;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>                <span class="comment">// free the driver before we run the next detection, so we</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>                <span class="comment">// don&#39;t end up with two allocated at any time</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>                <span class="keyword">delete</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>                <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>                <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">NO_GPS</a>;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>            }</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>            <span class="comment">// log this data as a &quot;flag&quot; that the GPS is no longer</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>            <span class="comment">// valid (see PR#8144)</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            data_should_be_logged = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        }</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].corrected_timestamp_updated) {</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>            <span class="comment">// set the timestamp for this messages based on</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <span class="comment">// set_uart_timestamp() or per specific transport in backend</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            <span class="comment">// , if available</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            tnow = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7851b94e56941a453a5751cc59b420be">last_corrected_gps_time_us</a>/1000U;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3dfbd43611c9719ae957eae9729368f6">corrected_timestamp_updated</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        }</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span> </div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>        <span class="comment">// announce the GPS type once</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].announced_detection) {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a744761e30a6ec7415ad8a9851088356a">announced_detection</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;GPS %d: detected %s&quot;</span>, <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> + 1, <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_variable" href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>());</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>        }</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span> </div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>        <span class="comment">// delta will only be correct after parsing two messages</span></div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a> = tnow - <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>        <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = tnow;</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>        <span class="comment">// if GPS disabled for flight testing then don&#39;t update fix timing value</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">GPS_OK_FIX_2D</a> &amp;&amp; !<a class="code hl_variable" href="classAP__GPS.html#a211bad61144989f47cbb56ddd1f41c16">_force_disable_gps</a>) {</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>            <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">last_fix_time_ms</a> = tnow;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>        }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>        data_should_be_logged = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    }</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) {</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <span class="comment">// see if a moving baseline base has some RTCMv3 data</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>        <span class="comment">// which we need to pass along to the rover</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        <span class="keyword">const</span> uint8_t *rtcm_data;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>        uint16_t rtcm_len;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS.html#a98763c63e4862b42f60a0926c3177413">get_RTCMV3</a>(rtcm_data, rtcm_len)) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>                <span class="keywordflow">if</span> (i != <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) {</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>                    <span class="comment">// pass the data to the rover</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>                    <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(i, rtcm_data, rtcm_len);</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>                    <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ad818b3808dd04d4135b5c1ee96194878">clear_RTCMV3</a>();</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>                }</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>            }</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        }</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    <span class="keywordflow">if</span> (data_should_be_logged) {</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>        <span class="comment">// keep count of delayed frames and average frame delay for health reporting</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>        <span class="keyword">const</span> uint16_t gps_max_delta_ms = 245; <span class="comment">// 200 ms (5Hz) + 45 ms buffer</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <a class="code hl_struct" href="structAP__GPS_1_1GPS__timing.html">GPS_timing</a> &amp;t = <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span> </div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        <span class="keywordflow">if</span> (t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a> &gt; gps_max_delta_ms) {</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>            t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a893a04a484a2624e09cfd01c2338ff90">delayed_count</a>++;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>            t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a893a04a484a2624e09cfd01c2338ff90">delayed_count</a> = 0;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        }</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="keywordflow">if</span> (t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a> &lt; 2000) {</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>            <span class="keywordflow">if</span> (t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">average_delta_ms</a> &lt;= 0) {</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>                t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">average_delta_ms</a> = t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a>;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>                t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">average_delta_ms</a> = 0.98f * t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">average_delta_ms</a> + 0.02f * t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">delta_time_ms</a>;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>            }</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        }</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    }</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span> </div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (data_should_be_logged &amp;&amp; <a class="code hl_function" href="classAP__GPS.html#a8d10f943cb245f20b1dc5f8e727f52eb">should_log</a>()) {</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>        <a class="code hl_function" href="classAP__GPS.html#a22210502424345970c0ca3291d5d1aa1">Write_GPS</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>    }</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    (void)data_should_be_logged;</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span> </div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="preprocessor">#if AP_RTC_ENABLED</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>) {</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        <span class="keyword">const</span> uint64_t now = <a class="code hl_function" href="classAP__GPS.html#a13771e63e584a3bca073142b10316c05">time_epoch_usec</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        <span class="keywordflow">if</span> (now != 0) {</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>            <a class="code hl_function" href="namespaceAP.html#ac357c38b6638140c5510e6ba566b998b">AP::rtc</a>().<a class="code hl_function" href="classAP__RTC.html#abb961ded9907a2dbaa1b20de2b3b5ce0">set_utc_usec</a>(now, <a class="code hl_enumvalue" href="classAP__RTC.html#af5ed0a2bd918379395e227179c7d6af3a9529f9ffd3c21a3d934042b6976a4a93">AP_RTC::SOURCE_GPS</a>);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>        }</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    }</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>}</div>
</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span><span class="preprocessor">#if GPS_MOVING_BASELINE</span></div>
<div class="foldopen" id="foldopen01080" data-start="{" data-end="}">
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a45bb96a7470d3c2d002ac947bd611cfc"> 1080</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a45bb96a7470d3c2d002ac947bd611cfc">AP_GPS::get_RelPosHeading</a>(uint32_t &amp;<a class="code hl_variable" href="ardupilot__SITL__QUAD_8h.html#a2c17dfa2b3239f2312e94b9de57a7999">timestamp</a>, <span class="keywordtype">float</span> &amp;relPosHeading, <span class="keywordtype">float</span> &amp;relPosLength, <span class="keywordtype">float</span> &amp;relPosD, <span class="keywordtype">float</span> &amp;accHeading)</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>{</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] &amp;&amp;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].relposheading_ts != 0 &amp;&amp;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>            <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>() - <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].relposheading_ts &lt; 500) {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>           relPosHeading = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ad5da0cd4dc4d4a46f92b058cdba8be7d">relPosHeading</a>;</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>           relPosLength = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0ec3d5a49ae66a95c9df97cf868f12b3">relPosLength</a>;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>           relPosD = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a46627bb4a8f81a77af9c7da0a9c1c582">relPosD</a>;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>           accHeading = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#af76863211da7706eee2bbc0dce24cfa9">accHeading</a>;</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>           <a class="code hl_variable" href="ardupilot__SITL__QUAD_8h.html#a2c17dfa2b3239f2312e94b9de57a7999">timestamp</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a80453cce8d6080023cebccdbd506a304">relposheading_ts</a>;</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>        }</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    }</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>}</div>
</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span> </div>
<div class="foldopen" id="foldopen01095" data-start="{" data-end="}">
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a98763c63e4862b42f60a0926c3177413"> 1095</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a98763c63e4862b42f60a0926c3177413">AP_GPS::get_RTCMV3</a>(<span class="keyword">const</span> uint8_t *&amp;bytes, uint16_t &amp;len)</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>{</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) {</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ab005555424a4402c8fa70453250aeb94">get_RTCMV3</a>(bytes, len);</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>        }</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    }</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>}</div>
</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span> </div>
<div class="foldopen" id="foldopen01105" data-start="{" data-end="}">
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ab6d599f921fc0e7d66221f379de044f6"> 1105</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#ab6d599f921fc0e7d66221f379de044f6">AP_GPS::clear_RTCMV3</a>()</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>{</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) {</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>            <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ad818b3808dd04d4135b5c1ee96194878">clear_RTCMV3</a>();</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>        }</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>    }</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>}</div>
</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span> </div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span><span class="comment">/*</span></div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="comment">    inject Moving Baseline Data messages.</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen01117" data-start="{" data-end="}">
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a20b3824173929aaffa4eba5943e4bf0b"> 1117</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a20b3824173929aaffa4eba5943e4bf0b">AP_GPS::inject_MBL_data</a>(uint8_t* data, uint16_t length)</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>{</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) {</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>            <span class="comment">// pass the data to the rover</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>            <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(i, data, length);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>        }</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    }</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>}</div>
</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span><span class="preprocessor">#endif </span><span class="comment">//#if GPS_MOVING_BASELINE</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span><span class="comment">/*</span></div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span><span class="comment">  update all GPS instances</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen01132" data-start="{" data-end="}">
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"><a class="line" href="classAP__GPS.html#afe04427a47ab5e630cb979815abd911e"> 1132</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#afe04427a47ab5e630cb979815abd911e">AP_GPS::update</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>{</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    <a class="code hl_define" href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a>(<a class="code hl_variable" href="classAP__GPS.html#a9431a0dd8acdad90322126e69ad53877">rsem</a>);</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span> </div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>        <a class="code hl_function" href="classAP__GPS.html#a83302e8b52e5d01ae67375b3542eb460">update_instance</a>(i);</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    }</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span> </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    <span class="comment">// calculate number of instances</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>            <a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a> = i+1;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>        }</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    }</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span> </div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    <span class="keyword">const</span> uint8_t old_primary = <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <a class="code hl_function" href="classAP__GPS.html#a351afca5ea59de076f93b611c1c9df90">update_primary</a>();</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> != old_primary) {</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#acc819f09dd35b615500c4dec658519d2">Write_Event</a>(<a class="code hl_enumvalue" href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981a6a80c86862bba23d6fbeda62ac6825a4">LogEvent::GPS_PRIMARY_CHANGED</a>);</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>    }</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span><span class="preprocessor">#endif  </span><span class="comment">// HAL_LOGING_ENABLED</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span><span class="preprocessor">#endif  </span><span class="comment">// GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span> </div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span><span class="preprocessor">#ifndef HAL_BUILD_AP_PERIPH</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>    <span class="comment">// update notify with gps status. We always base this on the primary_instance</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>    <a class="code hl_variable" href="classAP__Notify.html#a724dd074a094de26e17c72c38ac499e9">AP_Notify::flags</a>.<a class="code hl_variable" href="structAP__Notify_1_1notify__flags__and__values__type.html#a804d7278d01f92ef395c3f36e464d5a8">gps_status</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a>;</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>    <a class="code hl_variable" href="classAP__Notify.html#a724dd074a094de26e17c72c38ac499e9">AP_Notify::flags</a>.<a class="code hl_variable" href="structAP__Notify_1_1notify__flags__and__values__type.html#a6bc8e854e9a06270cd01c3b126d07575">gps_num_sats</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a>;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>}</div>
</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span> </div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span><span class="comment">/*</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span><span class="comment">  update primary GPS instance</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span><span class="comment"> */</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="foldopen" id="foldopen01170" data-start="{" data-end="}">
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a351afca5ea59de076f93b611c1c9df90"> 1170</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a351afca5ea59de076f93b611c1c9df90">AP_GPS::update_primary</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>{</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span><span class="comment">      if blending is requested, attempt to calculate weighting for</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span><span class="comment">      each GPS</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span><span class="comment">      we do not do blending if using moving baseline yaw as the rover is</span></div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span><span class="comment">      significant lagged and gives no more information on position or</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span><span class="comment">      velocity</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span><span class="comment">    */</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> using_moving_base = (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[0] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a> ||</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>                                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[0] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a> ||</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>                                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a> ||</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>                                    <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>);</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    <span class="keywordflow">if</span> ((<a class="code hl_enumeration" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5">GPSAutoSwitch</a>)<a class="code hl_variable" href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">_auto_switch</a>.get() == <a class="code hl_enumvalue" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5af58072a9536aaeef0196115e445fa4d8">GPSAutoSwitch::BLEND</a> &amp;&amp; !using_moving_base) {</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>        <a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a> = <a class="code hl_function" href="classAP__GPS.html#ad6736a9d4cbb5352caf3d76e4928a356">calc_blend_weights</a>();</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>        <span class="comment">// adjust blend health counter</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a>) {</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>            <a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a> = <a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a>+<a class="code hl_define" href="AP__GPS_8cpp.html#a2f89c2cb9e2d16e7cebb42b9e313b05e">BLEND_COUNTER_FAILURE_INCREMENT</a>, 100);</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a> &gt; 0) {</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>            <a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a>--;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        }</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        <span class="comment">// stop blending if unhealthy</span></div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a> &gt;= 50) {</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>            <a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>        }</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        <a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a> = 0;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>    }</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span> </div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">_output_is_blended</a>) {</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        <span class="comment">// Use the weighting to calculate blended GPS states</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        <a class="code hl_function" href="classAP__GPS.html#a86e388032563bbd72cca1bce9ec24d17">calc_blended_state</a>();</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        <span class="comment">// set primary to the virtual instance</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>        <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    }</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="preprocessor">#endif </span><span class="comment">// defined (GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span> </div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    <span class="comment">// check the primary param is set to possible GPS</span></div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    int8_t primary_param = <a class="code hl_variable" href="classAP__GPS.html#a6eb39317fffbbb7f860cf2c54858aab9">_primary</a>.get();</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>    <span class="keywordflow">if</span> ((primary_param &lt; 0) || (primary_param&gt;=<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>)) {</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        primary_param = 0;</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    }</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="comment">// if primary is not enabled try first instance</span></div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#a0101b0a077933c5bcbb15a6d63a03d07">get_type</a>(primary_param) == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        primary_param = 0;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    }</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span> </div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <span class="keywordflow">if</span> ((<a class="code hl_enumeration" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5">GPSAutoSwitch</a>)<a class="code hl_variable" href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">_auto_switch</a>.get() == <a class="code hl_enumvalue" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5ab50339a10e1de285ac99d4c3990b8693">GPSAutoSwitch::NONE</a>) {</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>        <span class="comment">// No switching of GPSs, always use the primary instance</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>        <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = primary_param;</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    }</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span> </div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    uint32_t now = <a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    <span class="comment">// special handling of RTK moving baseline pair. Always use the</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    <span class="comment">// base as the rover position is derived from the base, which</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    <span class="comment">// means the rover always has worse position and velocity than the</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    <span class="comment">// base. This overrides the normal logic which would select the</span></div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    <span class="comment">// rover as it typically is in fix type 6 (RTK) whereas base is</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>    <span class="comment">// usually fix type 3</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>        <span class="keywordflow">if</span> (((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a>)) &amp;&amp;</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>            ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i^1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i^1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>)) &amp;&amp;</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>            ((<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>) || (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i^1].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a>))) {</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> != i) {</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>                <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = now;</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>                <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = i;</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>            }</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>            <span class="comment">// don&#39;t do any more switching logic. We don&#39;t want the</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>            <span class="comment">// RTK status of the rover to cause a switch</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>        }</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>    }</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span> </div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="comment">// handling switching away from blended GPS</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> == <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>) {</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>        <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = 0;</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>        <span class="keywordflow">for</span> (uint8_t i=1; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>            <span class="comment">// choose GPS with highest state or higher number of</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>            <span class="comment">// satellites. Reject a GPS with an old update time, as it</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>            <span class="comment">// may be the old timestamp that triggered the loss of</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>            <span class="comment">// blending</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>            <span class="keyword">const</span> uint32_t delay_threshold = 400;</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> higher_status = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a>;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> old_data_primary = (now - <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a>) &gt; delay_threshold;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> old_data = (now - <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a>) &gt; delay_threshold;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> equal_status = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> == <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> more_sats = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a>;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>            <span class="keywordflow">if</span> (old_data &amp;&amp; !old_data_primary) {</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>                <span class="comment">// don&#39;t switch to a GPS that has not updated in 400ms</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>            }</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &lt; <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>) {</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>                <span class="comment">// don&#39;t use a GPS without 3D fix</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            }</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>            <span class="comment">// select the new GPS if the primary has old data, or new</span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>            <span class="comment">// GPS either has higher status, or has the same status</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            <span class="comment">// and more satellites</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>            <span class="keywordflow">if</span> ((old_data_primary &amp;&amp; !old_data) ||</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                higher_status ||</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                (equal_status &amp;&amp; more_sats)) {</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = i;</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>            }</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        }</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = now;</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    }</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span><span class="preprocessor">#endif  </span><span class="comment">// defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span> </div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    <span class="comment">// Use primary if 3D fix or better</span></div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    <span class="keywordflow">if</span> (((<a class="code hl_enumeration" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5">GPSAutoSwitch</a>)<a class="code hl_variable" href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">_auto_switch</a>.get() == <a class="code hl_enumvalue" href="classAP__GPS.html#a634333ea407907ab706da51055907aa5adfc873ece0afbab4bff0a668ba669a81">GPSAutoSwitch::USE_PRIMARY_IF_3D_FIX</a>) &amp;&amp; (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[primary_param].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>)) {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>        <span class="comment">// Primary GPS has a least a 3D fix, switch to it if necessary</span></div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> != primary_param) {</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>            <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = primary_param;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>            <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = now;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>        }</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    }</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span> </div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="comment">// handle switch between real GPSs</span></div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <span class="keywordflow">if</span> (i == <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>) {</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        }</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a>) {</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>            <span class="comment">// we have a higher status lock, or primary is set to the blended GPS, change GPS</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>            <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = i;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>            <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = now;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>        }</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span> </div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>        <span class="keywordtype">bool</span> another_gps_has_1_or_more_sats = (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> &gt;= <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> + 1);</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span> </div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> == <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &amp;&amp; another_gps_has_1_or_more_sats) {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>            <span class="keywordtype">bool</span> another_gps_has_2_or_more_sats = (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> &gt;= <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> + 2);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span> </div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>            <span class="keywordflow">if</span> ((another_gps_has_1_or_more_sats &amp;&amp; (now - <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a>) &gt;= 20000) ||</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>                (another_gps_has_2_or_more_sats &amp;&amp; (now - <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a>) &gt;= 5000)) {</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>                <span class="comment">// this GPS has more satellites than the</span></div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>                <span class="comment">// current primary, switch primary. Once we switch we will</span></div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>                <span class="comment">// then tend to stick to the new GPS as primary. We don&#39;t</span></div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>                <span class="comment">// want to switch too often as it will look like a</span></div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>                <span class="comment">// position shift to the controllers.</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>                <a class="code hl_variable" href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">primary_instance</a> = i;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>                <a class="code hl_variable" href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">_last_instance_swap_ms</a> = now;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>            }</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>        }</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>    }</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>}</div>
</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span><span class="preprocessor">#endif  </span><span class="comment">// GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span><span class="preprocessor">#if HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a99547c334b79105e677635048e8bd4b7">AP_GPS::handle_gps_inject</a>(<span class="keyword">const</span> mavlink_message_t &amp;msg)</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>{</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>    mavlink_gps_inject_data_t packet;</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>    mavlink_msg_gps_inject_data_decode(&amp;msg, &amp;packet);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span> </div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <span class="keywordflow">if</span> (packet.len &gt; <span class="keyword">sizeof</span>(packet.data)) {</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>        <span class="comment">// invalid packet</span></div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>    }</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span> </div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    <a class="code hl_function" href="classAP__GPS.html#a629018b7be7107c6b6a1a590873a93f0">handle_gps_rtcm_fragment</a>(0, packet.data, packet.len);</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>}</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span> </div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span><span class="comment">/*</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span><span class="comment">  pass along a mavlink message (for MAV type)</span></div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span><span class="comment"> */</span></div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a51331fa30a3661fd1c576bac4c9c834c">AP_GPS::handle_msg</a>(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, <span class="keyword">const</span> mavlink_message_t &amp;msg)</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>{</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>    <span class="keywordflow">switch</span> (msg.msgid) {</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>    <span class="keywordflow">case</span> MAVLINK_MSG_ID_GPS_RTCM_DATA:</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>        <span class="comment">// pass data to de-fragmenter</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>        <a class="code hl_function" href="classAP__GPS.html#a26a409b50f1bbf539088095d4eb78092">handle_gps_rtcm_data</a>(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, msg);</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>    <span class="keywordflow">case</span> MAVLINK_MSG_ID_GPS_INJECT_DATA:</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>        <a class="code hl_function" href="classAP__GPS.html#a99547c334b79105e677635048e8bd4b7">handle_gps_inject</a>(msg);</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>    <span class="keywordflow">default</span>: {</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>        uint8_t i;</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>; i++) {</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>            <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span>) &amp;&amp; (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] != <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>)) {</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>                <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;handle_msg(msg);</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>            }</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>        }</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    }</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>    }</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>}</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span> </div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span><span class="preprocessor">#if HAL_MSP_GPS_ENABLED</span></div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span><span class="keywordtype">void</span> AP_GPS::handle_msp(<span class="keyword">const</span> <a class="code hl_struct" href="structMSP_1_1PACKED.html">MSP::msp_gps_data_message_t</a> &amp;pkt)</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>{</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>; i++) {</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9a591d38b406c75aa871f4632279b6ad">GPS_TYPE_MSP</a>) {</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>            <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;handle_msp(pkt);</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>        }</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>    }</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>}</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span><span class="preprocessor">#endif </span><span class="comment">// HAL_MSP_GPS_ENABLED</span></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span> </div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span><span class="preprocessor">#if HAL_EXTERNAL_AHRS_ENABLED</span></div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span><span class="keywordtype">bool</span> AP_GPS::get_first_external_instance(uint8_t&amp; <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>; i++) {</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f">GPS_TYPE_EXTERNAL_AHRS</a>) {</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>            <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> = i;</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>        }</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>    }</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>}</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span><span class="keywordtype">void</span> AP_GPS::handle_external(<span class="keyword">const</span> AP_ExternalAHRS::gps_data_message_t &amp;pkt, <span class="keyword">const</span> uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>{</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f">GPS_TYPE_EXTERNAL_AHRS</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>        <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;handle_external(pkt);</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>    }</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>}</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span><span class="preprocessor">#endif </span><span class="comment">// HAL_EXTERNAL_AHRS_ENABLED</span></div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span> </div>
<div class="foldopen" id="foldopen01405" data-start="{" data-end="}">
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a27bb197524818a82bd813d22a6b0c1b5"> 1405</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a27bb197524818a82bd813d22a6b0c1b5">AP_GPS::lock_port</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">bool</span> lock)</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>{</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span> </div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>) {</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>    }</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    <span class="keywordflow">if</span> (lock) {</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>        <a class="code hl_variable" href="classAP__GPS.html#af5f34786e914886cbfe9f47cfcf2220d">locked_ports</a> |= (1U&lt;&lt;<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>        <a class="code hl_variable" href="classAP__GPS.html#af5f34786e914886cbfe9f47cfcf2220d">locked_ports</a> &amp;= ~(1U&lt;&lt;<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>);</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>    }</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>}</div>
</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span><span class="comment">// Inject a packet of raw binary to a GPS</span></div>
<div class="foldopen" id="foldopen01419" data-start="{" data-end="}">
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81"> 1419</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">AP_GPS::inject_data</a>(<span class="keyword">const</span> uint8_t *data, uint16_t len)</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>{</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <span class="comment">//Support broadcasting to all GPSes.</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a5c43f8a7049939c439960e2d5431b09b">_inject_to</a> == <a class="code hl_define" href="AP__GPS_8cpp.html#af476b309d3827917a4217a393c7bb6ed">GPS_RTK_INJECT_TO_ALL</a>) {</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>            <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>)) {</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>                <span class="comment">// we don&#39;t externally inject to moving baseline rover</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>            }</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>            <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(i, data, len);</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>        }</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>        <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(<a class="code hl_variable" href="classAP__GPS.html#a5c43f8a7049939c439960e2d5431b09b">_inject_to</a>, data, len);</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>    }</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>}</div>
</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span> </div>
<div class="foldopen" id="foldopen01435" data-start="{" data-end="}">
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"><a class="line" href="classAP__GPS.html#af37f4362574a6bf08aa9f9906cfc09ba"> 1435</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">AP_GPS::inject_data</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keyword">const</span> uint8_t *data, uint16_t len)</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>{</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>        <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a1d0f842ede7aff19b688f948d8d9231b">inject_data</a>(data, len);</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>    }</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>}</div>
</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span> </div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span><span class="comment">/*</span></div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span><span class="comment">  get GPS yaw following mavlink GPS_RAW_INT and GPS2_RAW</span></div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span><span class="comment">  convention. We return 0 if the GPS is not configured to provide</span></div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span><span class="comment">  yaw. We return 65535 for a GPS configured to provide yaw that can&#39;t</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span><span class="comment">  currently provide it. We return from 1 to 36000 for yaw otherwise</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen01448" data-start="{" data-end="}">
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"><a class="line" href="classAP__GPS.html#af55ea526d84ab7a9361d905b90810fb3"> 1448</a></span>uint16_t <a class="code hl_function" href="classAP__GPS.html#af55ea526d84ab7a9361d905b90810fb3">AP_GPS::gps_yaw_cdeg</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classAP__GPS.html#a190bec437911b52d02d6b2aa499fb86a">have_gps_yaw_configured</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)) {</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>    }</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>    <span class="keywordtype">float</span> yaw_deg, accuracy_deg;</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>    uint32_t time_ms;</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classAP__GPS.html#a8a76f3e0443a24ad11b645d7a765b452">gps_yaw_deg</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, yaw_deg, accuracy_deg, time_ms)) {</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <span class="keywordflow">return</span> 65535;</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>    }</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>    <span class="keywordtype">int</span> yaw_cd = <a class="code hl_function" href="AP__Math_8cpp.html#af836ccbc389735a6f129d85126eab30a">wrap_360_cd</a>(yaw_deg * 100);</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>    <span class="keywordflow">if</span> (yaw_cd == 0) {</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>        <span class="keywordflow">return</span> 36000;</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>    }</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <span class="keywordflow">return</span> yaw_cd;</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>}</div>
</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span> </div>
<div class="foldopen" id="foldopen01465" data-start="{" data-end="}">
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a266ef4a39f7a303fc1905bf7f9e4ed09"> 1465</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a266ef4a39f7a303fc1905bf7f9e4ed09">AP_GPS::send_mavlink_gps_raw</a>(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>)</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>{</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>    <span class="keyword">const</span> <a class="code hl_class" href="classLocation.html">Location</a> &amp;loc = <a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>(0);</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>    <span class="keywordtype">float</span> hacc = 0.0f;</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>    <span class="keywordtype">float</span> vacc = 0.0f;</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>    <span class="keywordtype">float</span> sacc = 0.0f;</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>    <span class="keywordtype">float</span> undulation = 0.0;</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>    int32_t height_elipsoid_mm = 0;</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625">get_undulation</a>(0, undulation)) {</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>        height_elipsoid_mm = loc.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a>*10 - undulation*1000;</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>    }</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>    <a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>(0, hacc);</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>    <a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>(0, vacc);</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>    <a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>(0, sacc);</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>    mavlink_msg_gps_raw_int_send(</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>        <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>,</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>        <a class="code hl_function" href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">last_fix_time_ms</a>(0)*(uint64_t)1000,</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        <a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a>(0),</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>        loc.<a class="code hl_variable" href="classLocation.html#ae51548c2cf32311043ca19b94b9a9223">lat</a>,        <span class="comment">// in 1E7 degrees</span></div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>        loc.<a class="code hl_variable" href="classLocation.html#a5831f0aca9e51a15adb96fad465f72f8">lng</a>,        <span class="comment">// in 1E7 degrees</span></div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>        loc.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> * 10UL, <span class="comment">// in mm</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>        <a class="code hl_function" href="classAP__GPS.html#aa6e8517c91f43e38d41af7cf338c8d4f">get_hdop</a>(0),</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>        <a class="code hl_function" href="classAP__GPS.html#a1673a3811b1c622d90db33b223950557">get_vdop</a>(0),</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>        <a class="code hl_function" href="classAP__GPS.html#a79f121ff20c9d3fe180f19f89150af4f">ground_speed</a>(0)*100,  <span class="comment">// cm/s</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>        <a class="code hl_function" href="classAP__GPS.html#aa7e3f1447d7a25eebcc5f06d66cbf395">ground_course</a>(0)*100, <span class="comment">// 1/100 degrees,</span></div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>        <a class="code hl_function" href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">num_sats</a>(0),</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>        height_elipsoid_mm,   <span class="comment">// Ellipsoid height in mm</span></div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>        hacc * 1000,          <span class="comment">// one-sigma standard deviation in mm</span></div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>        vacc * 1000,          <span class="comment">// one-sigma standard deviation in mm</span></div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>        sacc * 1000,          <span class="comment">// one-sigma standard deviation in mm/s</span></div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>        0,                    <span class="comment">// TODO one-sigma heading accuracy standard deviation</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>        <a class="code hl_function" href="classAP__GPS.html#af55ea526d84ab7a9361d905b90810fb3">gps_yaw_cdeg</a>(0));</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>}</div>
</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span> </div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="foldopen" id="foldopen01500" data-start="{" data-end="}">
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a559c00ff3bbc1232f68e64d29a892128"> 1500</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a559c00ff3bbc1232f68e64d29a892128">AP_GPS::send_mavlink_gps2_raw</a>(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>)</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>{</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>    <span class="comment">// always send the message if 2nd GPS is configured</span></div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>    }</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span> </div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>    <span class="keyword">const</span> <a class="code hl_class" href="classLocation.html">Location</a> &amp;loc = <a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>(1);</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    <span class="keywordtype">float</span> hacc = 0.0f;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>    <span class="keywordtype">float</span> vacc = 0.0f;</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    <span class="keywordtype">float</span> sacc = 0.0f;</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>    <span class="keywordtype">float</span> undulation = 0.0;</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>    <span class="keywordtype">float</span> height_elipsoid_mm = 0;</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625">get_undulation</a>(1, undulation)) {</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>        height_elipsoid_mm = loc.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a>*10 - undulation*1000;</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>    }</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>    <a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>(1, hacc);</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>    <a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>(1, vacc);</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>    <a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>(1, sacc);</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>    mavlink_msg_gps2_raw_send(</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>        <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>,</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <a class="code hl_function" href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">last_fix_time_ms</a>(1)*(uint64_t)1000,</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>        <a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a>(1),</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>        loc.<a class="code hl_variable" href="classLocation.html#ae51548c2cf32311043ca19b94b9a9223">lat</a>,</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>        loc.<a class="code hl_variable" href="classLocation.html#a5831f0aca9e51a15adb96fad465f72f8">lng</a>,</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>        loc.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> * 10UL,</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>        <a class="code hl_function" href="classAP__GPS.html#aa6e8517c91f43e38d41af7cf338c8d4f">get_hdop</a>(1),</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>        <a class="code hl_function" href="classAP__GPS.html#a1673a3811b1c622d90db33b223950557">get_vdop</a>(1),</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <a class="code hl_function" href="classAP__GPS.html#a79f121ff20c9d3fe180f19f89150af4f">ground_speed</a>(1)*100,  <span class="comment">// cm/s</span></div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        <a class="code hl_function" href="classAP__GPS.html#aa7e3f1447d7a25eebcc5f06d66cbf395">ground_course</a>(1)*100, <span class="comment">// 1/100 degrees,</span></div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <a class="code hl_function" href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">num_sats</a>(1),</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].rtk_num_sats,</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].rtk_age_ms,</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <a class="code hl_function" href="classAP__GPS.html#af55ea526d84ab7a9361d905b90810fb3">gps_yaw_cdeg</a>(1),</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        height_elipsoid_mm,   <span class="comment">// Ellipsoid height in mm</span></div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        hacc * 1000,          <span class="comment">// one-sigma standard deviation in mm</span></div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>        vacc * 1000,          <span class="comment">// one-sigma standard deviation in mm</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        sacc * 1000,          <span class="comment">// one-sigma standard deviation in mm/s</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>        0);                    <span class="comment">// TODO one-sigma heading accuracy standard deviation</span></div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>}</div>
</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span><span class="preprocessor">#endif </span><span class="comment">// GPS_MAX_RECEIVERS</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span> </div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span><span class="preprocessor">#if HAL_GCS_ENABLED</span></div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#af0ca31342e4c693bf1ef3ec174145963">AP_GPS::send_mavlink_gps_rtk</a>(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, uint8_t inst)</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>{</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>    <span class="keywordflow">if</span> (inst &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>) {</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>    }</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[inst] != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[inst]-&gt;supports_mavlink_gps_rtk_message()) {</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>        <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[inst]-&gt;send_mavlink_gps_rtk(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>);</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>    }</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>}</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span> </div>
<div class="foldopen" id="foldopen01554" data-start="{" data-end="}">
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"><a class="line" href="classAP__GPS.html#af7e7cb028cf6709b5df730e47ec65057"> 1554</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#af7e7cb028cf6709b5df730e47ec65057">AP_GPS::first_unconfigured_gps</a>(uint8_t &amp;<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] != <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a> &amp;&amp; (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] == <span class="keyword">nullptr</span> || !<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;is_configured())) {</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>            <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> = i;</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        }</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>    }</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>}</div>
</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span> </div>
<div class="foldopen" id="foldopen01565" data-start="{" data-end="}">
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a24ab7def0009b4aa846163e9b9704338"> 1565</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a24ab7def0009b4aa846163e9b9704338">AP_GPS::broadcast_first_configuration_failure_reason</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>    uint8_t unconfigured;</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#af7e7cb028cf6709b5df730e47ec65057">first_unconfigured_gps</a>(unconfigured)) {</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[unconfigured] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>            <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;GPS %d: was not found&quot;</span>, unconfigured + 1);</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>            <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[unconfigured]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a1bbca91e9e762d373c1a4b6c0d958ca1">broadcast_configuration_failure_reason</a>();</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>        }</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>    }</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>}</div>
</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span> </div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span><span class="comment">// pre-arm check that all GPSs are close to each other.  farthest distance between GPSs (in meters) is returned</span></div>
<div class="foldopen" id="foldopen01578" data-start="{" data-end="}">
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ac2c5a58b9aa31a268047ce499f61f96c"> 1578</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#ac2c5a58b9aa31a268047ce499f61f96c">AP_GPS::all_consistent</a>(<span class="keywordtype">float</span> &amp;<a class="code hl_variable" href="examples_2location_2location_8cpp.html#a06f14a9abd47b91465f895d5259cdc1b">distance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    <span class="comment">// return true immediately if only one valid receiver</span></div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a> &lt;= 1 ||</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>        <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[0] == <span class="keyword">nullptr</span> || <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[0] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>        <a class="code hl_variable" href="examples_2location_2location_8cpp.html#a06f14a9abd47b91465f895d5259cdc1b">distance</a> = 0;</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>    }</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span> </div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>    <span class="comment">// calculate distance</span></div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>    <a class="code hl_variable" href="examples_2location_2location_8cpp.html#a06f14a9abd47b91465f895d5259cdc1b">distance</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[0].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>.<a class="code hl_function" href="classLocation.html#a77ca1da10b7da6216bb6cf1253ed3dfc">get_distance_NED</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].<a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>).<a class="code hl_function" href="classVector3.html#aaa6419ecd36a969d2eaecd9a1b1edd12">length</a>();</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>    <span class="comment">// success if distance is within 50m</span></div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="examples_2location_2location_8cpp.html#a06f14a9abd47b91465f895d5259cdc1b">distance</a> &lt; 50);</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>}</div>
</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span> </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span><span class="comment">// pre-arm check of GPS blending.  True means healthy or that blending is not being used</span></div>
<div class="foldopen" id="foldopen01595" data-start="{" data-end="}">
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a6534cf5404afbe11d4c7edf06813ce4a"> 1595</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a6534cf5404afbe11d4c7edf06813ce4a">AP_GPS::blend_health_check</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">_blend_health_counter</a> &lt; 50);</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>}</div>
</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span> </div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span><span class="comment">/*</span></div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span><span class="comment">   re-assemble fragmented RTCM data</span></div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen01604" data-start="{" data-end="}">
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a629018b7be7107c6b6a1a590873a93f0"> 1604</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a629018b7be7107c6b6a1a590873a93f0">AP_GPS::handle_gps_rtcm_fragment</a>(uint8_t flags, <span class="keyword">const</span> uint8_t *data, uint8_t len)</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>{</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>    <span class="keywordflow">if</span> ((flags &amp; 1) == 0) {</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>        <span class="comment">// it is not fragmented, pass direct</span></div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>        <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(data, len);</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>    }</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span> </div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>    <span class="comment">// see if we need to allocate re-assembly buffer</span></div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a> = (<span class="keyword">struct </span><a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a> *)<a class="code hl_function" href="malloc_8c.html#a2807e26a012717736641384f91ab2563">calloc</a>(1, <span class="keyword">sizeof</span>(*<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>));</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>            <span class="comment">// nothing to do but discard the data</span></div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>        }</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>    }</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span> </div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>    <span class="keyword">const</span> uint8_t fragment = (flags &gt;&gt; 1U) &amp; 0x03;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>    <span class="keyword">const</span> uint8_t sequence = (flags &gt;&gt; 3U) &amp; 0x1F;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>    uint8_t* start_of_fragment_in_buffer = &amp;<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ad226fe9edff09af33d662e581fab2f48">buffer</a>[MAVLINK_MSG_GPS_RTCM_DATA_FIELD_DATA_LEN * (uint16_t)fragment];</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>    <span class="keywordtype">bool</span> should_clear_previous_fragments = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span> </div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a>) {</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> sequence_nr_changed = <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a3ea184c76817cff75e802b9d8ed76f3c">sequence</a> != sequence;</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> seen_this_fragment_index = <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> &amp; (1U &lt;&lt; fragment);</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span> </div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>        <span class="comment">// check whether this is a duplicate fragment. If it is, we can</span></div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>        <span class="comment">// return early.</span></div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        <span class="keywordflow">if</span> (!sequence_nr_changed &amp;&amp; seen_this_fragment_index &amp;&amp; !memcmp(start_of_fragment_in_buffer, data, len)) {</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        }</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span> </div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        <span class="comment">// not a duplicate</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        should_clear_previous_fragments = sequence_nr_changed || seen_this_fragment_index;</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>    }</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span> </div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>    <span class="keywordflow">if</span> (should_clear_previous_fragments) {</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        <span class="comment">// we have one or more partial fragments already received</span></div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>        <span class="comment">// which conflict with the new fragment, discard previous fragments</span></div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a> = 0;</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>        <a class="code hl_variable" href="classAP__GPS.html#a46e3beda958dc2806d8f705026bbb663">rtcm_stats</a>.fragments_discarded += __builtin_popcount(<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a>);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> = 0;</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>    }</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span> </div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>    <span class="comment">// add this fragment</span></div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>    <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a3ea184c76817cff75e802b9d8ed76f3c">sequence</a> = sequence;</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>    <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> |= (1U &lt;&lt; fragment);</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span> </div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>    <span class="comment">// copy the data</span></div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>    memcpy(start_of_fragment_in_buffer, data, len);</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span> </div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>    <span class="comment">// when we get a fragment of less than max size then we know the</span></div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>    <span class="comment">// number of fragments. Note that this means if you want to send a</span></div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>    <span class="comment">// block of RTCM data of an exact multiple of the buffer size you</span></div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>    <span class="comment">// need to send a final packet of zero length</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    <span class="keywordflow">if</span> (len &lt; MAVLINK_MSG_GPS_RTCM_DATA_FIELD_DATA_LEN) {</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a> = fragment+1;</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a5dfe66bc0c5d4f1e87b06bb36f9dc4db">total_length</a> = (MAVLINK_MSG_GPS_RTCM_DATA_FIELD_DATA_LEN*fragment) + len;</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> == 0x0F) {</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <span class="comment">// special case of 4 full fragments</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a> = 4;</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a5dfe66bc0c5d4f1e87b06bb36f9dc4db">total_length</a> = MAVLINK_MSG_GPS_RTCM_DATA_FIELD_DATA_LEN*4;</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>    }</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span> </div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span> </div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>    <span class="comment">// see if we have all fragments</span></div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a> != 0 &amp;&amp;</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> == (1U &lt;&lt; <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a>) - 1) {</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>        <span class="comment">// we have them all, inject</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>        <a class="code hl_variable" href="classAP__GPS.html#a46e3beda958dc2806d8f705026bbb663">rtcm_stats</a>.fragments_used += __builtin_popcount(<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a>);</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>        <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(<a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ad226fe9edff09af33d662e581fab2f48">buffer</a>, <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a5dfe66bc0c5d4f1e87b06bb36f9dc4db">total_length</a>);</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">fragment_count</a> = 0;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <a class="code hl_struct" href="structAP__GPS_1_1rtcm__buffer.html">rtcm_buffer</a>-&gt;<a class="code hl_variable" href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">fragments_received</a> = 0;</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>    }</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>}</div>
</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span> </div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span><span class="comment">/*</span></div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span><span class="comment">   re-assemble GPS_RTCM_DATA message</span></div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen01683" data-start="{" data-end="}">
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a26a409b50f1bbf539088095d4eb78092"> 1683</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a26a409b50f1bbf539088095d4eb78092">AP_GPS::handle_gps_rtcm_data</a>(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, <span class="keyword">const</span> mavlink_message_t &amp;msg)</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>{</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>    mavlink_gps_rtcm_data_t packet;</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>    mavlink_msg_gps_rtcm_data_decode(&amp;msg, &amp;packet);</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span> </div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>    <span class="keywordflow">if</span> (packet.len &gt; <span class="keyword">sizeof</span>(packet.data)) {</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>        <span class="comment">// invalid packet</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>    }</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span> </div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span><span class="preprocessor">#if AP_GPS_RTCM_DECODE_ENABLED</span></div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca3bbfb0578f308e855b286ee6b388fcd2">DriverOptions::DisableRTCMDecode</a>)) {</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>        <span class="keyword">const</span> uint16_t mask = (1U &lt;&lt; unsigned(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>));</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>        rtcm.seen_mav_channels |= mask;</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">option_set</a>(<a class="code hl_enumvalue" href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca1094a76c0752e8d8280511f69360dae2">DriverOptions::AlwaysRTCMDecode</a>) ||</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>            (rtcm.seen_mav_channels &amp; ~mask) != 0) {</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span><span class="comment">              we are seeing RTCM on multiple mavlink channels. We will run</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span><span class="comment">              the data through a full per-channel RTCM decoder</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span><span class="comment">            */</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>            <span class="keywordflow">if</span> (parse_rtcm_injection(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, packet)) {</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>            }</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>        }</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>    }</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>    <a class="code hl_function" href="classAP__GPS.html#a629018b7be7107c6b6a1a590873a93f0">handle_gps_rtcm_fragment</a>(packet.flags, packet.data, packet.len);</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>}</div>
</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span> </div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span><span class="preprocessor">#if AP_GPS_RTCM_DECODE_ENABLED</span></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span><span class="comment">/*</span></div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span><span class="comment">  fully parse RTCM data coming in from a MAVLink channel, when we have</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span><span class="comment">  a full message inject it to the GPS. This approach allows for 2 or</span></div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span><span class="comment">  more MAVLink channels to be used for the same RTCM data, allowing</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="comment">  for redundent transports for maximum reliability at the cost of some</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span><span class="comment">  extra CPU and a bit of re-assembly lag</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span><span class="comment"> */</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span><span class="keywordtype">bool</span> AP_GPS::parse_rtcm_injection(mavlink_channel_t <a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>, <span class="keyword">const</span> mavlink_gps_rtcm_data_t &amp;pkt)</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>{</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a> &gt;= <a class="code hl_define" href="GCS__MAVLink_8h.html#aff625e94451bf446bdd56f5d0e081077">MAVLINK_COMM_NUM_BUFFERS</a>) {</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>    }</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>    <span class="keywordflow">if</span> (rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>        rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>] = <span class="keyword">new</span> <a class="code hl_class" href="classRTCM3__Parser.html">RTCM3_Parser</a>();</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>        <span class="keywordflow">if</span> (rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        }</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>        <a class="code hl_define" href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;GPS: RTCM parsing for chan %u&quot;</span>, <span class="keywordtype">unsigned</span>(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>));</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>    }</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>    <span class="keywordflow">for</span> (uint16_t i=0; i&lt;pkt.len; i++) {</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>        <span class="keywordflow">if</span> (rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>]-&gt;read(pkt.data[i])) {</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>            <span class="comment">// we have a full message, inject it</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>            <span class="keyword">const</span> uint8_t *buf = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>            uint16_t len = rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>]-&gt;get_len(buf);</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span> </div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>            <span class="comment">// see if we have already sent it. This prevents</span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>            <span class="comment">// duplicates from multiple sources</span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>            <span class="keyword">const</span> uint32_t crc = <a class="code hl_function" href="crc_8cpp.html#a6883728567d1a4e1d28ca0f725fe79cc">crc_crc32</a>(0, buf, len);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span> </div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>            <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#abab7cb26825a8dfb1e5e92cf7fcf4152">WriteStreaming</a>(<span class="stringliteral">&quot;RTCM&quot;</span>, <span class="stringliteral">&quot;TimeUS,Chan,RTCMId,Len,CRC&quot;</span>, <span class="stringliteral">&quot;s#---&quot;</span>, <span class="stringliteral">&quot;F----&quot;</span>, <span class="stringliteral">&quot;QBHHI&quot;</span>,</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>                                        <a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>(),</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>                                        uint8_t(<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>),</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>                                        rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>]-&gt;get_id(),</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>                                        len,</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>                                        crc);</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>            </div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>            <span class="keywordtype">bool</span> already_seen = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>            <span class="keywordflow">for</span> (uint8_t c=0; c&lt;<a class="code hl_define" href="AP__Common_8h.html#a121caf32c5b5d704ef3453f0885a9ea5">ARRAY_SIZE</a>(rtcm.sent_crc); c++) {</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>                <span class="keywordflow">if</span> (rtcm.sent_crc[c] == crc) {</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>                    <span class="comment">// we have already sent this message</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>                    already_seen = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>                }</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>            }</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>            <span class="keywordflow">if</span> (already_seen) {</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>            }</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>            rtcm.sent_crc[rtcm.sent_idx] = crc;</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>            rtcm.sent_idx = (rtcm.sent_idx+1) % <a class="code hl_define" href="AP__Common_8h.html#a121caf32c5b5d704ef3453f0885a9ea5">ARRAY_SIZE</a>(rtcm.sent_crc);</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>            <span class="keywordflow">if</span> (buf != <span class="keyword">nullptr</span> &amp;&amp; len &gt; 0) {</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>                <a class="code hl_function" href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">inject_data</a>(buf, len);</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>            }</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>            rtcm.parsers[<a class="code hl_variable" href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a>]-&gt;reset();</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>        }</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>    }</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>}</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span><span class="preprocessor">#endif </span><span class="comment">// AP_GPS_RTCM_DECODE_ENABLED</span></div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span> </div>
<div class="foldopen" id="foldopen01776" data-start="{" data-end="}">
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"><a class="line" href="classAP__GPS.html#adb1d7e0cbc5e14f4d80008f5e5db0eed"> 1776</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#adb1d7e0cbc5e14f4d80008f5e5db0eed">AP_GPS::Write_AP_Logger_Log_Startup_messages</a>()</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>{</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>    <span class="keywordflow">for</span> (uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>=0; <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>&lt;<a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a>; <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>++) {</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span> || <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> == <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">NO_GPS</a>) {</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        }</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>        <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a2d73140d3b37b74b167a95deae6c213c">Write_AP_Logger_Log_Startup_messages</a>();</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>    }</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>}</div>
</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span> </div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span><span class="comment">/*</span></div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span><span class="comment">  return the expected lag (in seconds) in the position and velocity readings from the gps</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span><span class="comment">  return true if the GPS hardware configuration is known or the delay parameter has been set</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen01790" data-start="{" data-end="}">
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"><a class="line" href="classAP__GPS.html#aaeb8dc7cbdae6534526a00444a53cda1"> 1790</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#aaeb8dc7cbdae6534526a00444a53cda1">AP_GPS::get_lag</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;lag_sec)<span class="keyword"> const</span></div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>    <span class="comment">// always ensure a lag is provided</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>    lag_sec = 0.1f;</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span> </div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a3a734b4d4de7ca88c6563a5a476e3e87">GPS_MAX_INSTANCES</a>) {</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>    }</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span> </div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>    <span class="comment">// return lag of blended GPS</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> == <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>) {</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>        lag_sec = <a class="code hl_variable" href="classAP__GPS.html#a4463d97bdd728f628ec944f39266376b">_blended_lag_sec</a>;</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>        <span class="comment">// auto switching uses all GPS receivers, so all must be configured</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>        uint8_t inst; <span class="comment">// we don&#39;t actually care what the number is, but must pass it</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classAP__GPS.html#af7e7cb028cf6709b5df730e47ec65057">first_unconfigured_gps</a>(inst);</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>    }</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span> </div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a145c5605ca4a49f0ae8a0936706ca221">_delay_ms</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] &gt; 0) {</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>        <span class="comment">// if the user has specified a non zero time delay, always return that value</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>        lag_sec = 0.001f * (float)<a class="code hl_variable" href="classAP__GPS.html#a145c5605ca4a49f0ae8a0936706ca221">_delay_ms</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>        <span class="comment">// the user is always right !!</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span> || <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> == <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">NO_GPS</a>) {</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>        <span class="comment">// no GPS was detected in this instance so return the worst possible lag term</span></div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>            lag_sec = 0.0f;</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>        }</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">GPS_TYPE_AUTO</a>;</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>        <span class="comment">// the user has not specified a delay so we determine it from the GPS type</span></div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a537b2420185215ce22358e93f8c73e62">get_lag</a>(lag_sec);</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>    }</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>}</div>
</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span> </div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span><span class="comment">// return a 3D vector defining the offset of the GPS antenna in meters relative to the body frame origin</span></div>
<div class="foldopen" id="foldopen01828" data-start="{" data-end="}">
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a7647cae1e8f90b75020d3cd6c31470ff"> 1828</a></span><span class="keyword">const</span> <a class="code hl_class" href="classVector3.html">Vector3f</a> &amp;<a class="code hl_function" href="classAP__GPS.html#a7647cae1e8f90b75020d3cd6c31470ff">AP_GPS::get_antenna_offset</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a3a734b4d4de7ca88c6563a5a476e3e87">GPS_MAX_INSTANCES</a>) {</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>        <span class="comment">// we have to return a reference so use instance 0</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a4ff8670878e8371b8be04da456778045">_antenna_offset</a>[0];</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>    }</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span> </div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> == <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>) {</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>        <span class="comment">// return an offset for the blended GPS solution</span></div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a09de09009fdec7d5242a04adeb7f842c">_blended_antenna_offset</a>;</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>    }</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span> </div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a4ff8670878e8371b8be04da456778045">_antenna_offset</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>}</div>
</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span> </div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span><span class="comment">/*</span></div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span><span class="comment">  returns the desired gps update rate in milliseconds</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span><span class="comment">  this does not provide any guarantee that the GPS is updating at the requested</span></div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span><span class="comment">  rate it is simply a helper for use in the backends for determining what rate</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span><span class="comment">  they should be configuring the GPS to run at</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen01851" data-start="{" data-end="}">
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ac9f4da4e698ba211f2323a9a6731826c"> 1851</a></span>uint16_t <a class="code hl_function" href="classAP__GPS.html#ac9f4da4e698ba211f2323a9a6731826c">AP_GPS::get_rate_ms</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>    <span class="comment">// sanity check</span></div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_variable" href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">num_instances</a> || <a class="code hl_variable" href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">_rate_ms</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] &lt;= 0) {</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">GPS_MAX_RATE_MS</a>;</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>    }</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_variable" href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">_rate_ms</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>], <a class="code hl_define" href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">GPS_MAX_RATE_MS</a>);</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>}</div>
</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span> </div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span><span class="comment">/*</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span><span class="comment"> calculate the weightings used to blend GPSs location and velocity data</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen01864" data-start="{" data-end="}">
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ad6736a9d4cbb5352caf3d76e4928a356"> 1864</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#ad6736a9d4cbb5352caf3d76e4928a356">AP_GPS::calc_blend_weights</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>{</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>    <span class="comment">// zero the blend weights</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>    memset(&amp;<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>));</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span> </div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span> </div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>    <span class="keyword">static_assert</span>(<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> == 2, <span class="stringliteral">&quot;GPS blending only currently works with 2 receivers&quot;</span>);</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>    <span class="comment">// Note that the early quit below relies upon exactly 2 instances</span></div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>    <span class="comment">// The time delta calculations below also rely upon every instance being currently detected and being parsed</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span> </div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>    <span class="comment">// exit immediately if not enough receivers to do blending</span></div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[0].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &lt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">NO_FIX</a> || <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &lt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">NO_FIX</a>) {</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>    }</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span> </div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>    <span class="comment">// Use the oldest non-zero time, but if time difference is excessive, use newest to prevent a disconnected receiver from blocking updates</span></div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>    uint32_t max_ms = 0; <span class="comment">// newest non-zero system time of arrival of a GPS message</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>    uint32_t min_ms = -1; <span class="comment">// oldest non-zero system time of arrival of a GPS message</span></div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>    uint32_t max_rate_ms = 0; <span class="comment">// largest update interval of a GPS receiver</span></div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>        <span class="comment">// Find largest and smallest times</span></div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].last_gps_time_ms &gt; max_ms) {</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>            max_ms = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a>;</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>        }</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].last_gps_time_ms &lt; min_ms) &amp;&amp; (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a> &gt; 0)) {</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>            min_ms = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a>;</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>        }</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>        max_rate_ms = <a class="code hl_define" href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code hl_function" href="classAP__GPS.html#ac9f4da4e698ba211f2323a9a6731826c">get_rate_ms</a>(i), max_rate_ms);</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>        <span class="keywordflow">if</span> (isinf(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>) ||</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>            isinf(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>) ||</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>            isinf(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>)) {</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>        }</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    }</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>    <span class="keywordflow">if</span> ((max_ms - min_ms) &lt; (2 * max_rate_ms)) {</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>        <span class="comment">// data is not too delayed so use the oldest time_stamp to give a chance for data from that receiver to be updated</span></div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">last_gps_time_ms</a> = min_ms;</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>        <span class="comment">// receiver data has timed out so fail out of blending</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>    }</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span> </div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>    <span class="comment">// calculate the sum squared speed accuracy across all GPS sensors</span></div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>    <span class="keywordtype">float</span> speed_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a10564ab5cea24ce00f9fd6f641fe339a">_blend_mask</a> &amp; <a class="code hl_define" href="AP__GPS_8cpp.html#af3476ae7cb8c401b7d55ab98b86ed292">BLEND_MASK_USE_SPD_ACC</a>) {</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>) {</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_speed_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>                    speed_accuracy_sum_sq += <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>);</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>                    <span class="comment">// not all receivers support this metric so set it to zero and don&#39;t use it</span></div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>                    speed_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>                }</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>            }</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>        }</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>    }</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span> </div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>    <span class="comment">// calculate the sum squared horizontal position accuracy across all GPS sensors</span></div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>    <span class="keywordtype">float</span> horizontal_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a10564ab5cea24ce00f9fd6f641fe339a">_blend_mask</a> &amp; <a class="code hl_define" href="AP__GPS_8cpp.html#af2a2b9d86200a37152ed36817f914ac7">BLEND_MASK_USE_HPOS_ACC</a>) {</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">GPS_OK_FIX_2D</a>) {</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_horizontal_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>                    horizontal_accuracy_sum_sq += <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>);</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>                    <span class="comment">// not all receivers support this metric so set it to zero and don&#39;t use it</span></div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>                    horizontal_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>                }</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>            }</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>        }</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>    }</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span> </div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>    <span class="comment">// calculate the sum squared vertical position accuracy across all GPS sensors</span></div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>    <span class="keywordtype">float</span> vertical_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a10564ab5cea24ce00f9fd6f641fe339a">_blend_mask</a> &amp; <a class="code hl_define" href="AP__GPS_8cpp.html#a5c474882dc169c97221822426d3d48ed">BLEND_MASK_USE_VPOS_ACC</a>) {</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a>) {</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_vertical_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a> &gt; 0.0f) {</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>                    vertical_accuracy_sum_sq += <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>);</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>                    <span class="comment">// not all receivers support this metric so set it to zero and don&#39;t use it</span></div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>                    vertical_accuracy_sum_sq = 0.0f;</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>                }</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>            }</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>        }</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>    }</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>    <span class="comment">// Check if we can do blending using reported accuracy</span></div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>    <span class="keywordtype">bool</span> can_do_blending = (horizontal_accuracy_sum_sq &gt; 0.0f || vertical_accuracy_sum_sq &gt; 0.0f || speed_accuracy_sum_sq &gt; 0.0f);</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span> </div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>    <span class="comment">// if we can&#39;t do blending using reported accuracy, return false and hard switch logic will be used instead</span></div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>    <span class="keywordflow">if</span> (!can_do_blending) {</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>    }</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span> </div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>    <span class="keywordtype">float</span> sum_of_all_weights = 0.0f;</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span> </div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>    <span class="comment">// calculate a weighting using the reported horizontal position</span></div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>    <span class="keywordtype">float</span> hpos_blend_weights[<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>] = {};</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>    <span class="keywordflow">if</span> (horizontal_accuracy_sum_sq &gt; 0.0f) {</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>        <span class="comment">// calculate the weights using the inverse of the variances</span></div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>        <span class="keywordtype">float</span> sum_of_hpos_weights = 0.0f;</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">GPS_OK_FIX_2D</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a> &gt;= 0.001f) {</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>                hpos_blend_weights[i] = horizontal_accuracy_sum_sq / <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>);</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>                sum_of_hpos_weights += hpos_blend_weights[i];</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>            }</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>        }</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>        <span class="comment">// normalise the weights</span></div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>        <span class="keywordflow">if</span> (sum_of_hpos_weights &gt; 0.0f) {</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>            <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>                hpos_blend_weights[i] = hpos_blend_weights[i] / sum_of_hpos_weights;</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>            }</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>            sum_of_all_weights += 1.0f;</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>        }</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>    }</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span> </div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>    <span class="comment">// calculate a weighting using the reported vertical position accuracy</span></div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>    <span class="keywordtype">float</span> vpos_blend_weights[<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>] = {};</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>    <span class="keywordflow">if</span> (vertical_accuracy_sum_sq &gt; 0.0f) {</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>        <span class="comment">// calculate the weights using the inverse of the variances</span></div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>        <span class="keywordtype">float</span> sum_of_vpos_weights = 0.0f;</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a> &gt;= 0.001f) {</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>                vpos_blend_weights[i] = vertical_accuracy_sum_sq / <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>);</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>                sum_of_vpos_weights += vpos_blend_weights[i];</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>            }</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>        }</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>        <span class="comment">// normalise the weights</span></div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>        <span class="keywordflow">if</span> (sum_of_vpos_weights &gt; 0.0f) {</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>            <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>                vpos_blend_weights[i] = vpos_blend_weights[i] / sum_of_vpos_weights;</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>            }</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>            sum_of_all_weights += 1.0f;</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>        };</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>    }</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span> </div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>    <span class="comment">// calculate a weighting using the reported speed accuracy</span></div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>    <span class="keywordtype">float</span> spd_blend_weights[<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>] = {};</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>    <span class="keywordflow">if</span> (speed_accuracy_sum_sq &gt; 0.0f) {</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>        <span class="comment">// calculate the weights using the inverse of the variances</span></div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>        <span class="keywordtype">float</span> sum_of_spd_weights = 0.0f;</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt;= <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">GPS_OK_FIX_3D</a> &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a> &gt;= 0.001f) {</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>                spd_blend_weights[i] = speed_accuracy_sum_sq / <a class="code hl_function" href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>);</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>                sum_of_spd_weights += spd_blend_weights[i];</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>            }</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>        }</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>        <span class="comment">// normalise the weights</span></div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>        <span class="keywordflow">if</span> (sum_of_spd_weights &gt; 0.0f) {</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>            <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>                spd_blend_weights[i] = spd_blend_weights[i] / sum_of_spd_weights;</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>            }</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>            sum_of_all_weights += 1.0f;</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>        }</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>    }</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span> </div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a>(sum_of_all_weights)) {</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>    }</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span> </div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>    <span class="comment">// calculate an overall weight</span></div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>        <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] = (hpos_blend_weights[i] + vpos_blend_weights[i] + spd_blend_weights[i]) / sum_of_all_weights;</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>    }</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span> </div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>}</div>
</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span> </div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span><span class="comment">/*</span></div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span><span class="comment"> calculate a blended GPS state</span></div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen02038" data-start="{" data-end="}">
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a86e388032563bbd72cca1bce9ec24d17"> 2038</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a86e388032563bbd72cca1bce9ec24d17">AP_GPS::calc_blended_state</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>{</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>    <span class="comment">// initialise the blended states so we can accumulate the results using the weightings for each GPS receiver</span></div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a95606c520bd395452a6e171828a4988d">instance</a> = <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>;</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_enumvalue" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">NO_FIX</a>;</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">time_week_ms</a> = 0;</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a> = 0;</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#aa6b54a6f8a46a0418ae505a45480ff45">ground_speed</a> = 0.0f;</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a037e16c03fbb1091bec680ef2dfc73c7">ground_course</a> = 0.0f;</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a> = <a class="code hl_define" href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a>;</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> = 0;</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">velocity</a>.<a class="code hl_function" href="classVector3.html#adf1769d5ee5df2f8585df2f540fa5efe">zero</a>();</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0845d4035e6cb36a9e1e31f4a68531f2">speed_accuracy</a> = 1e6f;</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ad0ebe176090d273b59cad3e6d86fd416">horizontal_accuracy</a> = 1e6f;</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#af5066cda264f04cf812a5ffdb8248e46">vertical_accuracy</a> = 1e6f;</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab8bec1358e2740e4d76f60d1f8545130">have_vertical_velocity</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#aef86178057c2197396dfd8836bf8e1b5">have_speed_accuracy</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a67fb5cd3a118c2517a6d1fdc928f9227">have_horizontal_accuracy</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a464226322ab0371a941f490cd1a818d8">have_vertical_accuracy</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a> = {};</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span> </div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>    <a class="code hl_variable" href="classAP__GPS.html#a09de09009fdec7d5242a04adeb7f842c">_blended_antenna_offset</a>.<a class="code hl_function" href="classVector3.html#adf1769d5ee5df2f8585df2f540fa5efe">zero</a>();</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>    <a class="code hl_variable" href="classAP__GPS.html#a4463d97bdd728f628ec944f39266376b">_blended_lag_sec</a> = 0;</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span> </div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>    <span class="keyword">const</span> uint32_t last_blended_message_time_ms = <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a>;</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">last_fix_time_ms</a> = 0;</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = 0;</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span> </div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[0].have_undulation) {</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a69b3811b8240fd93d6d297ce49d44fc3">have_undulation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">undulation</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[0].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">undulation</a>;</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].have_undulation) {</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a69b3811b8240fd93d6d297ce49d44fc3">have_undulation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">undulation</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[1].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">undulation</a>;</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a69b3811b8240fd93d6d297ce49d44fc3">have_undulation</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>    }</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span> </div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>    <span class="comment">// combine the states into a blended solution</span></div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>        <span class="comment">// use the highest status</span></div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">status</a>) {</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">status</a>;</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>        }</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span> </div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>        <span class="comment">// calculate a blended average velocity</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">velocity</a> += <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">velocity</a> * <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span> </div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>        <span class="comment">// report the best valid accuracies and DOP metrics</span></div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span> </div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_horizontal_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a> &gt; 0.0f &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a> &lt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>) {</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a67fb5cd3a118c2517a6d1fdc928f9227">have_horizontal_accuracy</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ad0ebe176090d273b59cad3e6d86fd416">horizontal_accuracy</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ad0ebe176090d273b59cad3e6d86fd416">horizontal_accuracy</a>;</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>        }</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span> </div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_vertical_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a> &gt; 0.0f &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a> &lt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>) {</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a464226322ab0371a941f490cd1a818d8">have_vertical_accuracy</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#af5066cda264f04cf812a5ffdb8248e46">vertical_accuracy</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#af5066cda264f04cf812a5ffdb8248e46">vertical_accuracy</a>;</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>        }</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span> </div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#adeb2695a00658d267b847fda8d08a5da">have_vertical_velocity</a>) {</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab8bec1358e2740e4d76f60d1f8545130">have_vertical_velocity</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>        }</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span> </div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].have_speed_accuracy &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a> &gt; 0.0f &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a> &lt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>) {</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#aef86178057c2197396dfd8836bf8e1b5">have_speed_accuracy</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0845d4035e6cb36a9e1e31f4a68531f2">speed_accuracy</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0845d4035e6cb36a9e1e31f4a68531f2">speed_accuracy</a>;</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>        }</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span> </div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].hdop &gt; 0 &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].hdop &lt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].hdop) {</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">hdop</a>;</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>        }</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span> </div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].vdop &gt; 0 &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].vdop &lt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].vdop) {</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">vdop</a>;</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>        }</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span> </div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">num_sats</a> &gt; 0 &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">num_sats</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">num_sats</a>) {</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">num_sats</a>;</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>        }</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span> </div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>        <span class="comment">// report a blended average GPS antenna position</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>        <a class="code hl_class" href="classVector3.html">Vector3f</a> temp_antenna_offset = <a class="code hl_variable" href="classAP__GPS.html#a4ff8670878e8371b8be04da456778045">_antenna_offset</a>[i];</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>        temp_antenna_offset *= <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>        <a class="code hl_variable" href="classAP__GPS.html#a09de09009fdec7d5242a04adeb7f842c">_blended_antenna_offset</a> += temp_antenna_offset;</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span> </div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>        <span class="comment">// blend the timing data</span></div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_function" href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">last_fix_time_ms</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">last_fix_time_ms</a>) {</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>            <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">last_fix_time_ms</a> = <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">last_fix_time_ms</a>;</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>        }</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_function" href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">last_message_time_ms</a> &gt; <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">last_message_time_ms</a>) {</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>            <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a>;</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>        }</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>    }</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span> </div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span><span class="comment">     * Calculate an instantaneous weighted/blended average location from the available GPS instances and store in the _output_state.</span></div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span><span class="comment">     * This will be statistically the most likely location, but will be not stable enough for direct use by the autopilot.</span></div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span><span class="comment">    */</span></div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span> </div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>    <span class="comment">// Use the GPS with the highest weighting as the reference position</span></div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>    <span class="keywordtype">float</span> best_weight = 0.0f;</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>    uint8_t best_index = 0;</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; best_weight) {</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>            best_weight = <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>            best_index = i;</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>            <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>;</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>        }</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>    }</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span> </div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>    <span class="comment">// Calculate the weighted sum of horizontal and vertical position offsets relative to the reference position</span></div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>    <a class="code hl_class" href="structVector2.html">Vector2f</a> blended_NE_offset_m;</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>    <span class="keywordtype">float</span> blended_alt_offset_cm = 0.0f;</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>    blended_NE_offset_m.<a class="code hl_function" href="structVector2.html#a6b537328ae913e3e7267b539e7a4af92">zero</a>();</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; 0.0f &amp;&amp; i != best_index) {</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>            blended_NE_offset_m += <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>.<a class="code hl_function" href="classLocation.html#af597420e2ec20fc794ca3d5447fd36ba">get_distance_NE</a>(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>) * <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>            blended_alt_offset_cm += (float)(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> - <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a>) * <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>        }</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>    }</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span> </div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>    <span class="comment">// Add the sum of weighted offsets to the reference location to obtain the blended location</span></div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>.<a class="code hl_function" href="classLocation.html#a146775eb07ce9abcc8d05f1b730404b0">offset</a>(blended_NE_offset_m.<a class="code hl_variable" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>, blended_NE_offset_m.<a class="code hl_variable" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>);</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">location</a>.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> += (int)blended_alt_offset_cm;</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span> </div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>    <span class="comment">// Calculate ground speed and course from blended velocity vector</span></div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#aa6b54a6f8a46a0418ae505a45480ff45">ground_speed</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">velocity</a>.<a class="code hl_function" href="classVector3.html#abcf8b89285b9966932d1aceeeadb21d3">xy</a>().<a class="code hl_function" href="structVector2.html#aed3cf4803ee803dc1447985ca323178f">length</a>();</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>    <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a037e16c03fbb1091bec680ef2dfc73c7">ground_course</a> = <a class="code hl_function" href="AP__Math_8cpp.html#ad2245faee11bdecf357553e7807dc068">wrap_360</a>(<a class="code hl_define" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(atan2f(<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a98e00c3558ecca57c67a529becd029e2">velocity</a>.<a class="code hl_variable" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">velocity</a>.<a class="code hl_variable" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>)));</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span> </div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>    <span class="comment">// If the GPS week is the same then use a blended time_week_ms</span></div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>    <span class="comment">// If week is different, then use time stamp from GPS with largest weighting</span></div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>    <span class="comment">// detect inconsistent week data</span></div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>    uint8_t last_week_instance = 0;</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>    <span class="keywordtype">bool</span> weeks_consistent = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>        <span class="keywordflow">if</span> (last_week_instance == 0 &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; 0) {</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>            <span class="comment">// this is our first valid sensor week data</span></div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>            last_week_instance = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>;</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (last_week_instance != 0 &amp;&amp; <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; 0 &amp;&amp; last_week_instance != <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#a1edd7dcbf000c4d7cc4c2848e5ecf088">time_week</a>) {</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>            <span class="comment">// there is valid sensor week data that is inconsistent</span></div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>            weeks_consistent = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>        }</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>    }</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>    <span class="comment">// calculate output</span></div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>    <span class="keywordflow">if</span> (!weeks_consistent) {</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>        <span class="comment">// use data from highest weighted sensor</span></div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[best_index].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>;</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">time_week_ms</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[best_index].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">time_week_ms</a>;</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>        <span class="comment">// use week number from highest weighting GPS (they should all have the same week number)</span></div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a> = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[best_index].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">time_week</a>;</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>        <span class="comment">// calculate a blended value for the number of ms lapsed in the week</span></div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>        <span class="keywordtype">double</span> temp_time_0 = 0.0;</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; 0.0f) {</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>                temp_time_0 += (double)<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].<a class="code hl_function" href="classAP__GPS.html#ab6690a9a05471bfb22fc7d171f12b4fc">time_week_ms</a> * (<span class="keywordtype">double</span>)<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>            }</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>        }</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">time_week_ms</a> = (uint32_t)temp_time_0;</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>    }</div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span> </div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>    <span class="comment">// calculate a blended value for the timing data and lag</span></div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>    <span class="keywordtype">double</span> temp_time_1 = 0.0;</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>    <span class="keywordtype">double</span> temp_time_2 = 0.0;</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i] &gt; 0.0f) {</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>            temp_time_1 += (double)<a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_function" href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">last_fix_time_ms</a> * (<span class="keywordtype">double</span>) <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>            temp_time_2 += (double)<a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[i].<a class="code hl_function" href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">last_message_time_ms</a> * (<span class="keywordtype">double</span>)<a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>            <span class="keywordtype">float</span> gps_lag_sec = 0;</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>            <a class="code hl_function" href="classAP__GPS.html#aaeb8dc7cbdae6534526a00444a53cda1">get_lag</a>(i, gps_lag_sec);</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>            <a class="code hl_variable" href="classAP__GPS.html#a4463d97bdd728f628ec944f39266376b">_blended_lag_sec</a> += gps_lag_sec * <a class="code hl_variable" href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">_blend_weights</a>[i];</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>        }</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>    }</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">last_fix_time_ms</a> = (uint32_t)temp_time_1;</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>    <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">last_message_time_ms</a> = (uint32_t)temp_time_2;</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span> </div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>].<a class="code hl_function" href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">last_message_time_ms</a> &gt; last_blended_message_time_ms &amp;&amp;</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>        <a class="code hl_function" href="classAP__GPS.html#a8d10f943cb245f20b1dc5f8e727f52eb">should_log</a>()) {</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>        <a class="code hl_function" href="classAP__GPS.html#a22210502424345970c0ca3291d5d1aa1">Write_GPS</a>(<a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>);</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>    }</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>}</div>
</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span><span class="preprocessor">#endif </span><span class="comment">// GPS_BLENDED_INSTANCE</span></div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span> </div>
<div class="foldopen" id="foldopen02227" data-start="{" data-end="}">
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a7c289e343fd9873111accc9bfa75da47"> 2227</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a48d705a86f6f13cb6fe506c7b93d5262">AP_GPS::is_healthy</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a3a734b4d4de7ca88c6563a5a476e3e87">GPS_MAX_INSTANCES</a>) {</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>    }</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span> </div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#a0101b0a077933c5bcbb15a6d63a03d07">get_type</a>(<a class="code hl_variable" href="classAP__GPS.html#a6eb39317fffbbb7f860cf2c54858aab9">_primary</a>.get()) == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">GPS_TYPE_NONE</a>) {</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>    }</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span> </div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span><span class="preprocessor">#ifndef HAL_BUILD_AP_PERIPH</span></div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span><span class="comment">      on AP_Periph handling of timing is done by the flight controller</span></div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span><span class="comment">      receiving the DroneCAN messages</span></div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span><span class="comment">     */</span></div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span><span class="comment">      allow two lost frames before declaring the GPS unhealthy, but</span></div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span><span class="comment">      require the average frame rate to be close to 5Hz.</span></div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span><span class="comment"></span> </div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span><span class="comment">      We allow for a rate of 3Hz average for a moving baseline rover</span></div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span><span class="comment">      due to the packet loss that happens with the RTCMv3 data and the</span></div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span><span class="comment">      fact that the rate of yaw data is not critical</span></div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span><span class="comment">     */</span></div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>    <span class="keyword">const</span> uint8_t delay_threshold = 2;</div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> delay_avg_max = ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>))?333:215;</div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structAP__GPS_1_1GPS__timing.html">GPS_timing</a> &amp;t = <a class="code hl_variable" href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">timing</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span>    <span class="keywordtype">bool</span> delay_ok = (t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#a893a04a484a2624e09cfd01c2338ff90">delayed_count</a> &lt; delay_threshold) &amp;&amp;</div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>        t.<a class="code hl_variable" href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">average_delta_ms</a> &lt; delay_avg_max &amp;&amp;</div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>        <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a3c0022cde6ac8bb086f1c66b30dc0702">lagged_sample_count</a> &lt; 5;</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>    <span class="keywordflow">if</span> (!delay_ok) {</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>    }</div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span><span class="preprocessor">#endif </span><span class="comment">// HAL_BUILD_AP_PERIPH</span></div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span> </div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span><span class="preprocessor">#if defined(GPS_BLENDED_INSTANCE)</span></div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> == <a class="code hl_define" href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a>) {</div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classAP__GPS.html#a6534cf5404afbe11d4c7edf06813ce4a">blend_health_check</a>();</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>    }</div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span> </div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>           <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a7fe9c23afd9cb1b88b61ce33bf0dd37c">is_healthy</a>();</div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span>}</div>
</div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span> </div>
<div class="foldopen" id="foldopen02271" data-start="{" data-end="}">
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ac66632e3a213d12c35d56ae65a3dfa08"> 2271</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#ac66632e3a213d12c35d56ae65a3dfa08">AP_GPS::prepare_for_arming</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>    <span class="keywordtype">bool</span> all_passed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>            all_passed &amp;= <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a42195424a7f5664b2240133ebc22b2cd">prepare_for_arming</a>();</div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>        }</div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span>    }</div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span>    <span class="keywordflow">return</span> all_passed;</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>}</div>
</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span> </div>
<div class="foldopen" id="foldopen02281" data-start="{" data-end="}">
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"><a class="line" href="classAP__GPS.html#adc760a1f109660466fae92e5380a321f"> 2281</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#adc760a1f109660466fae92e5380a321f">AP_GPS::backends_healthy</a>(<span class="keywordtype">char</span> failure_msg[], uint16_t failure_msg_len) {</div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span><span class="preprocessor">#if AP_GPS_DRONECAN_ENABLED</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1">GPS_TYPE_UAVCAN</a> ||</div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>            <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a> ||</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>            <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>) {</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>            <span class="keywordflow">if</span> (!AP_GPS_DroneCAN::backends_healthy(failure_msg, failure_msg_len)) {</div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>            }</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>        }</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a> ||</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>            <a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[i] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>) {</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>() - <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[i].gps_yaw_time_ms &gt; 15000) {</div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span>                <a class="code hl_variable" href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a>.<a class="code hl_variable" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code hl_function" href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">snprintf</a>(failure_msg, failure_msg_len, <span class="stringliteral">&quot;GPS[%u] yaw not available&quot;</span>, <span class="keywordtype">unsigned</span>(i+1));</div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>            }</div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span>        }</div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>    }</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>}</div>
</div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span> </div>
<div class="foldopen" id="foldopen02303" data-start="{" data-end="}">
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"><a class="line" href="classAP__GPS.html#afeaaca5dc2e03d6adb94588575b012f7"> 2303</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#afeaaca5dc2e03d6adb94588575b012f7">AP_GPS::logging_failed</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classAP__GPS.html#a69448953b5035758f2d32bc78a0a2561">logging_enabled</a>()) {</div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span>    }</div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span> </div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span>    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a>; i++) {</div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i] != <span class="keyword">nullptr</span>) &amp;&amp; !(<a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[i]-&gt;logging_healthy())) {</div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span>        }</div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span>    }</div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span> </div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span>}</div>
</div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span> </div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span><span class="comment">// get iTOW, if supported, zero otherwie</span></div>
<div class="foldopen" id="foldopen02318" data-start="{" data-end="}">
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a64dec4a409a0ca00fcb8f7e458ddce1d"> 2318</a></span>uint32_t <a class="code hl_function" href="classAP__GPS.html#a64dec4a409a0ca00fcb8f7e458ddce1d">AP_GPS::get_itow</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> || <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>    }</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#ab893b66bbadab6b590a0590e8a7cb878">get_last_itow_ms</a>();</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>}</div>
</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span> </div>
<div class="foldopen" id="foldopen02326" data-start="{" data-end="}">
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ae2ad6e24faf807c597055846aae3a98c"> 2326</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#ae2ad6e24faf807c597055846aae3a98c">AP_GPS::get_error_codes</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, uint32_t &amp;<a class="code hl_enumeration" href="AP__Scripting_2generator_2src_2main_8c.html#abfd51332ef0e0ba71f951a69e68e06be">error_codes</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &gt;= <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> || <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>    }</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span> </div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">drivers</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>]-&gt;<a class="code hl_function" href="classAP__GPS__Backend.html#a341aa57b0aab851500d5b3b61bc2ae33">get_error_codes</a>(<a class="code hl_enumeration" href="AP__Scripting_2generator_2src_2main_8c.html#abfd51332ef0e0ba71f951a69e68e06be">error_codes</a>);</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span>}</div>
</div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span> </div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span><span class="comment">// get the difference between WGS84 and AMSL. A positive value means</span></div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span><span class="comment">// the AMSL height is higher than WGS84 ellipsoid height</span></div>
<div class="foldopen" id="foldopen02337" data-start="{" data-end="}">
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"><a class="line" href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625"> 2337</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625">AP_GPS::get_undulation</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;undulation)<span class="keyword"> const</span></div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].have_undulation) {</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>    }</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>    undulation = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">undulation</a>;</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span>}</div>
</div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span> </div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span><span class="preprocessor">#if HAL_LOGGING_ENABLED</span></div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span><span class="comment">// Logging support:</span></div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span><span class="comment">// Write an GPS packet</span></div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span><span class="keywordtype">void</span> <a class="code hl_function" href="classAP__GPS.html#a22210502424345970c0ca3291d5d1aa1">AP_GPS::Write_GPS</a>(uint8_t i)</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>{</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>    <span class="keyword">const</span> uint64_t time_us = <a class="code hl_function" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>();</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>    <span class="keyword">const</span> <a class="code hl_class" href="classLocation.html">Location</a> &amp;loc = <a class="code hl_function" href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">location</a>(i);</div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span> </div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span>    <span class="keywordtype">float</span> yaw_deg=0, yaw_accuracy_deg=0;</div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>    uint32_t yaw_time_ms;</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span>    <a class="code hl_function" href="classAP__GPS.html#a8a76f3e0443a24ad11b645d7a765b452">gps_yaw_deg</a>(i, yaw_deg, yaw_accuracy_deg, yaw_time_ms);</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span> </div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span>    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structlog__GPS.html">log_GPS</a> pkt {</div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>        <a class="code hl_define" href="AP__Logger_2LogStructure_8h.html#abca6b52da10346c72b10dd04698e4420">LOG_PACKET_HEADER_INIT</a>(LOG_GPS_MSG),</div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>        time_us       : time_us,</div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>        <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>      : i,</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>        <a class="code hl_variable" href="routing_8cpp.html#acdef7b92239f1e607ef6caa33a16d2ed">status</a>        : (uint8_t)<a class="code hl_variable" href="routing_8cpp.html#acdef7b92239f1e607ef6caa33a16d2ed">status</a>(i),</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>        gps_week_ms   : time_week_ms(i),</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>        gps_week      : time_week(i),</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>        num_sats      : num_sats(i),</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span>        hdop          : get_hdop(i),</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>        latitude      : loc.<a class="code hl_variable" href="classLocation.html#ae51548c2cf32311043ca19b94b9a9223">lat</a>,</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>        longitude     : loc.<a class="code hl_variable" href="classLocation.html#a5831f0aca9e51a15adb96fad465f72f8">lng</a>,</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>        altitude      : loc.<a class="code hl_variable" href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a>,</div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span>        ground_speed  : ground_speed(i),</div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>        ground_course : ground_course(i),</div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>        vel_z         : velocity(i).z,</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>        yaw           : yaw_deg,</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>        used          : (uint8_t)(<a class="code hl_function" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().<a class="code hl_function" href="classAP__GPS.html#a658c400982bac280ee6d3658bf8c0060">primary_sensor</a>() == i)</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>    };</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>    <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#ada8172473eb14aabbf121c20ef6ad76b">WriteBlock</a>(&amp;pkt, <span class="keyword">sizeof</span>(pkt));</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span> </div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span>    <span class="comment">/* write auxiliary accuracy information as well */</span></div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>    <span class="keywordtype">float</span> hacc = 0, vacc = 0, sacc = 0;</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>    <span class="keywordtype">float</span> undulation = 0;</div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span>    <a class="code hl_function" href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">horizontal_accuracy</a>(i, hacc);</div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>    <a class="code hl_function" href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">vertical_accuracy</a>(i, vacc);</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>    <a class="code hl_function" href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">speed_accuracy</a>(i, sacc);</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>    <a class="code hl_function" href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625">get_undulation</a>(i, undulation);</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structlog__GPA.html">log_GPA</a> pkt2{</div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>        <a class="code hl_define" href="AP__Logger_2LogStructure_8h.html#abca6b52da10346c72b10dd04698e4420">LOG_PACKET_HEADER_INIT</a>(LOG_GPA_MSG),</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>        time_us       : time_us,</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>        <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>      : i,</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>        vdop          : get_vdop(i),</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>        hacc          : (uint16_t)<a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>((hacc*100), UINT16_MAX),</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>        vacc          : (uint16_t)<a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>((vacc*100), UINT16_MAX),</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>        sacc          : (uint16_t)<a class="code hl_define" href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>((sacc*100), UINT16_MAX),</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>        yaw_accuracy  : yaw_accuracy_deg,</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>        have_vv       : (uint8_t)have_vertical_velocity(i),</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>        sample_ms     : last_message_time_ms(i),</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>        delta_ms      : last_message_delta_time_ms(i),</div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>        undulation    : undulation,</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>        rtcm_fragments_used: rtcm_stats.fragments_used,</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>        rtcm_fragments_discarded: rtcm_stats.fragments_discarded</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>    };</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>    <a class="code hl_function" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code hl_function" href="classAP__Logger.html#ada8172473eb14aabbf121c20ef6ad76b">WriteBlock</a>(&amp;pkt2, <span class="keyword">sizeof</span>(pkt2));</div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>}</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span> </div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span><span class="comment">/*</span></div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span><span class="comment">  get GPS based yaw</span></div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen02408" data-start="{" data-end="}">
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"><a class="line" href="classAP__GPS.html#a8a76f3e0443a24ad11b645d7a765b452"> 2408</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classAP__GPS.html#a8a76f3e0443a24ad11b645d7a765b452">AP_GPS::gps_yaw_deg</a>(uint8_t <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> &amp;yaw_deg, <span class="keywordtype">float</span> &amp;accuracy_deg, uint32_t &amp;time_ms)<span class="keyword"> const</span></div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span><span class="preprocessor">#if GPS_MAX_RECEIVERS &gt; 1</span></div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> &lt; <a class="code hl_define" href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a> &amp;&amp;</div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>        ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">GPS_TYPE_UBLOX_RTK_BASE</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">GPS_TYPE_UAVCAN_RTK_BASE</a>)) &amp;&amp;</div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>        ((<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>^1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">GPS_TYPE_UBLOX_RTK_ROVER</a>) || (<a class="code hl_variable" href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">_type</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>^1] == <a class="code hl_enumvalue" href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">GPS_TYPE_UAVCAN_RTK_ROVER</a>))) {</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>        <span class="comment">// return the yaw from the rover</span></div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>        <a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a> ^= 1;</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>    }</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classAP__GPS.html#a7f7a01767467002a69f952fca557bd5d">have_gps_yaw</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)) {</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>    }</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>    yaw_deg = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a9cae846ba149e72943a98f25ce29e529">gps_yaw</a>;</div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span> </div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>    <span class="comment">// get lagged timestamp</span></div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>    time_ms = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#a0d50346e3030a6ae1a393b3f30df8c11">gps_yaw_time_ms</a>;</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>    <span class="keywordtype">float</span> lag_s;</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classAP__GPS.html#aaeb8dc7cbdae6534526a00444a53cda1">get_lag</a>(<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, lag_s)) {</div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>        uint32_t lag_ms = lag_s * 1000;</div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>        time_ms -= lag_ms;</div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span>    }</div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span> </div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].have_gps_yaw_accuracy) {</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span>        accuracy_deg = <a class="code hl_variable" href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">state</a>[<a class="code hl_variable" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code hl_variable" href="structAP__GPS_1_1GPS__State.html#ac928adf3266e5124476a2022409acd39">gps_yaw_accuracy</a>;</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>        <span class="comment">// fall back to 10 degrees as a generic default</span></div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>        accuracy_deg = 10;</div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>    }</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>}</div>
</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span> </div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceAP.html">AP</a> {</div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span> </div>
<div class="foldopen" id="foldopen02442" data-start="{" data-end="}">
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"><a class="line" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5"> 2442</a></span><a class="code hl_class" href="classAP__GPS.html">AP_GPS</a> &amp;<a class="code hl_variable" href="GPS__AUTO__test_8cpp.html#a962e3f0f8682f6dedb5a001a70bdd65e">gps</a>()</div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>{</div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span>    <span class="keywordflow">return</span> *<a class="code hl_function" href="classAP__GPS.html#a8c15102b003581f2f84119ea84ad47c3">AP_GPS::get_singleton</a>();</div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>}</div>
</div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span> </div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span>};</div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span> </div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span><span class="preprocessor">#endif  </span><span class="comment">// AP_GPS_ENABLED</span></div>
<div class="ttc" id="aAC__AttitudeControl_8cpp_html_a240c1a4ae2a70d1855f91e4a0b1ac938"><div class="ttname"><a href="AC__AttitudeControl_8cpp.html#a240c1a4ae2a70d1855f91e4a0b1ac938">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition</b> <a href="AP__Compass__AK09916_8cpp_source.html#l00059">AP_Compass_AK09916.cpp:59</a></div></div>
<div class="ttc" id="aAHRS__Test_8cpp_html_a90ddf96040cbf0429052dafd4fa64c12"><div class="ttname"><a href="AHRS__Test_8cpp.html#a90ddf96040cbf0429052dafd4fa64c12">serial_manager</a></div><div class="ttdeci">static AP_SerialManager serial_manager</div><div class="ttdef"><b>Definition</b> <a href="AHRS__Test_8cpp_source.html#l00022">AHRS_Test.cpp:22</a></div></div>
<div class="ttc" id="aAP__AHRS_8h_html"><div class="ttname"><a href="AP__AHRS_8h.html">AP_AHRS.h</a></div></div>
<div class="ttc" id="aAP__BoardConfig_8h_html"><div class="ttname"><a href="AP__BoardConfig_8h.html">AP_BoardConfig.h</a></div></div>
<div class="ttc" id="aAP__CANManager_8h_html"><div class="ttname"><a href="AP__CANManager_8h.html">AP_CANManager.h</a></div></div>
<div class="ttc" id="aAP__Common_8h_html"><div class="ttname"><a href="AP__Common_8h.html">AP_Common.h</a></div><div class="ttdoc">Common definitions and utility routines for the ArduPilot libraries.</div></div>
<div class="ttc" id="aAP__Common_8h_html_a121caf32c5b5d704ef3453f0885a9ea5"><div class="ttname"><a href="AP__Common_8h.html#a121caf32c5b5d704ef3453f0885a9ea5">ARRAY_SIZE</a></div><div class="ttdeci">#define ARRAY_SIZE(_arr)</div><div class="ttdef"><b>Definition</b> <a href="AP__Common_8h_source.html#l00099">AP_Common.h:99</a></div></div>
<div class="ttc" id="aAP__DroneCAN_8h_html"><div class="ttname"><a href="AP__DroneCAN_8h.html">AP_DroneCAN.h</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_a2d79705911859d95849c965ef469c5fb"><div class="ttname"><a href="AP__GPS_8cpp.html#a2d79705911859d95849c965ef469c5fb">GPS_MAX_RATE_MS</a></div><div class="ttdeci">#define GPS_MAX_RATE_MS</div><div class="ttdef"><b>Definition</b> <a href="#l00064">AP_GPS.cpp:64</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_a2f6d184a58b49c746340c1139bd6e0ea"><div class="ttname"><a href="AP__GPS_8cpp.html#a2f6d184a58b49c746340c1139bd6e0ea">GPS_BAUD_TIME_MS</a></div><div class="ttdeci">#define GPS_BAUD_TIME_MS</div><div class="ttdef"><b>Definition</b> <a href="#l00066">AP_GPS.cpp:66</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_a2f89c2cb9e2d16e7cebb42b9e313b05e"><div class="ttname"><a href="AP__GPS_8cpp.html#a2f89c2cb9e2d16e7cebb42b9e313b05e">BLEND_COUNTER_FAILURE_INCREMENT</a></div><div class="ttdeci">#define BLEND_COUNTER_FAILURE_INCREMENT</div><div class="ttdef"><b>Definition</b> <a href="#l00073">AP_GPS.cpp:73</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_a5c474882dc169c97221822426d3d48ed"><div class="ttname"><a href="AP__GPS_8cpp.html#a5c474882dc169c97221822426d3d48ed">BLEND_MASK_USE_VPOS_ACC</a></div><div class="ttdeci">#define BLEND_MASK_USE_VPOS_ACC</div><div class="ttdef"><b>Definition</b> <a href="#l00071">AP_GPS.cpp:71</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_a978c948cab76954876c053044ed16ab8"><div class="ttname"><a href="AP__GPS_8cpp.html#a978c948cab76954876c053044ed16ab8">HAL_GPS_COM_PORT_DEFAULT</a></div><div class="ttdeci">#define HAL_GPS_COM_PORT_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="#l00076">AP_GPS.cpp:76</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__GPS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition</b> <a href="AC__PID__test_8cpp_source.html#l00021">AC_PID_test.cpp:21</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_aed01677f1b1efe774fa22e838b84f5db"><div class="ttname"><a href="AP__GPS_8cpp.html#aed01677f1b1efe774fa22e838b84f5db">GPS_TIMEOUT_MS</a></div><div class="ttdeci">#define GPS_TIMEOUT_MS</div><div class="ttdef"><b>Definition</b> <a href="#l00067">AP_GPS.cpp:67</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_af2a2b9d86200a37152ed36817f914ac7"><div class="ttname"><a href="AP__GPS_8cpp.html#af2a2b9d86200a37152ed36817f914ac7">BLEND_MASK_USE_HPOS_ACC</a></div><div class="ttdeci">#define BLEND_MASK_USE_HPOS_ACC</div><div class="ttdef"><b>Definition</b> <a href="#l00070">AP_GPS.cpp:70</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_af3476ae7cb8c401b7d55ab98b86ed292"><div class="ttname"><a href="AP__GPS_8cpp.html#af3476ae7cb8c401b7d55ab98b86ed292">BLEND_MASK_USE_SPD_ACC</a></div><div class="ttdeci">#define BLEND_MASK_USE_SPD_ACC</div><div class="ttdef"><b>Definition</b> <a href="#l00072">AP_GPS.cpp:72</a></div></div>
<div class="ttc" id="aAP__GPS_8cpp_html_af476b309d3827917a4217a393c7bb6ed"><div class="ttname"><a href="AP__GPS_8cpp.html#af476b309d3827917a4217a393c7bb6ed">GPS_RTK_INJECT_TO_ALL</a></div><div class="ttdeci">#define GPS_RTK_INJECT_TO_ALL</div><div class="ttdef"><b>Definition</b> <a href="#l00062">AP_GPS.cpp:62</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html"><div class="ttname"><a href="AP__GPS_8h.html">AP_GPS.h</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html_a2839bf7ed0174a57ff427a229c04e8c6"><div class="ttname"><a href="AP__GPS_8h.html#a2839bf7ed0174a57ff427a229c04e8c6">GPS_BLENDED_INSTANCE</a></div><div class="ttdeci">#define GPS_BLENDED_INSTANCE</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00053">AP_GPS.h:53</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html_a3a734b4d4de7ca88c6563a5a476e3e87"><div class="ttname"><a href="AP__GPS_8h.html#a3a734b4d4de7ca88c6563a5a476e3e87">GPS_MAX_INSTANCES</a></div><div class="ttdeci">#define GPS_MAX_INSTANCES</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00042">AP_GPS.h:42</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html_a6012722790893e4ac6b414c0b2fcd2dd"><div class="ttname"><a href="AP__GPS_8h.html#a6012722790893e4ac6b414c0b2fcd2dd">GPS_MAX_RECEIVERS</a></div><div class="ttdeci">#define GPS_MAX_RECEIVERS</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00038">AP_GPS.h:38</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html_ac159cf063a7c67cf309fa8939df8f727"><div class="ttname"><a href="AP__GPS_8h.html#ac159cf063a7c67cf309fa8939df8f727">UNIX_OFFSET_MSEC</a></div><div class="ttdeci">#define UNIX_OFFSET_MSEC</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00060">AP_GPS.h:60</a></div></div>
<div class="ttc" id="aAP__GPS_8h_html_adcf9fb3187691bb28ccf836a46d493ce"><div class="ttname"><a href="AP__GPS_8h.html#adcf9fb3187691bb28ccf836a46d493ce">GPS_UNKNOWN_DOP</a></div><div class="ttdeci">#define GPS_UNKNOWN_DOP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00055">AP_GPS.h:55</a></div></div>
<div class="ttc" id="aAP__GPS__DroneCAN_8h_html"><div class="ttname"><a href="AP__GPS__DroneCAN_8h.html">AP_GPS_DroneCAN.h</a></div></div>
<div class="ttc" id="aAP__GPS__ERB_8h_html"><div class="ttname"><a href="AP__GPS__ERB_8h.html">AP_GPS_ERB.h</a></div></div>
<div class="ttc" id="aAP__GPS__ExternalAHRS_8h_html"><div class="ttname"><a href="AP__GPS__ExternalAHRS_8h.html">AP_GPS_ExternalAHRS.h</a></div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html"><div class="ttname"><a href="AP__GPS__FixType_8h.html">AP_GPS_FixType.h</a></div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3ea30c7710c25275d763c683f6225669d61"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea30c7710c25275d763c683f6225669d61">AP_GPS_FixType::DGPS</a></div><div class="ttdeci">@ DGPS</div><div class="ttdoc">Receiving valid messages and 3D lock with differential improvements.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3ea5eddc8631075de75c679f84846de5d51"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea5eddc8631075de75c679f84846de5d51">AP_GPS_FixType::FIX_3D</a></div><div class="ttdeci">@ FIX_3D</div><div class="ttdoc">Receiving valid messages and 3D lock.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3ea84a1c7916079717125c4cd668a592b2f"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea84a1c7916079717125c4cd668a592b2f">AP_GPS_FixType::NO_GPS</a></div><div class="ttdeci">@ NO_GPS</div><div class="ttdoc">No GPS connected/detected.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3ea8b433e3f63d83e78dfbfe6da3ff61b3e"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3ea8b433e3f63d83e78dfbfe6da3ff61b3e">AP_GPS_FixType::FIX_2D</a></div><div class="ttdeci">@ FIX_2D</div><div class="ttdoc">Receiving valid messages and 2D lock.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3eaa6cd12e20d6e5f57b84e8e4987d747de"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eaa6cd12e20d6e5f57b84e8e4987d747de">AP_GPS_FixType::RTK_FLOAT</a></div><div class="ttdeci">@ RTK_FLOAT</div><div class="ttdoc">Receiving valid messages and 3D RTK Float.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3eab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eab50339a10e1de285ac99d4c3990b8693">AP_GPS_FixType::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">Receiving valid GPS messages but no lock.</div></div>
<div class="ttc" id="aAP__GPS__FixType_8h_html_a62d277e362207c233f4551d9aa6f5f3eadfe0799953f0252fef00578e7e4c0122"><div class="ttname"><a href="AP__GPS__FixType_8h.html#a62d277e362207c233f4551d9aa6f5f3eadfe0799953f0252fef00578e7e4c0122">AP_GPS_FixType::RTK_FIXED</a></div><div class="ttdeci">@ RTK_FIXED</div><div class="ttdoc">Receiving valid messages and 3D RTK Fixed.</div></div>
<div class="ttc" id="aAP__GPS__GSOF_8h_html"><div class="ttname"><a href="AP__GPS__GSOF_8h.html">AP_GPS_GSOF.h</a></div></div>
<div class="ttc" id="aAP__GPS__MAV_8h_html"><div class="ttname"><a href="AP__GPS__MAV_8h.html">AP_GPS_MAV.h</a></div></div>
<div class="ttc" id="aAP__GPS__MSP_8h_html"><div class="ttname"><a href="AP__GPS__MSP_8h.html">AP_GPS_MSP.h</a></div></div>
<div class="ttc" id="aAP__GPS__NMEA_8h_html"><div class="ttname"><a href="AP__GPS__NMEA_8h.html">AP_GPS_NMEA.h</a></div><div class="ttdoc">NMEA protocol parser.</div></div>
<div class="ttc" id="aAP__GPS__NMEA_8h_html_ac689e8f0a43a8356808dd84cf6e49405"><div class="ttname"><a href="AP__GPS__NMEA_8h.html#ac689e8f0a43a8356808dd84cf6e49405">NMEA_UNICORE_SETUP</a></div><div class="ttdeci">#define NMEA_UNICORE_SETUP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__NMEA_8h_source.html#l00270">AP_GPS_NMEA.h:270</a></div></div>
<div class="ttc" id="aAP__GPS__NOVA_8h_html"><div class="ttname"><a href="AP__GPS__NOVA_8h.html">AP_GPS_NOVA.h</a></div></div>
<div class="ttc" id="aAP__GPS__SBF_8h_html"><div class="ttname"><a href="AP__GPS__SBF_8h.html">AP_GPS_SBF.h</a></div></div>
<div class="ttc" id="aAP__GPS__SBP2_8h_html"><div class="ttname"><a href="AP__GPS__SBP2_8h.html">AP_GPS_SBP2.h</a></div></div>
<div class="ttc" id="aAP__GPS__SBP_8h_html"><div class="ttname"><a href="AP__GPS__SBP_8h.html">AP_GPS_SBP.h</a></div></div>
<div class="ttc" id="aAP__GPS__SIRF_8h_html"><div class="ttname"><a href="AP__GPS__SIRF_8h.html">AP_GPS_SIRF.h</a></div></div>
<div class="ttc" id="aAP__GPS__SIRF_8h_html_a688aa025e0239993674de15fccc32285"><div class="ttname"><a href="AP__GPS__SIRF_8h.html#a688aa025e0239993674de15fccc32285">SIRF_SET_BINARY</a></div><div class="ttdeci">#define SIRF_SET_BINARY</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__SIRF_8h_source.html#l00030">AP_GPS_SIRF.h:30</a></div></div>
<div class="ttc" id="aAP__GPS__SITL_8h_html"><div class="ttname"><a href="AP__GPS__SITL_8h.html">AP_GPS_SITL.h</a></div></div>
<div class="ttc" id="aAP__GPS__UBLOX_8h_html"><div class="ttname"><a href="AP__GPS__UBLOX_8h.html">AP_GPS_UBLOX.h</a></div></div>
<div class="ttc" id="aAP__GPS__UBLOX_8h_html_a4fd0964100b1185ec9b0b36adc4418cf"><div class="ttname"><a href="AP__GPS__UBLOX_8h.html#a4fd0964100b1185ec9b0b36adc4418cf">UBLOX_SET_BINARY_115200</a></div><div class="ttdeci">#define UBLOX_SET_BINARY_115200</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__UBLOX_8h_source.html#l00050">AP_GPS_UBLOX.h:50</a></div></div>
<div class="ttc" id="aAP__GPS__UBLOX_8h_html_a6dcaff1e4e8070d32d636550027b847e"><div class="ttname"><a href="AP__GPS__UBLOX_8h.html#a6dcaff1e4e8070d32d636550027b847e">UBLOX_SET_BINARY_230400</a></div><div class="ttdeci">#define UBLOX_SET_BINARY_230400</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__UBLOX_8h_source.html#l00053">AP_GPS_UBLOX.h:53</a></div></div>
<div class="ttc" id="aAP__GPS__UBLOX_8h_html_a88b3bc83453a82dceca74f68efa8bdf0"><div class="ttname"><a href="AP__GPS__UBLOX_8h.html#a88b3bc83453a82dceca74f68efa8bdf0">UBLOX_SET_BINARY_460800</a></div><div class="ttdeci">#define UBLOX_SET_BINARY_460800</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__UBLOX_8h_source.html#l00056">AP_GPS_UBLOX.h:56</a></div></div>
<div class="ttc" id="aAP__GPS__config_8h_html"><div class="ttname"><a href="AP__GPS__config_8h.html">AP_GPS_config.h</a></div></div>
<div class="ttc" id="aAP__GPS__config_8h_html_ab9a9b49ce4f235d8c34a4fb7366b9681"><div class="ttname"><a href="AP__GPS__config_8h.html#ab9a9b49ce4f235d8c34a4fb7366b9681">AP_GPS_NMEA_UNICORE_ENABLED</a></div><div class="ttdeci">#define AP_GPS_NMEA_UNICORE_ENABLED</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__config_8h_source.html#l00039">AP_GPS_config.h:39</a></div></div>
<div class="ttc" id="aAP__HAL_2Semaphores_8h_html_a819dd9ac6de800cdf1014b0a922b67d4"><div class="ttname"><a href="AP__HAL_2Semaphores_8h.html#a819dd9ac6de800cdf1014b0a922b67d4">WITH_SEMAPHORE</a></div><div class="ttdeci">#define WITH_SEMAPHORE(sem)</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Semaphores_8h_source.html#l00054">Semaphores.h:54</a></div></div>
<div class="ttc" id="aAP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="aAP__HAL__Boards_8h_html_a3c0c1b7e4574fd0e968689e687c28dc3"><div class="ttname"><a href="AP__HAL__Boards_8h.html#a3c0c1b7e4574fd0e968689e687c28dc3">HAL_GPS_TYPE_DEFAULT</a></div><div class="ttdeci">#define HAL_GPS_TYPE_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__Boards_8h_source.html#l00215">AP_HAL_Boards.h:215</a></div></div>
<div class="ttc" id="aAP__InternalError_8cpp_html_a02ad7a50d04e0dbf28c6c90a183a0579"><div class="ttname"><a href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a></div><div class="ttdeci">static AP_InternalError instance</div><div class="ttdef"><b>Definition</b> <a href="AP__InternalError_8cpp_source.html#l00015">AP_InternalError.cpp:15</a></div></div>
<div class="ttc" id="aAP__Logger_2LogStructure_8h_html_abca6b52da10346c72b10dd04698e4420"><div class="ttname"><a href="AP__Logger_2LogStructure_8h.html#abca6b52da10346c72b10dd04698e4420">LOG_PACKET_HEADER_INIT</a></div><div class="ttdeci">#define LOG_PACKET_HEADER_INIT(id)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_2LogStructure_8h_source.html#l00116">LogStructure.h:116</a></div></div>
<div class="ttc" id="aAP__Logger_8h_html"><div class="ttname"><a href="AP__Logger_8h.html">AP_Logger.h</a></div></div>
<div class="ttc" id="aAP__Logger_8h_html_abfb7fdeeabd95c90488508e20c5ea981a6a80c86862bba23d6fbeda62ac6825a4"><div class="ttname"><a href="AP__Logger_8h.html#abfb7fdeeabd95c90488508e20c5ea981a6a80c86862bba23d6fbeda62ac6825a4">LogEvent::GPS_PRIMARY_CHANGED</a></div><div class="ttdeci">@ GPS_PRIMARY_CHANGED</div></div>
<div class="ttc" id="aAP__Math_8cpp_html_ad2245faee11bdecf357553e7807dc068"><div class="ttname"><a href="AP__Math_8cpp.html#ad2245faee11bdecf357553e7807dc068">wrap_360</a></div><div class="ttdeci">float wrap_360(const float angle)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00181">AP_Math.cpp:181</a></div></div>
<div class="ttc" id="aAP__Math_8cpp_html_af836ccbc389735a6f129d85126eab30a"><div class="ttname"><a href="AP__Math_8cpp.html#af836ccbc389735a6f129d85126eab30a">wrap_360_cd</a></div><div class="ttdeci">float wrap_360_cd(const float angle)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8cpp_source.html#l00210">AP_Math.cpp:210</a></div></div>
<div class="ttc" id="aAP__Math_8h_html"><div class="ttname"><a href="AP__Math_8h.html">AP_Math.h</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a34f41fcf2bc527b1728ae04423dfba46"><div class="ttname"><a href="AP__Math_8h.html#a34f41fcf2bc527b1728ae04423dfba46">sq</a></div><div class="ttdeci">ftype sq(const T val)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00225">AP_Math.h:225</a></div></div>
<div class="ttc" id="aAP__Math_8h_html_a4e3ae698e8f99cec214348ad233e3c41"><div class="ttname"><a href="AP__Math_8h.html#a4e3ae698e8f99cec214348ad233e3c41">is_positive</a></div><div class="ttdeci">bool is_positive(const T fVal1)</div><div class="ttdef"><b>Definition</b> <a href="AP__Math_8h_source.html#l00063">AP_Math.h:63</a></div></div>
<div class="ttc" id="aAP__Notify_8h_html"><div class="ttname"><a href="AP__Notify_8h.html">AP_Notify.h</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00163">AP_Param.h:163</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a16c360358c5d6a08d34f60921fd916a9"><div class="ttname"><a href="AP__Param_8h.html#a16c360358c5d6a08d34f60921fd916a9">AP_SUBGROUPINFO</a></div><div class="ttdeci">#define AP_SUBGROUPINFO(element, name, idx, thisclazz, elclazz)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00152">AP_Param.h:152</a></div></div>
<div class="ttc" id="aAP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00145">AP_Param.h:145</a></div></div>
<div class="ttc" id="aAP__RTC_8h_html"><div class="ttname"><a href="AP__RTC_8h.html">AP_RTC.h</a></div></div>
<div class="ttc" id="aAP__Scripting_2generator_2src_2main_8c_html_abfd51332ef0e0ba71f951a69e68e06be"><div class="ttname"><a href="AP__Scripting_2generator_2src_2main_8c.html#abfd51332ef0e0ba71f951a69e68e06be">error_codes</a></div><div class="ttdeci">error_codes</div><div class="ttdef"><b>Definition</b> <a href="AP__Scripting_2generator_2src_2main_8c_source.html#l00055">main.c:55</a></div></div>
<div class="ttc" id="aAP__SerialManager_8h_html"><div class="ttname"><a href="AP__SerialManager_8h.html">AP_SerialManager.h</a></div></div>
<div class="ttc" id="aBusTest_8cpp_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition</b> <a href="BusTest_8cpp_source.html#l00011">BusTest.cpp:11</a></div></div>
<div class="ttc" id="aGCS_8h_html"><div class="ttname"><a href="GCS_8h.html">GCS.h</a></div><div class="ttdoc">Interface definition for the various Ground Control System.</div></div>
<div class="ttc" id="aGCS_8h_html_a266bfe8eda675e1092f045e93932b4a6"><div class="ttname"><a href="GCS_8h.html#a266bfe8eda675e1092f045e93932b4a6">GCS_SEND_TEXT</a></div><div class="ttdeci">#define GCS_SEND_TEXT(severity, format, args...)</div><div class="ttdef"><b>Definition</b> <a href="GCS_8h_source.html#l01349">GCS.h:1349</a></div></div>
<div class="ttc" id="aGCS__MAVLink_8h_html_aff625e94451bf446bdd56f5d0e081077"><div class="ttname"><a href="GCS__MAVLink_8h.html#aff625e94451bf446bdd56f5d0e081077">MAVLINK_COMM_NUM_BUFFERS</a></div><div class="ttdeci">#define MAVLINK_COMM_NUM_BUFFERS</div><div class="ttdef"><b>Definition</b> <a href="GCS__MAVLink_8h_source.html#l00023">GCS_MAVLink.h:23</a></div></div>
<div class="ttc" id="aGPS__AUTO__test_8cpp_html_a962e3f0f8682f6dedb5a001a70bdd65e"><div class="ttname"><a href="GPS__AUTO__test_8cpp.html#a962e3f0f8682f6dedb5a001a70bdd65e">gps</a></div><div class="ttdeci">static AP_GPS gps</div><div class="ttdef"><b>Definition</b> <a href="GPS__AUTO__test_8cpp_source.html#l00053">GPS_AUTO_test.cpp:53</a></div></div>
<div class="ttc" id="aGPS__Backend_8h_html"><div class="ttname"><a href="GPS__Backend_8h.html">GPS_Backend.h</a></div></div>
<div class="ttc" id="aPrintf_8cpp_html_a5558580ea8d3854253a721ee58cff12d"><div class="ttname"><a href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a></div><div class="ttdeci">const char * result</div><div class="ttdef"><b>Definition</b> <a href="Printf_8cpp_source.html#l00038">Printf.cpp:38</a></div></div>
<div class="ttc" id="aRTCM3__Parser_8h_html"><div class="ttname"><a href="RTCM3__Parser_8h.html">RTCM3_Parser.h</a></div></div>
<div class="ttc" id="aReplayGyroFFT_8cpp_html_a9fede12aaeb5750bcb131cae0430647c"><div class="ttname"><a href="ReplayGyroFFT_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a></div><div class="ttdeci">static AP_Logger logger</div><div class="ttdef"><b>Definition</b> <a href="ReplayGyroFFT_8cpp_source.html#l00032">ReplayGyroFFT.cpp:32</a></div></div>
<div class="ttc" id="aardupilot__SITL__QUAD_8h_html_a2c17dfa2b3239f2312e94b9de57a7999"><div class="ttname"><a href="ardupilot__SITL__QUAD_8h.html#a2c17dfa2b3239f2312e94b9de57a7999">timestamp</a></div><div class="ttdeci">double timestamp</div><div class="ttdef"><b>Definition</b> <a href="ardupilot__SITL__QUAD_8h_source.html#l00042">ardupilot_SITL_QUAD.h:42</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html"><div class="ttname"><a href="classAP__GPS__Backend.html">AP_GPS_Backend</a></div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00049">GPS_Backend.h:50</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a1bbca91e9e762d373c1a4b6c0d958ca1"><div class="ttname"><a href="classAP__GPS__Backend.html#a1bbca91e9e762d373c1a4b6c0d958ca1">AP_GPS_Backend::broadcast_configuration_failure_reason</a></div><div class="ttdeci">virtual void broadcast_configuration_failure_reason(void) const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00078">GPS_Backend.h:78</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a1d0f842ede7aff19b688f948d8d9231b"><div class="ttname"><a href="classAP__GPS__Backend.html#a1d0f842ede7aff19b688f948d8d9231b">AP_GPS_Backend::inject_data</a></div><div class="ttdeci">virtual void inject_data(const uint8_t *data, uint16_t len)</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8cpp_source.html#l00120">GPS_Backend.cpp:120</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a2d73140d3b37b74b167a95deae6c213c"><div class="ttname"><a href="classAP__GPS__Backend.html#a2d73140d3b37b74b167a95deae6c213c">AP_GPS_Backend::Write_AP_Logger_Log_Startup_messages</a></div><div class="ttdeci">virtual void Write_AP_Logger_Log_Startup_messages() const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8cpp_source.html#l00159">GPS_Backend.cpp:159</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a341aa57b0aab851500d5b3b61bc2ae33"><div class="ttname"><a href="classAP__GPS__Backend.html#a341aa57b0aab851500d5b3b61bc2ae33">AP_GPS_Backend::get_error_codes</a></div><div class="ttdeci">virtual bool get_error_codes(uint32_t &amp;error_codes) const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00106">GPS_Backend.h:106</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a3b19a929f00d465fd3aca9c0ae1fcaa7"><div class="ttname"><a href="classAP__GPS__Backend.html#a3b19a929f00d465fd3aca9c0ae1fcaa7">AP_GPS_Backend::broadcast_gps_type</a></div><div class="ttdeci">void broadcast_gps_type() const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8cpp_source.html#l00152">GPS_Backend.cpp:152</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a42195424a7f5664b2240133ebc22b2cd"><div class="ttname"><a href="classAP__GPS__Backend.html#a42195424a7f5664b2240133ebc22b2cd">AP_GPS_Backend::prepare_for_arming</a></div><div class="ttdeci">virtual bool prepare_for_arming(void)</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00100">GPS_Backend.h:100</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a4da5fd4a69edd3a0a393e74cc0ca391a"><div class="ttname"><a href="classAP__GPS__Backend.html#a4da5fd4a69edd3a0a393e74cc0ca391a">AP_GPS_Backend::read</a></div><div class="ttdeci">virtual bool read()=0</div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a537b2420185215ce22358e93f8c73e62"><div class="ttname"><a href="classAP__GPS__Backend.html#a537b2420185215ce22358e93f8c73e62">AP_GPS_Backend::get_lag</a></div><div class="ttdeci">virtual bool get_lag(float &amp;lag) const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00088">GPS_Backend.h:88</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a7fe9c23afd9cb1b88b61ce33bf0dd37c"><div class="ttname"><a href="classAP__GPS__Backend.html#a7fe9c23afd9cb1b88b61ce33bf0dd37c">AP_GPS_Backend::is_healthy</a></div><div class="ttdeci">virtual bool is_healthy(void) const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00091">GPS_Backend.h:91</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_a8c5b16c4ac289e283effa184eb9df9c8"><div class="ttname"><a href="classAP__GPS__Backend.html#a8c5b16c4ac289e283effa184eb9df9c8">AP_GPS_Backend::highest_supported_status</a></div><div class="ttdeci">virtual AP_GPS::GPS_Status highest_supported_status(void)</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00065">GPS_Backend.h:65</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_ab005555424a4402c8fa70453250aeb94"><div class="ttname"><a href="classAP__GPS__Backend.html#ab005555424a4402c8fa70453250aeb94">AP_GPS_Backend::get_RTCMV3</a></div><div class="ttdeci">virtual bool get_RTCMV3(const uint8_t *&amp;bytes, uint16_t &amp;len)</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00103">GPS_Backend.h:103</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_ab893b66bbadab6b590a0590e8a7cb878"><div class="ttname"><a href="classAP__GPS__Backend.html#ab893b66bbadab6b590a0590e8a7cb878">AP_GPS_Backend::get_last_itow_ms</a></div><div class="ttdeci">uint32_t get_last_itow_ms(void) const</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8cpp_source.html#l00089">GPS_Backend.cpp:89</a></div></div>
<div class="ttc" id="aclassAP__GPS__Backend_html_ad818b3808dd04d4135b5c1ee96194878"><div class="ttname"><a href="classAP__GPS__Backend.html#ad818b3808dd04d4135b5c1ee96194878">AP_GPS_Backend::clear_RTCMV3</a></div><div class="ttdeci">virtual void clear_RTCMV3(void)</div><div class="ttdef"><b>Definition</b> <a href="GPS__Backend_8h_source.html#l00104">GPS_Backend.h:104</a></div></div>
<div class="ttc" id="aclassAP__GPS__ERB_html_a4ddd7b585ea06578c407d19d6d3964c5"><div class="ttname"><a href="classAP__GPS__ERB.html#a4ddd7b585ea06578c407d19d6d3964c5">AP_GPS_ERB::_detect</a></div><div class="ttdeci">static bool _detect(struct ERB_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__ERB_8cpp_source.html#l00246">AP_GPS_ERB.cpp:246</a></div></div>
<div class="ttc" id="aclassAP__GPS__NMEA_html_a14edc53eb3e6907cba8b59832c69fd33"><div class="ttname"><a href="classAP__GPS__NMEA.html#a14edc53eb3e6907cba8b59832c69fd33">AP_GPS_NMEA::_detect</a></div><div class="ttdeci">static bool _detect(struct NMEA_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__NMEA_8cpp_source.html#l00802">AP_GPS_NMEA.cpp:802</a></div></div>
<div class="ttc" id="aclassAP__GPS__SBP2_html_aa7c133a66a1d1b717fced68f92dcec14"><div class="ttname"><a href="classAP__GPS__SBP2.html#aa7c133a66a1d1b717fced68f92dcec14">AP_GPS_SBP2::_detect</a></div><div class="ttdeci">static bool _detect(struct SBP2_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__SBP2_8cpp_source.html#l00374">AP_GPS_SBP2.cpp:374</a></div></div>
<div class="ttc" id="aclassAP__GPS__SBP_html_ae1ae391d424ba0cc24b0b8b70a263bcc"><div class="ttname"><a href="classAP__GPS__SBP.html#ae1ae391d424ba0cc24b0b8b70a263bcc">AP_GPS_SBP::_detect</a></div><div class="ttdeci">static bool _detect(struct SBP_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__SBP_8cpp_source.html#l00322">AP_GPS_SBP.cpp:322</a></div></div>
<div class="ttc" id="aclassAP__GPS__SIRF_html_a99c1e4f27c9077aaadead6cc6ad031a0"><div class="ttname"><a href="classAP__GPS__SIRF.html#a99c1e4f27c9077aaadead6cc6ad031a0">AP_GPS_SIRF::_detect</a></div><div class="ttdeci">static bool _detect(struct SIRF_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__SIRF_8cpp_source.html#l00211">AP_GPS_SIRF.cpp:211</a></div></div>
<div class="ttc" id="aclassAP__GPS__UBLOX_html_abd6e355abac6f9d1914591b92298395b"><div class="ttname"><a href="classAP__GPS__UBLOX.html#abd6e355abac6f9d1914591b92298395b">AP_GPS_UBLOX::_detect</a></div><div class="ttdeci">static bool _detect(struct UBLOX_detect_state &amp;state, uint8_t data)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS__UBLOX_8cpp_source.html#l01963">AP_GPS_UBLOX.cpp:1963</a></div></div>
<div class="ttc" id="aclassAP__GPS_html"><div class="ttname"><a href="classAP__GPS.html">AP_GPS</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00075">AP_GPS.h:76</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a0101b0a077933c5bcbb15a6d63a03d07"><div class="ttname"><a href="classAP__GPS.html#a0101b0a077933c5bcbb15a6d63a03d07">AP_GPS::get_type</a></div><div class="ttdeci">GPS_Type get_type(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00566">AP_GPS.h:566</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a09de09009fdec7d5242a04adeb7f842c"><div class="ttname"><a href="classAP__GPS.html#a09de09009fdec7d5242a04adeb7f842c">AP_GPS::_blended_antenna_offset</a></div><div class="ttdeci">Vector3f _blended_antenna_offset</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00744">AP_GPS.h:744</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a0a502425e4595848f264607483c4e1a4"><div class="ttname"><a href="classAP__GPS.html#a0a502425e4595848f264607483c4e1a4">AP_GPS::last_message_epoch_usec</a></div><div class="ttdeci">uint64_t last_message_epoch_usec() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00520">AP_GPS.h:520</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a0f6a558f34555f38daf4920d4ce87636"><div class="ttname"><a href="classAP__GPS.html#a0f6a558f34555f38daf4920d4ce87636">AP_GPS::send_blob_start</a></div><div class="ttdeci">void send_blob_start(uint8_t instance)</div><div class="ttdef"><b>Definition</b> <a href="#l00614">AP_GPS.cpp:614</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a10564ab5cea24ce00f9fd6f641fe339a"><div class="ttname"><a href="classAP__GPS.html#a10564ab5cea24ce00f9fd6f641fe339a">AP_GPS::_blend_mask</a></div><div class="ttdeci">AP_Int8 _blend_mask</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00609">AP_GPS.h:609</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a12625bc53d5bcca1e07ce2c8e7ac20d6"><div class="ttname"><a href="classAP__GPS.html#a12625bc53d5bcca1e07ce2c8e7ac20d6">AP_GPS::highest_supported_status</a></div><div class="ttdeci">GPS_Status highest_supported_status(uint8_t instance) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition</b> <a href="#l00903">AP_GPS.cpp:903</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a12fd0a2da4293937493788aca7a55de6"><div class="ttname"><a href="classAP__GPS.html#a12fd0a2da4293937493788aca7a55de6">AP_GPS::AP_GPS_ExternalAHRS</a></div><div class="ttdeci">friend class AP_GPS_ExternalAHRS</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00081">AP_GPS.h:81</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a13771e63e584a3bca073142b10316c05"><div class="ttname"><a href="classAP__GPS.html#a13771e63e584a3bca073142b10316c05">AP_GPS::time_epoch_usec</a></div><div class="ttdeci">uint64_t time_epoch_usec(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00515">AP_GPS.h:515</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a140352d7577fa9b73ca2049526fbd269"><div class="ttname"><a href="classAP__GPS.html#a140352d7577fa9b73ca2049526fbd269">AP_GPS::location</a></div><div class="ttdeci">const Location &amp; location() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00316">AP_GPS.h:316</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a145c5605ca4a49f0ae8a0936706ca221"><div class="ttname"><a href="classAP__GPS.html#a145c5605ca4a49f0ae8a0936706ca221">AP_GPS::_delay_ms</a></div><div class="ttdeci">AP_Int16 _delay_ms[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00607">AP_GPS.h:607</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a1673a3811b1c622d90db33b223950557"><div class="ttname"><a href="classAP__GPS.html#a1673a3811b1c622d90db33b223950557">AP_GPS::get_vdop</a></div><div class="ttdeci">uint16_t get_vdop() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00426">AP_GPS.h:426</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a190bec437911b52d02d6b2aa499fb86a"><div class="ttname"><a href="classAP__GPS.html#a190bec437911b52d02d6b2aa499fb86a">AP_GPS::have_gps_yaw_configured</a></div><div class="ttdeci">bool have_gps_yaw_configured(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00475">AP_GPS.h:475</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a1b88be4642982ed39abefd25e9f38003"><div class="ttname"><a href="classAP__GPS.html#a1b88be4642982ed39abefd25e9f38003">AP_GPS::_initialisation_blob</a></div><div class="ttdeci">static const char _initialisation_blob[]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00699">AP_GPS.h:699</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a1edd7dcbf000c4d7cc4c2848e5ecf088"><div class="ttname"><a href="classAP__GPS.html#a1edd7dcbf000c4d7cc4c2848e5ecf088">AP_GPS::time_week</a></div><div class="ttdeci">uint16_t time_week() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00410">AP_GPS.h:410</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a20b3824173929aaffa4eba5943e4bf0b"><div class="ttname"><a href="classAP__GPS.html#a20b3824173929aaffa4eba5943e4bf0b">AP_GPS::inject_MBL_data</a></div><div class="ttdeci">void inject_MBL_data(uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition</b> <a href="#l01117">AP_GPS.cpp:1117</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a211bad61144989f47cbb56ddd1f41c16"><div class="ttname"><a href="classAP__GPS.html#a211bad61144989f47cbb56ddd1f41c16">AP_GPS::_force_disable_gps</a></div><div class="ttdeci">bool _force_disable_gps</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00785">AP_GPS.h:785</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a22210502424345970c0ca3291d5d1aa1"><div class="ttname"><a href="classAP__GPS.html#a22210502424345970c0ca3291d5d1aa1">AP_GPS::Write_GPS</a></div><div class="ttdeci">void Write_GPS(uint8_t instance)</div></div>
<div class="ttc" id="aclassAP__GPS_html_a23a9fce42abaf8f53d5a3f64c84461e7"><div class="ttname"><a href="classAP__GPS.html#a23a9fce42abaf8f53d5a3f64c84461e7">AP_GPS::status</a></div><div class="ttdeci">GPS_Status status(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00282">AP_GPS.h:282</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a24ab7def0009b4aa846163e9b9704338"><div class="ttname"><a href="classAP__GPS.html#a24ab7def0009b4aa846163e9b9704338">AP_GPS::broadcast_first_configuration_failure_reason</a></div><div class="ttdeci">void broadcast_first_configuration_failure_reason(void) const</div><div class="ttdef"><b>Definition</b> <a href="#l01565">AP_GPS.cpp:1565</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a2632887b489c6de665ca309836a443f7"><div class="ttname"><a href="classAP__GPS.html#a2632887b489c6de665ca309836a443f7">AP_GPS::num_instances</a></div><div class="ttdeci">uint8_t num_instances</div><div class="ttdoc">number of GPS instances present</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00674">AP_GPS.h:674</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a266ef4a39f7a303fc1905bf7f9e4ed09"><div class="ttname"><a href="classAP__GPS.html#a266ef4a39f7a303fc1905bf7f9e4ed09">AP_GPS::send_mavlink_gps_raw</a></div><div class="ttdeci">void send_mavlink_gps_raw(mavlink_channel_t chan)</div><div class="ttdef"><b>Definition</b> <a href="#l01465">AP_GPS.cpp:1465</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a26a409b50f1bbf539088095d4eb78092"><div class="ttname"><a href="classAP__GPS.html#a26a409b50f1bbf539088095d4eb78092">AP_GPS::handle_gps_rtcm_data</a></div><div class="ttdeci">void handle_gps_rtcm_data(mavlink_channel_t chan, const mavlink_message_t &amp;msg)</div><div class="ttdef"><b>Definition</b> <a href="#l01683">AP_GPS.cpp:1683</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a27bb197524818a82bd813d22a6b0c1b5"><div class="ttname"><a href="classAP__GPS.html#a27bb197524818a82bd813d22a6b0c1b5">AP_GPS::lock_port</a></div><div class="ttdeci">void lock_port(uint8_t instance, bool locked)</div><div class="ttdef"><b>Definition</b> <a href="#l01405">AP_GPS.cpp:1405</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a292dd764eb38dab205786a85e8ee7203"><div class="ttname"><a href="classAP__GPS.html#a292dd764eb38dab205786a85e8ee7203">AP_GPS::AP_GPS_NMEA</a></div><div class="ttdeci">friend class AP_GPS_NMEA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00082">AP_GPS.h:82</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a2ce34a6bc4566e0ada53f4b6c94d4b85"><div class="ttname"><a href="classAP__GPS.html#a2ce34a6bc4566e0ada53f4b6c94d4b85">AP_GPS::init</a></div><div class="ttdeci">void init(const class AP_SerialManager &amp;serial_manager)</div><div class="ttdoc">Startup initialisation.</div><div class="ttdef"><b>Definition</b> <a href="#l00467">AP_GPS.cpp:467</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a32634fda14b879872e3434733dac25ba"><div class="ttname"><a href="classAP__GPS.html#a32634fda14b879872e3434733dac25ba">AP_GPS::speed_accuracy</a></div><div class="ttdeci">bool speed_accuracy(uint8_t instance, float &amp;sacc) const</div><div class="ttdef"><b>Definition</b> <a href="#l00511">AP_GPS.cpp:511</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a345149947e2742dfde06a095e40e5a9c"><div class="ttname"><a href="classAP__GPS.html#a345149947e2742dfde06a095e40e5a9c">AP_GPS::AP_GPS_SBP2</a></div><div class="ttdeci">friend class AP_GPS_SBP2</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00087">AP_GPS.h:87</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a351afca5ea59de076f93b611c1c9df90"><div class="ttname"><a href="classAP__GPS.html#a351afca5ea59de076f93b611c1c9df90">AP_GPS::update_primary</a></div><div class="ttdeci">void update_primary(void)</div><div class="ttdoc">Update primary instance.</div><div class="ttdef"><b>Definition</b> <a href="#l01170">AP_GPS.cpp:1170</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a3d0a0e530c963bb5b7ffaf4eb74faef2"><div class="ttname"><a href="classAP__GPS.html#a3d0a0e530c963bb5b7ffaf4eb74faef2">AP_GPS::num_sensors</a></div><div class="ttdeci">uint8_t num_sensors(void) const</div><div class="ttdef"><b>Definition</b> <a href="#l00501">AP_GPS.cpp:501</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a42591c1b4bded833142990e8757c9f24"><div class="ttname"><a href="classAP__GPS.html#a42591c1b4bded833142990e8757c9f24">AP_GPS::AP_GPS_SIRF</a></div><div class="ttdeci">friend class AP_GPS_SIRF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00088">AP_GPS.h:88</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a43a8bf081e4d4415aa9bf6a273bcd0b6"><div class="ttname"><a href="classAP__GPS.html#a43a8bf081e4d4415aa9bf6a273bcd0b6">AP_GPS::AP_GPS_ERB</a></div><div class="ttdeci">friend class AP_GPS_ERB</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00077">AP_GPS.h:77</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a4463d97bdd728f628ec944f39266376b"><div class="ttname"><a href="classAP__GPS.html#a4463d97bdd728f628ec944f39266376b">AP_GPS::_blended_lag_sec</a></div><div class="ttdeci">float _blended_lag_sec</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00745">AP_GPS.h:745</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a4570c56a31686eb4fd74eaee91a00052"><div class="ttname"><a href="classAP__GPS.html#a4570c56a31686eb4fd74eaee91a00052">AP_GPS::_auto_config</a></div><div class="ttdeci">AP_Int8 _auto_config</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00605">AP_GPS.h:605</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a45bb96a7470d3c2d002ac947bd611cfc"><div class="ttname"><a href="classAP__GPS.html#a45bb96a7470d3c2d002ac947bd611cfc">AP_GPS::get_RelPosHeading</a></div><div class="ttdeci">void get_RelPosHeading(uint32_t &amp;timestamp, float &amp;relPosHeading, float &amp;relPosLength, float &amp;relPosD, float &amp;accHeading)</div><div class="ttdef"><b>Definition</b> <a href="#l01080">AP_GPS.cpp:1080</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a465c5b4ba4f09c2d72440ac78d594d78"><div class="ttname"><a href="classAP__GPS.html#a465c5b4ba4f09c2d72440ac78d594d78">AP_GPS::AP_GPS_MSP</a></div><div class="ttdeci">friend class AP_GPS_MSP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00080">AP_GPS.h:80</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a46e3beda958dc2806d8f705026bbb663"><div class="ttname"><a href="classAP__GPS.html#a46e3beda958dc2806d8f705026bbb663">AP_GPS::rtcm_stats</a></div><div class="ttdeci">struct AP_GPS::@45 rtcm_stats</div></div>
<div class="ttc" id="aclassAP__GPS_html_a46e5d33707cf47859f90bbbdc1bdbfc7"><div class="ttname"><a href="classAP__GPS.html#a46e5d33707cf47859f90bbbdc1bdbfc7">AP_GPS::AP_GPS_UBLOX</a></div><div class="ttdeci">friend class AP_GPS_UBLOX</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00089">AP_GPS.h:89</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a48d705a86f6f13cb6fe506c7b93d5262"><div class="ttname"><a href="classAP__GPS.html#a48d705a86f6f13cb6fe506c7b93d5262">AP_GPS::is_healthy</a></div><div class="ttdeci">bool is_healthy(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00537">AP_GPS.h:537</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a4bdd5c70ed358b4147a58c7d09f040dd"><div class="ttname"><a href="classAP__GPS.html#a4bdd5c70ed358b4147a58c7d09f040dd">AP_GPS::detect_instance</a></div><div class="ttdeci">void detect_instance(uint8_t instance)</div><div class="ttdef"><b>Definition</b> <a href="#l00697">AP_GPS.cpp:697</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a4ff8670878e8371b8be04da456778045"><div class="ttname"><a href="classAP__GPS.html#a4ff8670878e8371b8be04da456778045">AP_GPS::_antenna_offset</a></div><div class="ttdeci">AP_Vector3f _antenna_offset[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00606">AP_GPS.h:606</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a51331fa30a3661fd1c576bac4c9c834c"><div class="ttname"><a href="classAP__GPS.html#a51331fa30a3661fd1c576bac4c9c834c">AP_GPS::handle_msg</a></div><div class="ttdeci">void handle_msg(mavlink_channel_t chan, const mavlink_message_t &amp;msg)</div></div>
<div class="ttc" id="aclassAP__GPS_html_a52cd545a207e6b79f44db5b7f2ff6969"><div class="ttname"><a href="classAP__GPS.html#a52cd545a207e6b79f44db5b7f2ff6969">AP_GPS::option_set</a></div><div class="ttdeci">bool option_set(const DriverOptions option) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00634">AP_GPS.h:634</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a559c00ff3bbc1232f68e64d29a892128"><div class="ttname"><a href="classAP__GPS.html#a559c00ff3bbc1232f68e64d29a892128">AP_GPS::send_mavlink_gps2_raw</a></div><div class="ttdeci">void send_mavlink_gps2_raw(mavlink_channel_t chan)</div><div class="ttdef"><b>Definition</b> <a href="#l01500">AP_GPS.cpp:1500</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a58a05f48dce64267c71558d39b7917e9"><div class="ttname"><a href="classAP__GPS.html#a58a05f48dce64267c71558d39b7917e9">AP_GPS::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00132">AP_GPS.h:132</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a5ae2eb81858c2bcf2a988a357ffa0918"><div class="ttname"><a href="classAP__GPS.html#a5ae2eb81858c2bcf2a988a357ffa0918">AP_GPS::initblob_state</a></div><div class="ttdeci">struct AP_GPS::@44 initblob_state[GPS_MAX_RECEIVERS]</div></div>
<div class="ttc" id="aclassAP__GPS_html_a5c43f8a7049939c439960e2d5431b09b"><div class="ttname"><a href="classAP__GPS.html#a5c43f8a7049939c439960e2d5431b09b">AP_GPS::_inject_to</a></div><div class="ttdeci">AP_Int8 _inject_to</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00597">AP_GPS.h:597</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a5ec4e6f4bba7af336c54c75797148a38"><div class="ttname"><a href="classAP__GPS.html#a5ec4e6f4bba7af336c54c75797148a38">AP_GPS::_output_is_blended</a></div><div class="ttdeci">bool _output_is_blended</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00747">AP_GPS.h:747</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a614930fee589e7a3d53b5adb17df0f3ca1094a76c0752e8d8280511f69360dae2"><div class="ttname"><a href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca1094a76c0752e8d8280511f69360dae2">AP_GPS::AlwaysRTCMDecode</a></div><div class="ttdeci">@ AlwaysRTCMDecode</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00629">AP_GPS.h:629</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a614930fee589e7a3d53b5adb17df0f3ca3bbfb0578f308e855b286ee6b388fcd2"><div class="ttname"><a href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca3bbfb0578f308e855b286ee6b388fcd2">AP_GPS::DisableRTCMDecode</a></div><div class="ttdeci">@ DisableRTCMDecode</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00630">AP_GPS.h:630</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a614930fee589e7a3d53b5adb17df0f3ca445f9c1d140e715f5fe931c2648b621a"><div class="ttname"><a href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3ca445f9c1d140e715f5fe931c2648b621a">AP_GPS::UBX_Use115200</a></div><div class="ttdeci">@ UBX_Use115200</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00625">AP_GPS.h:625</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a614930fee589e7a3d53b5adb17df0f3cabc0aa22f695604e6ee5a23890ed541c0"><div class="ttname"><a href="classAP__GPS.html#a614930fee589e7a3d53b5adb17df0f3cabc0aa22f695604e6ee5a23890ed541c0">AP_GPS::UBX_MBUseUart2</a></div><div class="ttdeci">@ UBX_MBUseUart2</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00623">AP_GPS.h:623</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a629018b7be7107c6b6a1a590873a93f0"><div class="ttname"><a href="classAP__GPS.html#a629018b7be7107c6b6a1a590873a93f0">AP_GPS::handle_gps_rtcm_fragment</a></div><div class="ttdeci">void handle_gps_rtcm_fragment(uint8_t flags, const uint8_t *data, uint8_t len)</div><div class="ttdef"><b>Definition</b> <a href="#l01604">AP_GPS.cpp:1604</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a634333ea407907ab706da51055907aa5"><div class="ttname"><a href="classAP__GPS.html#a634333ea407907ab706da51055907aa5">AP_GPS::GPSAutoSwitch</a></div><div class="ttdeci">GPSAutoSwitch</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00776">AP_GPS.h:776</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a634333ea407907ab706da51055907aa5ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="classAP__GPS.html#a634333ea407907ab706da51055907aa5ab50339a10e1de285ac99d4c3990b8693">AP_GPS::GPSAutoSwitch::NONE</a></div><div class="ttdeci">@ NONE</div></div>
<div class="ttc" id="aclassAP__GPS_html_a634333ea407907ab706da51055907aa5adfc873ece0afbab4bff0a668ba669a81"><div class="ttname"><a href="classAP__GPS.html#a634333ea407907ab706da51055907aa5adfc873ece0afbab4bff0a668ba669a81">AP_GPS::GPSAutoSwitch::USE_PRIMARY_IF_3D_FIX</a></div><div class="ttdeci">@ USE_PRIMARY_IF_3D_FIX</div></div>
<div class="ttc" id="aclassAP__GPS_html_a634333ea407907ab706da51055907aa5af58072a9536aaeef0196115e445fa4d8"><div class="ttname"><a href="classAP__GPS.html#a634333ea407907ab706da51055907aa5af58072a9536aaeef0196115e445fa4d8">AP_GPS::GPSAutoSwitch::BLEND</a></div><div class="ttdeci">@ BLEND</div></div>
<div class="ttc" id="aclassAP__GPS_html_a64dec4a409a0ca00fcb8f7e458ddce1d"><div class="ttname"><a href="classAP__GPS.html#a64dec4a409a0ca00fcb8f7e458ddce1d">AP_GPS::get_itow</a></div><div class="ttdeci">uint32_t get_itow(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="#l02318">AP_GPS.cpp:2318</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a6534cf5404afbe11d4c7edf06813ce4a"><div class="ttname"><a href="classAP__GPS.html#a6534cf5404afbe11d4c7edf06813ce4a">AP_GPS::blend_health_check</a></div><div class="ttdeci">bool blend_health_check() const</div><div class="ttdef"><b>Definition</b> <a href="#l01595">AP_GPS.cpp:1595</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a658c400982bac280ee6d3658bf8c0060"><div class="ttname"><a href="classAP__GPS.html#a658c400982bac280ee6d3658bf8c0060">AP_GPS::primary_sensor</a></div><div class="ttdeci">uint8_t primary_sensor(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00271">AP_GPS.h:271</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a68c0d04e3d5352c21772ac88b140284f"><div class="ttname"><a href="classAP__GPS.html#a68c0d04e3d5352c21772ac88b140284f">AP_GPS::istate_time_to_epoch_ms</a></div><div class="ttdeci">static uint64_t istate_time_to_epoch_ms(uint16_t gps_week, uint32_t gps_ms)</div><div class="ttdef"><b>Definition</b> <a href="#l00561">AP_GPS.cpp:561</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a69448953b5035758f2d32bc78a0a2561"><div class="ttname"><a href="classAP__GPS.html#a69448953b5035758f2d32bc78a0a2561">AP_GPS::logging_enabled</a></div><div class="ttdeci">bool logging_enabled(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00550">AP_GPS.h:550</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a6ea12f82bdeac194c101ce53c5ebf6bd"><div class="ttname"><a href="classAP__GPS.html#a6ea12f82bdeac194c101ce53c5ebf6bd">AP_GPS::_auto_switch</a></div><div class="ttdeci">AP_Int8 _auto_switch</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00595">AP_GPS.h:595</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a6eb39317fffbbb7f860cf2c54858aab9"><div class="ttname"><a href="classAP__GPS.html#a6eb39317fffbbb7f860cf2c54858aab9">AP_GPS::_primary</a></div><div class="ttdeci">AP_Int8 _primary</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00611">AP_GPS.h:611</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a704e437c25ef2105580fbbfdaa8f9df4"><div class="ttname"><a href="classAP__GPS.html#a704e437c25ef2105580fbbfdaa8f9df4">AP_GPS::last_message_time_ms</a></div><div class="ttdeci">uint32_t last_message_time_ms(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00444">AP_GPS.h:444</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fc"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fc">AP_GPS::GPS_Status</a></div><div class="ttdeci">GPS_Status</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00143">AP_GPS.h:143</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a></div><div class="ttdeci">@ GPS_OK_FIX_2D</div><div class="ttdoc">Receiving valid messages and 2D lock.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00146">AP_GPS.h:146</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca3ea1cd30c63cf65db4a124bcd4b9fbdb">AP_GPS::GPS_OK_FIX_3D</a></div><div class="ttdeci">@ GPS_OK_FIX_3D</div><div class="ttdoc">Receiving valid messages and 3D lock.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00147">AP_GPS.h:147</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca4166c675325c7b3e3e83c7c3ec1fbafb">AP_GPS::NO_FIX</a></div><div class="ttdeci">@ NO_FIX</div><div class="ttdoc">Receiving valid GPS messages but no lock.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00145">AP_GPS.h:145</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca5eba95d16dc0519820e356de7be1362d">AP_GPS::NO_GPS</a></div><div class="ttdeci">@ NO_GPS</div><div class="ttdoc">No GPS connected/detected.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00144">AP_GPS.h:144</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fca70ff28e0bee1ab6c0b129b76b9fa7fc0"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca70ff28e0bee1ab6c0b129b76b9fa7fc0">AP_GPS::GPS_OK_FIX_3D_DGPS</a></div><div class="ttdeci">@ GPS_OK_FIX_3D_DGPS</div><div class="ttdoc">Receiving valid messages and 3D lock with differential improvements.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00148">AP_GPS.h:148</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fcace8880546698f0209a3862137c76fd99"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcace8880546698f0209a3862137c76fd99">AP_GPS::GPS_OK_FIX_3D_RTK_FLOAT</a></div><div class="ttdeci">@ GPS_OK_FIX_3D_RTK_FLOAT</div><div class="ttdoc">Receiving valid messages and 3D RTK Float.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00149">AP_GPS.h:149</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7409121ce557236dce2fd541309af5fcad9d2de41647dead30787d7b4f0c81539"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fcad9d2de41647dead30787d7b4f0c81539">AP_GPS::GPS_OK_FIX_3D_RTK_FIXED</a></div><div class="ttdeci">@ GPS_OK_FIX_3D_RTK_FIXED</div><div class="ttdoc">Receiving valid messages and 3D RTK Fixed.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00150">AP_GPS.h:150</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7647cae1e8f90b75020d3cd6c31470ff"><div class="ttname"><a href="classAP__GPS.html#a7647cae1e8f90b75020d3cd6c31470ff">AP_GPS::get_antenna_offset</a></div><div class="ttdeci">const Vector3f &amp; get_antenna_offset(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="#l01828">AP_GPS.cpp:1828</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a79f121ff20c9d3fe180f19f89150af4f"><div class="ttname"><a href="classAP__GPS.html#a79f121ff20c9d3fe180f19f89150af4f">AP_GPS::ground_speed</a></div><div class="ttdeci">float ground_speed() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00360">AP_GPS.h:360</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7ac57480ec01621fe381383e91013716"><div class="ttname"><a href="classAP__GPS.html#a7ac57480ec01621fe381383e91013716">AP_GPS::_type</a></div><div class="ttdeci">AP_Int8 _type[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00593">AP_GPS.h:593</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7bcfc49c7498cdd19ee51552d7edf506"><div class="ttname"><a href="classAP__GPS.html#a7bcfc49c7498cdd19ee51552d7edf506">AP_GPS::AP_GPS_MAV</a></div><div class="ttdeci">friend class AP_GPS_MAV</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00079">AP_GPS.h:79</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7c57cd937a1702a32ea63dc30f271d5b"><div class="ttname"><a href="classAP__GPS.html#a7c57cd937a1702a32ea63dc30f271d5b">AP_GPS::AP_GPS_SBF</a></div><div class="ttdeci">friend class AP_GPS_SBF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00085">AP_GPS.h:85</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a7f7a01767467002a69f952fca557bd5d"><div class="ttname"><a href="classAP__GPS.html#a7f7a01767467002a69f952fca557bd5d">AP_GPS::have_gps_yaw</a></div><div class="ttdeci">bool have_gps_yaw(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00468">AP_GPS.h:468</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a83302e8b52e5d01ae67375b3542eb460"><div class="ttname"><a href="classAP__GPS.html#a83302e8b52e5d01ae67375b3542eb460">AP_GPS::update_instance</a></div><div class="ttdeci">void update_instance(uint8_t instance)</div><div class="ttdef"><b>Definition</b> <a href="#l00934">AP_GPS.cpp:934</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a8501b8d502d21be0e12bfd11db3e7dfe"><div class="ttname"><a href="classAP__GPS.html#a8501b8d502d21be0e12bfd11db3e7dfe">AP_GPS::last_fix_time_ms</a></div><div class="ttdeci">uint32_t last_fix_time_ms(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00435">AP_GPS.h:435</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a86e388032563bbd72cca1bce9ec24d17"><div class="ttname"><a href="classAP__GPS.html#a86e388032563bbd72cca1bce9ec24d17">AP_GPS::calc_blended_state</a></div><div class="ttdeci">void calc_blended_state(void)</div><div class="ttdef"><b>Definition</b> <a href="#l02038">AP_GPS.cpp:2038</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a88ffa0ff28e2c65d11c8b1ced2c43760"><div class="ttname"><a href="classAP__GPS.html#a88ffa0ff28e2c65d11c8b1ced2c43760">AP_GPS::remaining</a></div><div class="ttdeci">uint16_t remaining</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00695">AP_GPS.h:695</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a8a76f3e0443a24ad11b645d7a765b452"><div class="ttname"><a href="classAP__GPS.html#a8a76f3e0443a24ad11b645d7a765b452">AP_GPS::gps_yaw_deg</a></div><div class="ttdeci">bool gps_yaw_deg(uint8_t instance, float &amp;yaw_deg, float &amp;accuracy_deg, uint32_t &amp;time_ms) const</div><div class="ttdef"><b>Definition</b> <a href="#l02408">AP_GPS.cpp:2408</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a8c15102b003581f2f84119ea84ad47c3"><div class="ttname"><a href="classAP__GPS.html#a8c15102b003581f2f84119ea84ad47c3">AP_GPS::get_singleton</a></div><div class="ttdeci">static AP_GPS * get_singleton()</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00099">AP_GPS.h:99</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a8d10f943cb245f20b1dc5f8e727f52eb"><div class="ttname"><a href="classAP__GPS.html#a8d10f943cb245f20b1dc5f8e727f52eb">AP_GPS::should_log</a></div><div class="ttdeci">bool should_log() const</div><div class="ttdef"><b>Definition</b> <a href="#l00911">AP_GPS.cpp:911</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a90fd13c4336af3e75e05b23dfa54cb81"><div class="ttname"><a href="classAP__GPS.html#a90fd13c4336af3e75e05b23dfa54cb81">AP_GPS::inject_data</a></div><div class="ttdeci">void inject_data(const uint8_t *data, uint16_t len)</div><div class="ttdef"><b>Definition</b> <a href="#l01419">AP_GPS.cpp:1419</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a9431a0dd8acdad90322126e69ad53877"><div class="ttname"><a href="classAP__GPS.html#a9431a0dd8acdad90322126e69ad53877">AP_GPS::rsem</a></div><div class="ttdeci">HAL_Semaphore rsem</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00640">AP_GPS.h:640</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a98763c63e4862b42f60a0926c3177413"><div class="ttname"><a href="classAP__GPS.html#a98763c63e4862b42f60a0926c3177413">AP_GPS::get_RTCMV3</a></div><div class="ttdeci">bool get_RTCMV3(const uint8_t *&amp;bytes, uint16_t &amp;len)</div><div class="ttdef"><b>Definition</b> <a href="#l01095">AP_GPS.cpp:1095</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a98e00c3558ecca57c67a529becd029e2"><div class="ttname"><a href="classAP__GPS.html#a98e00c3558ecca57c67a529becd029e2">AP_GPS::velocity</a></div><div class="ttdeci">const Vector3f &amp; velocity() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00352">AP_GPS.h:352</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a99547c334b79105e677635048e8bd4b7"><div class="ttname"><a href="classAP__GPS.html#a99547c334b79105e677635048e8bd4b7">AP_GPS::handle_gps_inject</a></div><div class="ttdeci">void handle_gps_inject(const mavlink_message_t &amp;msg)</div></div>
<div class="ttc" id="aclassAP__GPS_html_a9cc00433bd94933f1259dc8bfe859fe1"><div class="ttname"><a href="classAP__GPS.html#a9cc00433bd94933f1259dc8bfe859fe1">AP_GPS::blob</a></div><div class="ttdeci">const char * blob</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00694">AP_GPS.h:694</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_a9deff31eb85227eb57cc66556df03ba0"><div class="ttname"><a href="classAP__GPS.html#a9deff31eb85227eb57cc66556df03ba0">AP_GPS::drivers</a></div><div class="ttdeci">AP_GPS_Backend * drivers[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00667">AP_GPS.h:667</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aa11fde1563dedb624c0d308b0e542cb6"><div class="ttname"><a href="classAP__GPS.html#aa11fde1563dedb624c0d308b0e542cb6">AP_GPS::_blend_health_counter</a></div><div class="ttdeci">uint8_t _blend_health_counter</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00748">AP_GPS.h:748</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aa64e78056c0899273bae42ac4874b7e0"><div class="ttname"><a href="classAP__GPS.html#aa64e78056c0899273bae42ac4874b7e0">AP_GPS::AP_GPS</a></div><div class="ttdeci">AP_GPS()</div><div class="ttdef"><b>Definition</b> <a href="#l00434">AP_GPS.cpp:434</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aa6e8517c91f43e38d41af7cf338c8d4f"><div class="ttname"><a href="classAP__GPS.html#aa6e8517c91f43e38d41af7cf338c8d4f">AP_GPS::get_hdop</a></div><div class="ttdeci">uint16_t get_hdop() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00418">AP_GPS.h:418</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aa7e3f1447d7a25eebcc5f06d66cbf395"><div class="ttname"><a href="classAP__GPS.html#aa7e3f1447d7a25eebcc5f06d66cbf395">AP_GPS::ground_course</a></div><div class="ttdeci">float ground_course() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00373">AP_GPS.h:373</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aaeb8dc7cbdae6534526a00444a53cda1"><div class="ttname"><a href="classAP__GPS.html#aaeb8dc7cbdae6534526a00444a53cda1">AP_GPS::get_lag</a></div><div class="ttdeci">bool get_lag(uint8_t instance, float &amp;lag_sec) const</div><div class="ttdef"><b>Definition</b> <a href="#l01790">AP_GPS.cpp:1790</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_aaf84a5f2a3629a01d2e00c8a07f91865"><div class="ttname"><a href="classAP__GPS.html#aaf84a5f2a3629a01d2e00c8a07f91865">AP_GPS::_detect_instance</a></div><div class="ttdeci">AP_GPS_Backend * _detect_instance(uint8_t instance)</div><div class="ttdef"><b>Definition</b> <a href="#l00722">AP_GPS.cpp:722</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab56525924639ff734a805b7bce10f5eb"><div class="ttname"><a href="classAP__GPS.html#ab56525924639ff734a805b7bce10f5eb">AP_GPS::AP_GPS_GSOF</a></div><div class="ttdeci">friend class AP_GPS_GSOF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00078">AP_GPS.h:78</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab61a817d51c7c3a3f1ae0dc36982b437"><div class="ttname"><a href="classAP__GPS.html#ab61a817d51c7c3a3f1ae0dc36982b437">AP_GPS::AP_GPS_SBP</a></div><div class="ttdeci">friend class AP_GPS_SBP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00086">AP_GPS.h:86</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab6690a9a05471bfb22fc7d171f12b4fc"><div class="ttname"><a href="classAP__GPS.html#ab6690a9a05471bfb22fc7d171f12b4fc">AP_GPS::time_week_ms</a></div><div class="ttdeci">uint32_t time_week_ms() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00402">AP_GPS.h:402</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab6d599f921fc0e7d66221f379de044f6"><div class="ttname"><a href="classAP__GPS.html#ab6d599f921fc0e7d66221f379de044f6">AP_GPS::clear_RTCMV3</a></div><div class="ttdeci">void clear_RTCMV3()</div><div class="ttdef"><b>Definition</b> <a href="#l01105">AP_GPS.cpp:1105</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab7d394dafbbd1d9c7d046aa195d49063"><div class="ttname"><a href="classAP__GPS.html#ab7d394dafbbd1d9c7d046aa195d49063">AP_GPS::_singleton</a></div><div class="ttdeci">static AP_GPS * _singleton</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00639">AP_GPS.h:639</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab8cf24c74d281be0f8cc68fcf924a678"><div class="ttname"><a href="classAP__GPS.html#ab8cf24c74d281be0f8cc68fcf924a678">AP_GPS::timing</a></div><div class="ttdeci">GPS_timing timing[GPS_MAX_INSTANCES]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00665">AP_GPS.h:665</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ab97af8b3f61b2c16596fd0617bfe93a0"><div class="ttname"><a href="classAP__GPS.html#ab97af8b3f61b2c16596fd0617bfe93a0">AP_GPS::num_sats</a></div><div class="ttdeci">uint8_t num_sats() const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00394">AP_GPS.h:394</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_abbd67f2b9539b783cc40c5eb18f57077a5232e4bd27c0b0d1c2d8c9f9a72cbc35"><div class="ttname"><a href="classAP__GPS.html#abbd67f2b9539b783cc40c5eb18f57077a5232e4bd27c0b0d1c2d8c9f9a72cbc35">AP_GPS::GPS_AUTO_CONFIG_ENABLE_SERIAL_ONLY</a></div><div class="ttdeci">@ GPS_AUTO_CONFIG_ENABLE_SERIAL_ONLY</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00772">AP_GPS.h:772</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_abca09c2218f7fec3eef23679dead41b4"><div class="ttname"><a href="classAP__GPS.html#abca09c2218f7fec3eef23679dead41b4">AP_GPS::horizontal_accuracy</a></div><div class="ttdeci">bool horizontal_accuracy(uint8_t instance, float &amp;hacc) const</div><div class="ttdef"><b>Definition</b> <a href="#l00520">AP_GPS.cpp:520</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_abe62aaf611872626904a46572c6bbda3"><div class="ttname"><a href="classAP__GPS.html#abe62aaf611872626904a46572c6bbda3">AP_GPS::needs_uart</a></div><div class="ttdeci">bool needs_uart(GPS_Type type) const</div><div class="ttdef"><b>Definition</b> <a href="#l00448">AP_GPS.cpp:448</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ac2c5a58b9aa31a268047ce499f61f96c"><div class="ttname"><a href="classAP__GPS.html#ac2c5a58b9aa31a268047ce499f61f96c">AP_GPS::all_consistent</a></div><div class="ttdeci">bool all_consistent(float &amp;distance) const</div><div class="ttdef"><b>Definition</b> <a href="#l01578">AP_GPS.cpp:1578</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ac66632e3a213d12c35d56ae65a3dfa08"><div class="ttname"><a href="classAP__GPS.html#ac66632e3a213d12c35d56ae65a3dfa08">AP_GPS::prepare_for_arming</a></div><div class="ttdeci">bool prepare_for_arming(void)</div><div class="ttdef"><b>Definition</b> <a href="#l02271">AP_GPS.cpp:2271</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ac72f28687a306b821da873c6b2145241"><div class="ttname"><a href="classAP__GPS.html#ac72f28687a306b821da873c6b2145241">AP_GPS::_last_instance_swap_ms</a></div><div class="ttdeci">uint32_t _last_instance_swap_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00598">AP_GPS.h:598</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ac89218621af4ae16bce41e0fbcb8faf1"><div class="ttname"><a href="classAP__GPS.html#ac89218621af4ae16bce41e0fbcb8faf1">AP_GPS::_baudrates</a></div><div class="ttdeci">static const uint32_t _baudrates[]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00082">AP_GPS.h:82</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ac9f4da4e698ba211f2323a9a6731826c"><div class="ttname"><a href="classAP__GPS.html#ac9f4da4e698ba211f2323a9a6731826c">AP_GPS::get_rate_ms</a></div><div class="ttdeci">uint16_t get_rate_ms(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="#l01851">AP_GPS.cpp:1851</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acb11fb039b919cc571307c0c6c265d7a"><div class="ttname"><a href="classAP__GPS.html#acb11fb039b919cc571307c0c6c265d7a">AP_GPS::AP_GPS_NOVA</a></div><div class="ttdeci">friend class AP_GPS_NOVA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00083">AP_GPS.h:83</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acc9bc07dad20bdf5614079acb8038872"><div class="ttname"><a href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872">AP_GPS::GPS_Role</a></div><div class="ttdeci">GPS_Role</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00168">AP_GPS.h:168</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acc9bc07dad20bdf5614079acb8038872a673a642e61b261538e20b21e3dc16bac"><div class="ttname"><a href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872a673a642e61b261538e20b21e3dc16bac">AP_GPS::GPS_ROLE_MB_ROVER</a></div><div class="ttdeci">@ GPS_ROLE_MB_ROVER</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00171">AP_GPS.h:171</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acc9bc07dad20bdf5614079acb8038872ae8c20be64a1ba0c14cc5502bd73a8398"><div class="ttname"><a href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872ae8c20be64a1ba0c14cc5502bd73a8398">AP_GPS::GPS_ROLE_MB_BASE</a></div><div class="ttdeci">@ GPS_ROLE_MB_BASE</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00170">AP_GPS.h:170</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acc9bc07dad20bdf5614079acb8038872af8309024d71439c3287810437cb1957a"><div class="ttname"><a href="classAP__GPS.html#acc9bc07dad20bdf5614079acb8038872af8309024d71439c3287810437cb1957a">AP_GPS::GPS_ROLE_NORMAL</a></div><div class="ttdeci">@ GPS_ROLE_NORMAL</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00169">AP_GPS.h:169</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ace74b654aa086c9acccf62b71a58d5e8"><div class="ttname"><a href="classAP__GPS.html#ace74b654aa086c9acccf62b71a58d5e8">AP_GPS::_log_gps_bit</a></div><div class="ttdeci">uint32_t _log_gps_bit</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00620">AP_GPS.h:620</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ace81d41034cf6bc7a468ec57baf62bec"><div class="ttname"><a href="classAP__GPS.html#ace81d41034cf6bc7a468ec57baf62bec">AP_GPS::_rate_ms</a></div><div class="ttdeci">AP_Int16 _rate_ms[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00603">AP_GPS.h:603</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_acef6b2ae0cc95f78e18f5187591cb65f"><div class="ttname"><a href="classAP__GPS.html#acef6b2ae0cc95f78e18f5187591cb65f">AP_GPS::state</a></div><div class="ttdeci">GPS_State state[GPS_MAX_INSTANCES]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00666">AP_GPS.h:666</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ad2a61d6ab33c3f615359d230e8dcdbf5"><div class="ttname"><a href="classAP__GPS.html#ad2a61d6ab33c3f615359d230e8dcdbf5">AP_GPS::position_covariance</a></div><div class="ttdeci">CovarianceType position_covariance(const uint8_t instance, Matrix3f &amp;cov) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition</b> <a href="#l00538">AP_GPS.cpp:538</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ad4512e4952aa41566d6afb110e0fd6a1"><div class="ttname"><a href="classAP__GPS.html#ad4512e4952aa41566d6afb110e0fd6a1">AP_GPS::send_blob_update</a></div><div class="ttdeci">void send_blob_update(uint8_t instance)</div><div class="ttdef"><b>Definition</b> <a href="#l00673">AP_GPS.cpp:673</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ad4d9eca67de1e324dd4f222b42fab3f3"><div class="ttname"><a href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3">AP_GPS::CovarianceType</a></div><div class="ttdeci">CovarianceType</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00175">AP_GPS.h:175</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ad4d9eca67de1e324dd4f222b42fab3f3a696b031073e74bf2cb98e5ef201d4aa3"><div class="ttname"><a href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3a696b031073e74bf2cb98e5ef201d4aa3">AP_GPS::CovarianceType::UNKNOWN</a></div><div class="ttdeci">@ UNKNOWN</div><div class="ttdoc">The GPS does not support any accuracy metrics.</div></div>
<div class="ttc" id="aclassAP__GPS_html_ad4d9eca67de1e324dd4f222b42fab3f3aa63a4f0acef4f8fe6bf4fda391a2fb98"><div class="ttname"><a href="classAP__GPS.html#ad4d9eca67de1e324dd4f222b42fab3f3aa63a4f0acef4f8fe6bf4fda391a2fb98">AP_GPS::CovarianceType::DIAGONAL_KNOWN</a></div><div class="ttdeci">@ DIAGONAL_KNOWN</div><div class="ttdoc">The diagonal (east, north, up) components of covariance are reported by the GPS.</div></div>
<div class="ttc" id="aclassAP__GPS_html_ad6736a9d4cbb5352caf3d76e4928a356"><div class="ttname"><a href="classAP__GPS.html#ad6736a9d4cbb5352caf3d76e4928a356">AP_GPS::calc_blend_weights</a></div><div class="ttdeci">bool calc_blend_weights(void)</div><div class="ttdef"><b>Definition</b> <a href="#l01864">AP_GPS.cpp:1864</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ada1df5ba1f9d65426afd5472b73eaeea"><div class="ttname"><a href="classAP__GPS.html#ada1df5ba1f9d65426afd5472b73eaeea">AP_GPS::_blend_weights</a></div><div class="ttdeci">float _blend_weights[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00746">AP_GPS.h:746</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ada57975b705a9a505d9cfaddc9dee625"><div class="ttname"><a href="classAP__GPS.html#ada57975b705a9a505d9cfaddc9dee625">AP_GPS::get_undulation</a></div><div class="ttdeci">bool get_undulation(uint8_t instance, float &amp;undulation) const</div><div class="ttdef"><b>Definition</b> <a href="#l02337">AP_GPS.cpp:2337</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_adb1d7e0cbc5e14f4d80008f5e5db0eed"><div class="ttname"><a href="classAP__GPS.html#adb1d7e0cbc5e14f4d80008f5e5db0eed">AP_GPS::Write_AP_Logger_Log_Startup_messages</a></div><div class="ttdeci">void Write_AP_Logger_Log_Startup_messages()</div><div class="ttdef"><b>Definition</b> <a href="#l01776">AP_GPS.cpp:1776</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_adbcf012c3f5dec8af367ee6b5e025573"><div class="ttname"><a href="classAP__GPS.html#adbcf012c3f5dec8af367ee6b5e025573">AP_GPS::primary_instance</a></div><div class="ttdeci">uint8_t primary_instance</div><div class="ttdoc">primary GPS instance</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00671">AP_GPS.h:671</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_adc760a1f109660466fae92e5380a321f"><div class="ttname"><a href="classAP__GPS.html#adc760a1f109660466fae92e5380a321f">AP_GPS::backends_healthy</a></div><div class="ttdeci">bool backends_healthy(char failure_msg[], uint16_t failure_msg_len)</div><div class="ttdef"><b>Definition</b> <a href="#l02281">AP_GPS.cpp:2281</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_adeb2695a00658d267b847fda8d08a5da"><div class="ttname"><a href="classAP__GPS.html#adeb2695a00658d267b847fda8d08a5da">AP_GPS::have_vertical_velocity</a></div><div class="ttdeci">bool have_vertical_velocity(void) const</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00460">AP_GPS.h:460</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae2ad6e24faf807c597055846aae3a98c"><div class="ttname"><a href="classAP__GPS.html#ae2ad6e24faf807c597055846aae3a98c">AP_GPS::get_error_codes</a></div><div class="ttdeci">bool get_error_codes(uint8_t instance, uint32_t &amp;error_codes) const</div><div class="ttdef"><b>Definition</b> <a href="#l02326">AP_GPS.cpp:2326</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6">AP_GPS::GPS_Type</a></div><div class="ttdeci">GPS_Type</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00109">AP_GPS.h:109</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a09943533b34b8f6a3981a11329270230"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a09943533b34b8f6a3981a11329270230">AP_GPS::GPS_TYPE_HIL</a></div><div class="ttdeci">@ GPS_TYPE_HIL</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00117">AP_GPS.h:117</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a10288fb5254e0a5262cacc161cd70426"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a10288fb5254e0a5262cacc161cd70426">AP_GPS::GPS_TYPE_ALLYSTAR</a></div><div class="ttdeci">@ GPS_TYPE_ALLYSTAR</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00129">AP_GPS.h:129</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a18e7fef3055b02873f12983bd9c8b350"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a18e7fef3055b02873f12983bd9c8b350">AP_GPS::GPS_TYPE_SBF</a></div><div class="ttdeci">@ GPS_TYPE_SBF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00120">AP_GPS.h:120</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a1f0ab654d6f0fbe978f0f35438c04734"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a1f0ab654d6f0fbe978f0f35438c04734">AP_GPS::GPS_TYPE_SIRF</a></div><div class="ttdeci">@ GPS_TYPE_SIRF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00116">AP_GPS.h:116</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a316eaa99b513960bd73ffc65f3ce94d3">AP_GPS::GPS_TYPE_AUTO</a></div><div class="ttdeci">@ GPS_TYPE_AUTO</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00111">AP_GPS.h:111</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a41f46a7db0fc59a625550b9afb7ccbd8">AP_GPS::GPS_TYPE_UAVCAN_RTK_BASE</a></div><div class="ttdeci">@ GPS_TYPE_UAVCAN_RTK_BASE</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00131">AP_GPS.h:131</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a4dad9018fe431987a8ed18081bcc92a3"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a4dad9018fe431987a8ed18081bcc92a3">AP_GPS::GPS_TYPE_UNICORE_MOVINGBASE_NMEA</a></div><div class="ttdeci">@ GPS_TYPE_UNICORE_MOVINGBASE_NMEA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00134">AP_GPS.h:134</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a6ce0728581a630cd12a7fb984dbf97a8">AP_GPS::GPS_TYPE_UAVCAN_RTK_ROVER</a></div><div class="ttdeci">@ GPS_TYPE_UAVCAN_RTK_ROVER</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00132">AP_GPS.h:132</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a755a5b90129ac93c5b947fd0430252aa"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a755a5b90129ac93c5b947fd0430252aa">AP_GPS::GPS_TYPE_SBP</a></div><div class="ttdeci">@ GPS_TYPE_SBP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00118">AP_GPS.h:118</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a76a222d514c32a4bc7cb319b4572bb41"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a76a222d514c32a4bc7cb319b4572bb41">AP_GPS::GPS_TYPE_GSOF</a></div><div class="ttdeci">@ GPS_TYPE_GSOF</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00121">AP_GPS.h:121</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a77521927cbe6149568d69e29b685fbcf"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a77521927cbe6149568d69e29b685fbcf">AP_GPS::GPS_TYPE_NOVA</a></div><div class="ttdeci">@ GPS_TYPE_NOVA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00124">AP_GPS.h:124</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a7de5228d3f6ae69c3d7df069fac0317d"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a7de5228d3f6ae69c3d7df069fac0317d">AP_GPS::GPS_TYPE_UNICORE_NMEA</a></div><div class="ttdeci">@ GPS_TYPE_UNICORE_NMEA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00133">AP_GPS.h:133</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a99a7d3598332932a553a6e03d0a86b24"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a99a7d3598332932a553a6e03d0a86b24">AP_GPS::GPS_TYPE_SBF_DUAL_ANTENNA</a></div><div class="ttdeci">@ GPS_TYPE_SBF_DUAL_ANTENNA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00135">AP_GPS.h:135</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a9a591d38b406c75aa871f4632279b6ad"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9a591d38b406c75aa871f4632279b6ad">AP_GPS::GPS_TYPE_MSP</a></div><div class="ttdeci">@ GPS_TYPE_MSP</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00128">AP_GPS.h:128</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6a9df7e102648dfe6247fc3390099c8e26"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6a9df7e102648dfe6247fc3390099c8e26">AP_GPS::GPS_TYPE_ERB</a></div><div class="ttdeci">@ GPS_TYPE_ERB</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00122">AP_GPS.h:122</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6aa1216166deed216b7c367a3699b5aaf4"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aa1216166deed216b7c367a3699b5aaf4">AP_GPS::GPS_TYPE_HEMI</a></div><div class="ttdeci">@ GPS_TYPE_HEMI</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00125">AP_GPS.h:125</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6abcc48ceaf7bbb31d8a796680e1eb2bcc">AP_GPS::GPS_TYPE_UBLOX_RTK_ROVER</a></div><div class="ttdeci">@ GPS_TYPE_UBLOX_RTK_ROVER</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00127">AP_GPS.h:127</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6ac02030cdc32f8c77fa5d3109f22ff324"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac02030cdc32f8c77fa5d3109f22ff324">AP_GPS::GPS_TYPE_MAV</a></div><div class="ttdeci">@ GPS_TYPE_MAV</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00123">AP_GPS.h:123</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ac321f1a72ca71dcb3422583d70c338ae">AP_GPS::GPS_TYPE_UBLOX_RTK_BASE</a></div><div class="ttdeci">@ GPS_TYPE_UBLOX_RTK_BASE</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00126">AP_GPS.h:126</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6acb925988f6661c9552b576d7078f8ca1">AP_GPS::GPS_TYPE_NONE</a></div><div class="ttdeci">@ GPS_TYPE_NONE</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00110">AP_GPS.h:110</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6ae7f79347a000fb1cf52a29057a14c77d"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6ae7f79347a000fb1cf52a29057a14c77d">AP_GPS::GPS_TYPE_NMEA</a></div><div class="ttdeci">@ GPS_TYPE_NMEA</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00115">AP_GPS.h:115</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6aefdd545e85fc6611b1678e42cef8c0a1">AP_GPS::GPS_TYPE_UAVCAN</a></div><div class="ttdeci">@ GPS_TYPE_UAVCAN</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00119">AP_GPS.h:119</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6afb53d6f3afb17c9ce056c2ce4dbfad79"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afb53d6f3afb17c9ce056c2ce4dbfad79">AP_GPS::GPS_TYPE_UBLOX</a></div><div class="ttdeci">@ GPS_TYPE_UBLOX</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00112">AP_GPS.h:112</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f"><div class="ttname"><a href="classAP__GPS.html#ae4b5ac77aca03dd3d3f327f016c7e1e6afc359305d346f6372b5a3a3278c0321f">AP_GPS::GPS_TYPE_EXTERNAL_AHRS</a></div><div class="ttdeci">@ GPS_TYPE_EXTERNAL_AHRS</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00130">AP_GPS.h:130</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_af0ca31342e4c693bf1ef3ec174145963"><div class="ttname"><a href="classAP__GPS.html#af0ca31342e4c693bf1ef3ec174145963">AP_GPS::send_mavlink_gps_rtk</a></div><div class="ttdeci">void send_mavlink_gps_rtk(mavlink_channel_t chan, uint8_t inst)</div></div>
<div class="ttc" id="aclassAP__GPS_html_af4b7f50483f14f3af3e561c18ffc7a71"><div class="ttname"><a href="classAP__GPS.html#af4b7f50483f14f3af3e561c18ffc7a71">AP_GPS::_port</a></div><div class="ttdeci">AP_HAL::UARTDriver * _port[GPS_MAX_RECEIVERS]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00668">AP_GPS.h:668</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_af55ea526d84ab7a9361d905b90810fb3"><div class="ttname"><a href="classAP__GPS.html#af55ea526d84ab7a9361d905b90810fb3">AP_GPS::gps_yaw_cdeg</a></div><div class="ttdeci">uint16_t gps_yaw_cdeg(uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="#l01448">AP_GPS.cpp:1448</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_af5f34786e914886cbfe9f47cfcf2220d"><div class="ttname"><a href="classAP__GPS.html#af5f34786e914886cbfe9f47cfcf2220d">AP_GPS::locked_ports</a></div><div class="ttdeci">uint8_t locked_ports</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00677">AP_GPS.h:677</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_af7e7cb028cf6709b5df730e47ec65057"><div class="ttname"><a href="classAP__GPS.html#af7e7cb028cf6709b5df730e47ec65057">AP_GPS::first_unconfigured_gps</a></div><div class="ttdeci">bool first_unconfigured_gps(uint8_t &amp;instance) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition</b> <a href="#l01554">AP_GPS.cpp:1554</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_afa08eb7c0337c97e2ebab7e7c930423d"><div class="ttname"><a href="classAP__GPS.html#afa08eb7c0337c97e2ebab7e7c930423d">AP_GPS::vertical_accuracy</a></div><div class="ttdeci">bool vertical_accuracy(uint8_t instance, float &amp;vacc) const</div><div class="ttdef"><b>Definition</b> <a href="#l00529">AP_GPS.cpp:529</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_afe04427a47ab5e630cb979815abd911e"><div class="ttname"><a href="classAP__GPS.html#afe04427a47ab5e630cb979815abd911e">AP_GPS::update</a></div><div class="ttdeci">void update(void)</div><div class="ttdef"><b>Definition</b> <a href="#l01132">AP_GPS.cpp:1132</a></div></div>
<div class="ttc" id="aclassAP__GPS_html_afeaaca5dc2e03d6adb94588575b012f7"><div class="ttname"><a href="classAP__GPS.html#afeaaca5dc2e03d6adb94588575b012f7">AP_GPS::logging_failed</a></div><div class="ttdeci">bool logging_failed(void) const</div><div class="ttdef"><b>Definition</b> <a href="#l02303">AP_GPS.cpp:2303</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1HAL_html_a9337a60383f4264fa96a20dbe43a4e2e"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">AP_HAL::HAL::util</a></div><div class="ttdeci">AP_HAL::Util * util</div><div class="ttdef"><b>Definition</b> <a href="HAL_8h_source.html#l00131">HAL.h:131</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_a06338cb016977302e7e4ff64d7f57ea1"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#a06338cb016977302e7e4ff64d7f57ea1">AP_HAL::UARTDriver::get_baud_rate</a></div><div class="ttdeci">virtual uint32_t get_baud_rate() const</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8h_source.html#l00147">UARTDriver.h:147</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_a1ea1968a3238d1abb9d4880d1b679af4"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#a1ea1968a3238d1abb9d4880d1b679af4">AP_HAL::UARTDriver::begin</a></div><div class="ttdeci">void begin(uint32_t baud)</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8cpp_source.html#l00015">UARTDriver.cpp:15</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_aad865126c7f40e0a3f66c37a4c708422"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#aad865126c7f40e0a3f66c37a4c708422">AP_HAL::UARTDriver::read</a></div><div class="ttdeci">int16_t read(void) override</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8cpp_source.html#l00114">UARTDriver.cpp:114</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_acd5e319d580fe14755931d37b5d4deafa67a3cf106c9c7c7d6e454a7a9610a7d8"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#acd5e319d580fe14755931d37b5d4deafa67a3cf106c9c7c7d6e454a7a9610a7d8">AP_HAL::UARTDriver::FLOW_CONTROL_DISABLE</a></div><div class="ttdeci">@ FLOW_CONTROL_DISABLE</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8h_source.html#l00102">UARTDriver.h:102</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_ae831a0d75f4760267d444c522e1271a1"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#ae831a0d75f4760267d444c522e1271a1">AP_HAL::UARTDriver::set_flow_control</a></div><div class="ttdeci">virtual void set_flow_control(enum flow_control flow_control_setting)</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8h_source.html#l00106">UARTDriver.h:106</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1UARTDriver_html_af9f67918783d70fbbce1db64228af9da"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#af9f67918783d70fbbce1db64228af9da">AP_HAL::UARTDriver::write</a></div><div class="ttdeci">size_t write(uint8_t c) override</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2UARTDriver_8cpp_source.html#l00093">UARTDriver.cpp:93</a></div></div>
<div class="ttc" id="aclassAP__HAL_1_1Util_html_afaedff8102d9ae2fbc398d2099e30cf6"><div class="ttname"><a href="classAP__HAL_1_1Util.html#afaedff8102d9ae2fbc398d2099e30cf6">AP_HAL::Util::snprintf</a></div><div class="ttdeci">int snprintf(char *str, size_t size, const char *format,...) FMT_PRINTF(4</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL_2Util_8cpp_source.html#l00044">Util.cpp:44</a></div></div>
<div class="ttc" id="aclassAP__Logger_html"><div class="ttname"><a href="classAP__Logger.html">AP_Logger</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8h_source.html#l00182">AP_Logger.h:183</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_a8bed25359bc401b7d00def25bd8173b9"><div class="ttname"><a href="classAP__Logger.html#a8bed25359bc401b7d00def25bd8173b9">AP_Logger::should_log</a></div><div class="ttdeci">bool should_log(uint32_t mask) const</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l00629">AP_Logger.cpp:629</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_aa95af9746c4b60e8386f2eb9569404eb"><div class="ttname"><a href="classAP__Logger.html#aa95af9746c4b60e8386f2eb9569404eb">AP_Logger::get_singleton</a></div><div class="ttdeci">static AP_Logger * get_singleton(void)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8h_source.html#l00196">AP_Logger.h:196</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_abab7cb26825a8dfb1e5e92cf7fcf4152"><div class="ttname"><a href="classAP__Logger.html#abab7cb26825a8dfb1e5e92cf7fcf4152">AP_Logger::WriteStreaming</a></div><div class="ttdeci">void WriteStreaming(const char *name, const char *labels, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l00992">AP_Logger.cpp:992</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_acc819f09dd35b615500c4dec658519d2"><div class="ttname"><a href="classAP__Logger.html#acc819f09dd35b615500c4dec658519d2">AP_Logger::Write_Event</a></div><div class="ttdeci">void Write_Event(LogEvent id)</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l01487">AP_Logger.cpp:1487</a></div></div>
<div class="ttc" id="aclassAP__Logger_html_ada8172473eb14aabbf121c20ef6ad76b"><div class="ttname"><a href="classAP__Logger.html#ada8172473eb14aabbf121c20ef6ad76b">AP_Logger::WriteBlock</a></div><div class="ttdeci">void WriteBlock(const void *pBuffer, uint16_t size)</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00018">main.cpp:18</a></div></div>
<div class="ttc" id="aclassAP__Notify_html_a724dd074a094de26e17c72c38ac499e9"><div class="ttname"><a href="classAP__Notify.html#a724dd074a094de26e17c72c38ac499e9">AP_Notify::flags</a></div><div class="ttdeci">static struct notify_flags_and_values_type flags</div><div class="ttdef"><b>Definition</b> <a href="AP__Notify_8h_source.html#l00173">AP_Notify.h:173</a></div></div>
<div class="ttc" id="aclassAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00010">main.cpp:10</a></div></div>
<div class="ttc" id="aclassAP__RTC_html_abb961ded9907a2dbaa1b20de2b3b5ce0"><div class="ttname"><a href="classAP__RTC.html#abb961ded9907a2dbaa1b20de2b3b5ce0">AP_RTC::set_utc_usec</a></div><div class="ttdeci">void set_utc_usec(uint64_t time_utc_usec, source_type type)</div><div class="ttdef"><b>Definition</b> <a href="AP__RTC_8cpp_source.html#l00046">AP_RTC.cpp:46</a></div></div>
<div class="ttc" id="aclassAP__RTC_html_af5ed0a2bd918379395e227179c7d6af3a9529f9ffd3c21a3d934042b6976a4a93"><div class="ttname"><a href="classAP__RTC.html#af5ed0a2bd918379395e227179c7d6af3a9529f9ffd3c21a3d934042b6976a4a93">AP_RTC::SOURCE_GPS</a></div><div class="ttdeci">@ SOURCE_GPS</div><div class="ttdef"><b>Definition</b> <a href="AP__RTC_8h_source.html#l00026">AP_RTC.h:26</a></div></div>
<div class="ttc" id="aclassAP__SerialManager_html"><div class="ttname"><a href="classAP__SerialManager.html">AP_SerialManager</a></div><div class="ttdef"><b>Definition</b> <a href="AP__SerialManager_8h_source.html#l00030">AP_SerialManager.h:30</a></div></div>
<div class="ttc" id="aclassAP__SerialManager_html_a58cb32ebb77d9fc18e4756d0270d1970"><div class="ttname"><a href="classAP__SerialManager.html#a58cb32ebb77d9fc18e4756d0270d1970">AP_SerialManager::find_serial</a></div><div class="ttdeci">AP_HAL::UARTDriver * find_serial(enum SerialProtocol protocol, uint8_t instance) const</div><div class="ttdef"><b>Definition</b> <a href="AP__SerialManager_8cpp_source.html#l00635">AP_SerialManager.cpp:635</a></div></div>
<div class="ttc" id="aclassAP__SerialManager_html_af95280ba50704a8adece62755cb348e7a22d7bc8b55699d3423ceb94263ad982d"><div class="ttname"><a href="classAP__SerialManager.html#af95280ba50704a8adece62755cb348e7a22d7bc8b55699d3423ceb94263ad982d">AP_SerialManager::SerialProtocol_GPS</a></div><div class="ttdeci">@ SerialProtocol_GPS</div><div class="ttdef"><b>Definition</b> <a href="AP__SerialManager_8h_source.html#l00044">AP_SerialManager.h:44</a></div></div>
<div class="ttc" id="aclassLocation_html"><div class="ttname"><a href="classLocation.html">Location</a></div><div class="ttdef"><b>Definition</b> <a href="Location_8h_source.html#l00007">Location.h:8</a></div></div>
<div class="ttc" id="aclassLocation_html_a146775eb07ce9abcc8d05f1b730404b0"><div class="ttname"><a href="classLocation.html#a146775eb07ce9abcc8d05f1b730404b0">Location::offset</a></div><div class="ttdeci">void offset(ftype ofs_north, ftype ofs_east)</div><div class="ttdef"><b>Definition</b> <a href="Location_8cpp_source.html#l00311">Location.cpp:311</a></div></div>
<div class="ttc" id="aclassLocation_html_a5831f0aca9e51a15adb96fad465f72f8"><div class="ttname"><a href="classLocation.html#a5831f0aca9e51a15adb96fad465f72f8">Location::lng</a></div><div class="ttdeci">int32_t lng</div><div class="ttdef"><b>Definition</b> <a href="Location_8h_source.html#l00020">Location.h:20</a></div></div>
<div class="ttc" id="aclassLocation_html_a77ca1da10b7da6216bb6cf1253ed3dfc"><div class="ttname"><a href="classLocation.html#a77ca1da10b7da6216bb6cf1253ed3dfc">Location::get_distance_NED</a></div><div class="ttdeci">Vector3f get_distance_NED(const Location &amp;loc2) const</div><div class="ttdef"><b>Definition</b> <a href="Location_8cpp_source.html#l00273">Location.cpp:273</a></div></div>
<div class="ttc" id="aclassLocation_html_a89e532f5bcc13db2f51ff9eed667c2b6"><div class="ttname"><a href="classLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">Location::alt</a></div><div class="ttdeci">int32_t alt</div><div class="ttdef"><b>Definition</b> <a href="Location_8h_source.html#l00018">Location.h:18</a></div></div>
<div class="ttc" id="aclassLocation_html_ae51548c2cf32311043ca19b94b9a9223"><div class="ttname"><a href="classLocation.html#ae51548c2cf32311043ca19b94b9a9223">Location::lat</a></div><div class="ttdeci">int32_t lat</div><div class="ttdef"><b>Definition</b> <a href="Location_8h_source.html#l00019">Location.h:19</a></div></div>
<div class="ttc" id="aclassLocation_html_af597420e2ec20fc794ca3d5447fd36ba"><div class="ttname"><a href="classLocation.html#af597420e2ec20fc794ca3d5447fd36ba">Location::get_distance_NE</a></div><div class="ttdeci">Vector2f get_distance_NE(const Location &amp;loc2) const</div><div class="ttdef"><b>Definition</b> <a href="Location_8cpp_source.html#l00266">Location.cpp:266</a></div></div>
<div class="ttc" id="aclassMatrix3_html"><div class="ttname"><a href="classMatrix3.html">Matrix3&lt; float &gt;</a></div></div>
<div class="ttc" id="aclassMatrix3_html_ab87bcaae9950ee1d72ab7075f5a397af"><div class="ttname"><a href="classMatrix3.html#ab87bcaae9950ee1d72ab7075f5a397af">Matrix3::zero</a></div><div class="ttdeci">void zero(void)</div><div class="ttdef"><b>Definition</b> <a href="matrix3_8cpp_source.html#l00231">matrix3.cpp:231</a></div></div>
<div class="ttc" id="aclassMovingBase_html"><div class="ttname"><a href="classMovingBase.html">MovingBase</a></div><div class="ttdef"><b>Definition</b> <a href="MovingBase_8h_source.html#l00006">MovingBase.h:6</a></div></div>
<div class="ttc" id="aclassRTCM3__Parser_html"><div class="ttname"><a href="classRTCM3__Parser.html">RTCM3_Parser</a></div><div class="ttdef"><b>Definition</b> <a href="RTCM3__Parser_8h_source.html#l00026">RTCM3_Parser.h:26</a></div></div>
<div class="ttc" id="aclassVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="aclassVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00076">vector3.h:76</a></div></div>
<div class="ttc" id="aclassVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00076">vector3.h:76</a></div></div>
<div class="ttc" id="aclassVector3_html_aaa6419ecd36a969d2eaecd9a1b1edd12"><div class="ttname"><a href="classVector3.html#aaa6419ecd36a969d2eaecd9a1b1edd12">Vector3::length</a></div><div class="ttdeci">T length(void) const</div><div class="ttdef"><b>Definition</b> <a href="vector3_8cpp_source.html#l00324">vector3.cpp:324</a></div></div>
<div class="ttc" id="aclassVector3_html_abcf8b89285b9966932d1aceeeadb21d3"><div class="ttname"><a href="classVector3.html#abcf8b89285b9966932d1aceeeadb21d3">Vector3::xy</a></div><div class="ttdeci">const Vector2&lt; T &gt; &amp; xy() const</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00203">vector3.h:203</a></div></div>
<div class="ttc" id="aclassVector3_html_adf1769d5ee5df2f8585df2f540fa5efe"><div class="ttname"><a href="classVector3.html#adf1769d5ee5df2f8585df2f540fa5efe">Vector3::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition</b> <a href="vector3_8h_source.html#l00229">vector3.h:229</a></div></div>
<div class="ttc" id="acrc_8cpp_html_a6883728567d1a4e1d28ca0f725fe79cc"><div class="ttname"><a href="crc_8cpp.html#a6883728567d1a4e1d28ca0f725fe79cc">crc_crc32</a></div><div class="ttdeci">uint32_t crc_crc32(uint32_t crc, const uint8_t *buf, uint32_t size)</div><div class="ttdef"><b>Definition</b> <a href="crc_8cpp_source.html#l00308">crc.cpp:308</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a7643e40a680579fe07946b46a153d8d0"><div class="ttname"><a href="definitions_8h.html#a7643e40a680579fe07946b46a153d8d0">AP_MSEC_PER_WEEK</a></div><div class="ttdeci">#define AP_MSEC_PER_WEEK</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00113">definitions.h:113</a></div></div>
<div class="ttc" id="aexamples_2AnalogIn_2AnalogIn_8cpp_html_a130f3ebe4c1bb6993e1094760227ad6a"><div class="ttname"><a href="examples_2AnalogIn_2AnalogIn_8cpp.html#a130f3ebe4c1bb6993e1094760227ad6a">chan</a></div><div class="ttdeci">AP_HAL::AnalogSource * chan</div><div class="ttdef"><b>Definition</b> <a href="examples_2AnalogIn_2AnalogIn_8cpp_source.html#l00025">AnalogIn.cpp:25</a></div></div>
<div class="ttc" id="aexamples_2location_2location_8cpp_html_a06f14a9abd47b91465f895d5259cdc1b"><div class="ttname"><a href="examples_2location_2location_8cpp.html#a06f14a9abd47b91465f895d5259cdc1b">distance</a></div><div class="ttdeci">float distance</div><div class="ttdef"><b>Definition</b> <a href="examples_2location_2location_8cpp_source.html#l00095">location.cpp:95</a></div></div>
<div class="ttc" id="amalloc_8c_html_a2807e26a012717736641384f91ab2563"><div class="ttname"><a href="malloc_8c.html#a2807e26a012717736641384f91ab2563">calloc</a></div><div class="ttdeci">void * calloc(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="malloc_8c_source.html#l00408">malloc.c:408</a></div></div>
<div class="ttc" id="amoduletest_8c_html_a903c4797a4c2860e3b9a6a978f98a44d"><div class="ttname"><a href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a></div><div class="ttdeci">#define degrees(x)</div><div class="ttdef"><b>Definition</b> <a href="moduletest_8c_source.html#l00023">moduletest.c:23</a></div></div>
<div class="ttc" id="amonocypher_8cpp_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="monocypher_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8cpp_source.html#l00071">monocypher.cpp:71</a></div></div>
<div class="ttc" id="amonocypher_8cpp_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="monocypher_8cpp.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8cpp_source.html#l00072">monocypher.cpp:72</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a52edeef7d5ffaa365e1229b87c170307"><div class="ttname"><a href="namespaceAP__HAL.html#a52edeef7d5ffaa365e1229b87c170307">AP_HAL::panic</a></div><div class="ttdeci">void panic(const char *errormsg,...) FMT_PRINTF(1</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00327">system.cpp:327</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00377">system.cpp:377</a></div></div>
<div class="ttc" id="anamespaceAP__HAL_html_a7aa0ce7625c9680e30ff4a99940907a5"><div class="ttname"><a href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a></div><div class="ttdeci">uint64_t micros64()</div><div class="ttdef"><b>Definition</b> <a href="AP__HAL__ChibiOS_2system_8cpp_source.html#l00387">system.cpp:387</a></div></div>
<div class="ttc" id="anamespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition</b> <a href="AC__Avoid_8cpp_source.html#l01481">AC_Avoid.cpp:1481</a></div></div>
<div class="ttc" id="anamespaceAP_html_aa35bfac1ea2da16f110e8e72db7b3b20"><div class="ttname"><a href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a></div><div class="ttdeci">AP_Logger &amp; logger()</div><div class="ttdef"><b>Definition</b> <a href="AP__Logger_8cpp_source.html#l01740">AP_Logger.cpp:1740</a></div></div>
<div class="ttc" id="anamespaceAP_html_ac357c38b6638140c5510e6ba566b998b"><div class="ttname"><a href="namespaceAP.html#ac357c38b6638140c5510e6ba566b998b">AP::rtc</a></div><div class="ttdeci">AP_RTC &amp; rtc()</div><div class="ttdef"><b>Definition</b> <a href="AP__RTC_8cpp_source.html#l00308">AP_RTC.cpp:308</a></div></div>
<div class="ttc" id="anamespaceAP_html_ae6eeec356455220f913e47e323057cd5"><div class="ttname"><a href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a></div><div class="ttdeci">AP_GPS &amp; gps()</div><div class="ttdef"><b>Definition</b> <a href="#l02442">AP_GPS.cpp:2442</a></div></div>
<div class="ttc" id="arouting_8cpp_html_acdef7b92239f1e607ef6caa33a16d2ed"><div class="ttname"><a href="routing_8cpp.html#acdef7b92239f1e607ef6caa33a16d2ed">status</a></div><div class="ttdeci">static mavlink_status_t status</div><div class="ttdef"><b>Definition</b> <a href="routing_8cpp_source.html#l00027">routing.cpp:27</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html">AP_GPS::GPS_State</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00186">AP_GPS.h:186</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a037e16c03fbb1091bec680ef2dfc73c7"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a037e16c03fbb1091bec680ef2dfc73c7">AP_GPS::GPS_State::ground_course</a></div><div class="ttdeci">float ground_course</div><div class="ttdoc">ground course in degrees</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00195">AP_GPS.h:195</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a0845d4035e6cb36a9e1e31f4a68531f2"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a0845d4035e6cb36a9e1e31f4a68531f2">AP_GPS::GPS_State::speed_accuracy</a></div><div class="ttdeci">float speed_accuracy</div><div class="ttdoc">3D velocity RMS accuracy estimate in m/s</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00203">AP_GPS.h:203</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a0a8710bdc386183e8afea11565745c75"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a0a8710bdc386183e8afea11565745c75">AP_GPS::GPS_State::status</a></div><div class="ttdeci">GPS_Status status</div><div class="ttdoc">driver fix status</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00190">AP_GPS.h:190</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a0c6943962cbf306dd5357a3e3c55c406"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a0c6943962cbf306dd5357a3e3c55c406">AP_GPS::GPS_State::undulation</a></div><div class="ttdeci">float undulation</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00213">AP_GPS.h:213</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a0d50346e3030a6ae1a393b3f30df8c11"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a0d50346e3030a6ae1a393b3f30df8c11">AP_GPS::GPS_State::gps_yaw_time_ms</a></div><div class="ttdeci">uint32_t gps_yaw_time_ms</div><div class="ttdoc">timestamp of last GPS yaw reading</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00197">AP_GPS.h:197</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a0ec3d5a49ae66a95c9df97cf868f12b3"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a0ec3d5a49ae66a95c9df97cf868f12b3">AP_GPS::GPS_State::relPosLength</a></div><div class="ttdeci">float relPosLength</div><div class="ttdoc">Reported Position horizontal distance in meters.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00235">AP_GPS.h:235</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a13d2ae016510be58fa8054f7d130d944"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a13d2ae016510be58fa8054f7d130d944">AP_GPS::GPS_State::num_sats</a></div><div class="ttdeci">uint8_t num_sats</div><div class="ttdoc">Number of visible satellites.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00201">AP_GPS.h:201</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a1deb41c0495c03263d4a900c09cd5bc8"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a1deb41c0495c03263d4a900c09cd5bc8">AP_GPS::GPS_State::time_week</a></div><div class="ttdeci">uint16_t time_week</div><div class="ttdoc">GPS week number.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00192">AP_GPS.h:192</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a20e1b00d3fc64a8dae7a39c3763cfa08"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a20e1b00d3fc64a8dae7a39c3763cfa08">AP_GPS::GPS_State::location</a></div><div class="ttdeci">Location location</div><div class="ttdoc">last fix location</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00193">AP_GPS.h:193</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a3c0022cde6ac8bb086f1c66b30dc0702"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a3c0022cde6ac8bb086f1c66b30dc0702">AP_GPS::GPS_State::lagged_sample_count</a></div><div class="ttdeci">uint32_t lagged_sample_count</div><div class="ttdoc">number of samples with 50ms more lag than expected</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00219">AP_GPS.h:219</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a3dfbd43611c9719ae957eae9729368f6"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a3dfbd43611c9719ae957eae9729368f6">AP_GPS::GPS_State::corrected_timestamp_updated</a></div><div class="ttdeci">bool corrected_timestamp_updated</div><div class="ttdoc">true if the corrected timestamp has been updated</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00218">AP_GPS.h:218</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a3fa38b751ea5cb9c140a2fc61ae6f568"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a3fa38b751ea5cb9c140a2fc61ae6f568">AP_GPS::GPS_State::last_gps_time_ms</a></div><div class="ttdeci">uint32_t last_gps_time_ms</div><div class="ttdoc">the system time we got the last GPS timestamp, milliseconds</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00215">AP_GPS.h:215</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a464226322ab0371a941f490cd1a818d8"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a464226322ab0371a941f490cd1a818d8">AP_GPS::GPS_State::have_vertical_accuracy</a></div><div class="ttdeci">bool have_vertical_accuracy</div><div class="ttdoc">does GPS give vertical position accuracy? Set to true only once available.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00210">AP_GPS.h:210</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a46627bb4a8f81a77af9c7da0a9c1c582"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a46627bb4a8f81a77af9c7da0a9c1c582">AP_GPS::GPS_State::relPosD</a></div><div class="ttdeci">float relPosD</div><div class="ttdoc">Reported Vertical distance in meters.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00236">AP_GPS.h:236</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a583c2c58093b9c2ce6abcb0fa9be2c79"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a583c2c58093b9c2ce6abcb0fa9be2c79">AP_GPS::GPS_State::velocity</a></div><div class="ttdeci">Vector3f velocity</div><div class="ttdoc">3D velocity in m/s, in NED format</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00202">AP_GPS.h:202</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a67fb5cd3a118c2517a6d1fdc928f9227"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a67fb5cd3a118c2517a6d1fdc928f9227">AP_GPS::GPS_State::have_horizontal_accuracy</a></div><div class="ttdeci">bool have_horizontal_accuracy</div><div class="ttdoc">does GPS give horizontal position accuracy? Set to true only once available.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00209">AP_GPS.h:209</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a69b3811b8240fd93d6d297ce49d44fc3"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a69b3811b8240fd93d6d297ce49d44fc3">AP_GPS::GPS_State::have_undulation</a></div><div class="ttdeci">bool have_undulation</div><div class="ttdoc">do we have a value for the undulation</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00214">AP_GPS.h:214</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a744761e30a6ec7415ad8a9851088356a"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a744761e30a6ec7415ad8a9851088356a">AP_GPS::GPS_State::announced_detection</a></div><div class="ttdeci">bool announced_detection</div><div class="ttdoc">true once we have announced GPS has been seen to the user</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00216">AP_GPS.h:216</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a7851b94e56941a453a5751cc59b420be"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a7851b94e56941a453a5751cc59b420be">AP_GPS::GPS_State::last_corrected_gps_time_us</a></div><div class="ttdeci">uint64_t last_corrected_gps_time_us</div><div class="ttdoc">the system time we got the last corrected GPS timestamp, microseconds</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00217">AP_GPS.h:217</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a7f5493cb75218bca4a13c125f546c8af"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a7f5493cb75218bca4a13c125f546c8af">AP_GPS::GPS_State::time_week_ms</a></div><div class="ttdeci">uint32_t time_week_ms</div><div class="ttdoc">GPS time (milliseconds from start of GPS week)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00191">AP_GPS.h:191</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a80453cce8d6080023cebccdbd506a304"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a80453cce8d6080023cebccdbd506a304">AP_GPS::GPS_State::relposheading_ts</a></div><div class="ttdeci">uint32_t relposheading_ts</div><div class="ttdoc">True if new data has been received since last time it was false.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00238">AP_GPS.h:238</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a95606c520bd395452a6e171828a4988d"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a95606c520bd395452a6e171828a4988d">AP_GPS::GPS_State::instance</a></div><div class="ttdeci">uint8_t instance</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00187">AP_GPS.h:187</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_a9cae846ba149e72943a98f25ce29e529"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#a9cae846ba149e72943a98f25ce29e529">AP_GPS::GPS_State::gps_yaw</a></div><div class="ttdeci">float gps_yaw</div><div class="ttdoc">GPS derived yaw information, if available (degrees)</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00196">AP_GPS.h:196</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_aa6b54a6f8a46a0418ae505a45480ff45"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#aa6b54a6f8a46a0418ae505a45480ff45">AP_GPS::GPS_State::ground_speed</a></div><div class="ttdeci">float ground_speed</div><div class="ttdoc">ground speed in m/s</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00194">AP_GPS.h:194</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_ab346404b3a35776ea25982265c346974"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#ab346404b3a35776ea25982265c346974">AP_GPS::GPS_State::hdop</a></div><div class="ttdeci">uint16_t hdop</div><div class="ttdoc">horizontal dilution of precision in cm</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00199">AP_GPS.h:199</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_ab8bec1358e2740e4d76f60d1f8545130"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#ab8bec1358e2740e4d76f60d1f8545130">AP_GPS::GPS_State::have_vertical_velocity</a></div><div class="ttdeci">bool have_vertical_velocity</div><div class="ttdoc">does GPS give vertical velocity? Set to true only once available.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00207">AP_GPS.h:207</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_ac928adf3266e5124476a2022409acd39"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#ac928adf3266e5124476a2022409acd39">AP_GPS::GPS_State::gps_yaw_accuracy</a></div><div class="ttdeci">float gps_yaw_accuracy</div><div class="ttdoc">heading accuracy of the GPS in degrees</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00206">AP_GPS.h:206</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_acf132315548c8b639ecdaac75af61101"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#acf132315548c8b639ecdaac75af61101">AP_GPS::GPS_State::vdop</a></div><div class="ttdeci">uint16_t vdop</div><div class="ttdoc">vertical dilution of precision in cm</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00200">AP_GPS.h:200</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_ad0ebe176090d273b59cad3e6d86fd416"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#ad0ebe176090d273b59cad3e6d86fd416">AP_GPS::GPS_State::horizontal_accuracy</a></div><div class="ttdeci">float horizontal_accuracy</div><div class="ttdoc">horizontal RMS accuracy estimate in m</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00204">AP_GPS.h:204</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_ad5da0cd4dc4d4a46f92b058cdba8be7d"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#ad5da0cd4dc4d4a46f92b058cdba8be7d">AP_GPS::GPS_State::relPosHeading</a></div><div class="ttdeci">float relPosHeading</div><div class="ttdoc">Reported Heading in degrees.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00234">AP_GPS.h:234</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_aef86178057c2197396dfd8836bf8e1b5"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#aef86178057c2197396dfd8836bf8e1b5">AP_GPS::GPS_State::have_speed_accuracy</a></div><div class="ttdeci">bool have_speed_accuracy</div><div class="ttdoc">does GPS give speed accuracy? Set to true only once available.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00208">AP_GPS.h:208</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_af5066cda264f04cf812a5ffdb8248e46"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#af5066cda264f04cf812a5ffdb8248e46">AP_GPS::GPS_State::vertical_accuracy</a></div><div class="ttdeci">float vertical_accuracy</div><div class="ttdoc">vertical RMS accuracy estimate in m</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00205">AP_GPS.h:205</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__State_html_af76863211da7706eee2bbc0dce24cfa9"><div class="ttname"><a href="structAP__GPS_1_1GPS__State.html#af76863211da7706eee2bbc0dce24cfa9">AP_GPS::GPS_State::accHeading</a></div><div class="ttdeci">float accHeading</div><div class="ttdoc">Reported Heading Accuracy in degrees.</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00237">AP_GPS.h:237</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html">AP_GPS::GPS_timing</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00648">AP_GPS.h:648</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html_a196a0fde4a1ac10bc27977eb60d69e4e"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html#a196a0fde4a1ac10bc27977eb60d69e4e">AP_GPS::GPS_timing::last_fix_time_ms</a></div><div class="ttdeci">uint32_t last_fix_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00650">AP_GPS.h:650</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html_a6bbf268f8a99e5748b44975d97a5ae00"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html#a6bbf268f8a99e5748b44975d97a5ae00">AP_GPS::GPS_timing::last_message_time_ms</a></div><div class="ttdeci">uint32_t last_message_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00653">AP_GPS.h:653</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html_a77d2a7ea1547b32a34ee112f304dbc3b"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html#a77d2a7ea1547b32a34ee112f304dbc3b">AP_GPS::GPS_timing::delta_time_ms</a></div><div class="ttdeci">uint16_t delta_time_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00656">AP_GPS.h:656</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html_a893a04a484a2624e09cfd01c2338ff90"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html#a893a04a484a2624e09cfd01c2338ff90">AP_GPS::GPS_timing::delayed_count</a></div><div class="ttdeci">uint8_t delayed_count</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00659">AP_GPS.h:659</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1GPS__timing_html_af12c41203c19557383f009125536f622"><div class="ttname"><a href="structAP__GPS_1_1GPS__timing.html#af12c41203c19557383f009125536f622">AP_GPS::GPS_timing::average_delta_ms</a></div><div class="ttdeci">float average_delta_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00662">AP_GPS.h:662</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html">AP_GPS::detect_state</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00680">AP_GPS.h:680</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a1f091c7a044d04d64919d7aadedf1495"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a1f091c7a044d04d64919d7aadedf1495">AP_GPS::detect_state::ublox_detect_state</a></div><div class="ttdeci">struct UBLOX_detect_state ublox_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00685">AP_GPS.h:685</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a2e80a2a45e99a54129c084a0db6ec6e6"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a2e80a2a45e99a54129c084a0db6ec6e6">AP_GPS::detect_state::sbp_detect_state</a></div><div class="ttdeci">struct SBP_detect_state sbp_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00688">AP_GPS.h:688</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a3a88e9dbec6da9c65c26f0167b7151ff"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a3a88e9dbec6da9c65c26f0167b7151ff">AP_GPS::detect_state::last_baud_change_ms</a></div><div class="ttdeci">uint32_t last_baud_change_ms</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00681">AP_GPS.h:681</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a5aa5ded13853ea117f411b58975927fb"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a5aa5ded13853ea117f411b58975927fb">AP_GPS::detect_state::probe_baud</a></div><div class="ttdeci">uint32_t probe_baud</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00683">AP_GPS.h:683</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a77c207fe0e20e8a532332e3feefe5e1a"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a77c207fe0e20e8a532332e3feefe5e1a">AP_GPS::detect_state::sirf_detect_state</a></div><div class="ttdeci">struct SIRF_detect_state sirf_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00686">AP_GPS.h:686</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_a886f135417cf30f4c95540af6e8c90ab"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#a886f135417cf30f4c95540af6e8c90ab">AP_GPS::detect_state::erb_detect_state</a></div><div class="ttdeci">struct ERB_detect_state erb_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00690">AP_GPS.h:690</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_adc2dd3641c9e227dee48f3851658f63d"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#adc2dd3641c9e227dee48f3851658f63d">AP_GPS::detect_state::current_baud</a></div><div class="ttdeci">uint8_t current_baud</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00682">AP_GPS.h:682</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_ade0e499bceae920fe4d93ad1f9040776"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#ade0e499bceae920fe4d93ad1f9040776">AP_GPS::detect_state::nmea_detect_state</a></div><div class="ttdeci">struct NMEA_detect_state nmea_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00687">AP_GPS.h:687</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_aff3aa650f857cd70f6a34b8bbab72040"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#aff3aa650f857cd70f6a34b8bbab72040">AP_GPS::detect_state::auto_detected_baud</a></div><div class="ttdeci">bool auto_detected_baud</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00684">AP_GPS.h:684</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1detect__state_html_aff6604d92bd10a17ca5fad75f48780d6"><div class="ttname"><a href="structAP__GPS_1_1detect__state.html#aff6604d92bd10a17ca5fad75f48780d6">AP_GPS::detect_state::sbp2_detect_state</a></div><div class="ttdeci">struct SBP2_detect_state sbp2_detect_state</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00689">AP_GPS.h:689</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html">AP_GPS::rtcm_buffer</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00721">AP_GPS.h:721</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html_a3ea184c76817cff75e802b9d8ed76f3c"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html#a3ea184c76817cff75e802b9d8ed76f3c">AP_GPS::rtcm_buffer::sequence</a></div><div class="ttdeci">uint8_t sequence</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00723">AP_GPS.h:723</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html_a5dfe66bc0c5d4f1e87b06bb36f9dc4db"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html#a5dfe66bc0c5d4f1e87b06bb36f9dc4db">AP_GPS::rtcm_buffer::total_length</a></div><div class="ttdeci">uint16_t total_length</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00725">AP_GPS.h:725</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html_a800b67d4b608233efb1eeb1deb73ca15"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html#a800b67d4b608233efb1eeb1deb73ca15">AP_GPS::rtcm_buffer::fragment_count</a></div><div class="ttdeci">uint8_t fragment_count</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00724">AP_GPS.h:724</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html_ab584acfcd7a44555b85c5df6cd62346f"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html#ab584acfcd7a44555b85c5df6cd62346f">AP_GPS::rtcm_buffer::fragments_received</a></div><div class="ttdeci">uint8_t fragments_received</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00722">AP_GPS.h:722</a></div></div>
<div class="ttc" id="astructAP__GPS_1_1rtcm__buffer_html_ad226fe9edff09af33d662e581fab2f48"><div class="ttname"><a href="structAP__GPS_1_1rtcm__buffer.html#ad226fe9edff09af33d662e581fab2f48">AP_GPS::rtcm_buffer::buffer</a></div><div class="ttdeci">uint8_t buffer[MAVLINK_MSG_GPS_RTCM_DATA_FIELD_DATA_LEN *4]</div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_8h_source.html#l00726">AP_GPS.h:726</a></div></div>
<div class="ttc" id="astructAP__Notify_1_1notify__flags__and__values__type_html_a6bc8e854e9a06270cd01c3b126d07575"><div class="ttname"><a href="structAP__Notify_1_1notify__flags__and__values__type.html#a6bc8e854e9a06270cd01c3b126d07575">AP_Notify::notify_flags_and_values_type::gps_num_sats</a></div><div class="ttdeci">uint8_t gps_num_sats</div><div class="ttdef"><b>Definition</b> <a href="AP__Notify_8h_source.html#l00117">AP_Notify.h:117</a></div></div>
<div class="ttc" id="astructAP__Notify_1_1notify__flags__and__values__type_html_a804d7278d01f92ef395c3f36e464d5a8"><div class="ttname"><a href="structAP__Notify_1_1notify__flags__and__values__type.html#a804d7278d01f92ef395c3f36e464d5a8">AP_Notify::notify_flags_and_values_type::gps_status</a></div><div class="ttdeci">uint8_t gps_status</div><div class="ttdef"><b>Definition</b> <a href="AP__Notify_8h_source.html#l00116">AP_Notify.h:116</a></div></div>
<div class="ttc" id="astructAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Param_8h_source.html#l00199">AP_Param.h:199</a></div></div>
<div class="ttc" id="astructMSP_1_1PACKED_html"><div class="ttname"><a href="structMSP_1_1PACKED.html">MSP::PACKED</a></div><div class="ttdef"><b>Definition</b> <a href="msp_8h_source.html#l00095">msp.h:95</a></div></div>
<div class="ttc" id="astructVector2_html"><div class="ttname"><a href="structVector2.html">Vector2&lt; float &gt;</a></div></div>
<div class="ttc" id="astructVector2_html_a6b537328ae913e3e7267b539e7a4af92"><div class="ttname"><a href="structVector2.html#a6b537328ae913e3e7267b539e7a4af92">Vector2::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00137">vector2.h:137</a></div></div>
<div class="ttc" id="astructVector2_html_a6cfed8355591aa269f4dba43bd806ef9"><div class="ttname"><a href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">Vector2::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00044">vector2.h:44</a></div></div>
<div class="ttc" id="astructVector2_html_a78fa1f2ed5e261c7fbeb8f3536a1ee34"><div class="ttname"><a href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">Vector2::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition</b> <a href="vector2_8h_source.html#l00044">vector2.h:44</a></div></div>
<div class="ttc" id="astructVector2_html_aed3cf4803ee803dc1447985ca323178f"><div class="ttname"><a href="structVector2.html#aed3cf4803ee803dc1447985ca323178f">Vector2::length</a></div><div class="ttdeci">T length(void) const</div><div class="ttdef"><b>Definition</b> <a href="vector2_8cpp_source.html#l00030">vector2.cpp:30</a></div></div>
<div class="ttc" id="astructlog__GPA_html"><div class="ttname"><a href="structlog__GPA.html">log_GPA</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_2LogStructure_8h_source.html#l00069">LogStructure.h:69</a></div></div>
<div class="ttc" id="astructlog__GPS_html"><div class="ttname"><a href="structlog__GPS.html">log_GPS</a></div><div class="ttdef"><b>Definition</b> <a href="AP__GPS_2LogStructure_8h_source.html#l00035">LogStructure.h:35</a></div></div>
<div class="ttc" id="astructtype_html"><div class="ttname"><a href="structtype.html">type</a></div><div class="ttdef"><b>Definition</b> <a href="AP__Scripting_2generator_2src_2main_8c_source.html#l00163">main.c:163</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 22 2024 16:14:14 for APM:Libraries by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
